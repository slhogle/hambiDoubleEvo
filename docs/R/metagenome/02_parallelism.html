<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shane Hogle">
<meta name="dcterms.date" content="2024-11-03">

<title>hambiDoubleEvo - Metagenome genetic parallelism</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../R/metagenome/01_format_variants.html">Metagenome sequencing</a></li><li class="breadcrumb-item"><a href="../../R/metagenome/02_parallelism.html">2. Parallelism analysis</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">hambiDoubleEvo</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Community composition amplicon</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/illumina_v3v4/01_rpkm2tab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Read and format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/illumina_v3v4/02_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Analyze and plot</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Population WGS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/wgs/01_format_variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Read and format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/wgs/02_parallelism.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Parallelism analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Metagenome sequencing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/metagenome/01_format_variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Read and format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/metagenome/02_parallelism.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2. Parallelism analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/metagenome/03_analyze_metagenome_variant_timeseries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Variant plotting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/metagenome/04_mutation_dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Mutational dynamics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a></li>
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data"><span class="header-section-number">2</span> Read data</a></li>
  <li><a href="#parallelism-at-nucleotide-level" id="toc-parallelism-at-nucleotide-level" class="nav-link" data-scroll-target="#parallelism-at-nucleotide-level"><span class="header-section-number">3</span> Parallelism at nucleotide level</a>
  <ul class="collapse">
  <li><a href="#nucleotide-parallelism-by-treatment" id="toc-nucleotide-parallelism-by-treatment" class="nav-link" data-scroll-target="#nucleotide-parallelism-by-treatment"><span class="header-section-number">3.1</span> Nucleotide parallelism by treatment</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">3.2</span> Conclusion</a></li>
  </ul></li>
  <li><a href="#parallelism-at-gene-level" id="toc-parallelism-at-gene-level" class="nav-link" data-scroll-target="#parallelism-at-gene-level"><span class="header-section-number">4</span> Parallelism at gene level</a>
  <ul class="collapse">
  <li><a href="#prepare-input-data-for-non-syn-mutations-only" id="toc-prepare-input-data-for-non-syn-mutations-only" class="nav-link" data-scroll-target="#prepare-input-data-for-non-syn-mutations-only"><span class="header-section-number">4.1</span> Prepare input data for non-syn mutations only</a></li>
  <li><a href="#g-score" id="toc-g-score" class="nav-link" data-scroll-target="#g-score"><span class="header-section-number">4.2</span> G score</a>
  <ul class="collapse">
  <li><a href="#simulating-the-number-of-replicates-with-a-parallel-gene-hit" id="toc-simulating-the-number-of-replicates-with-a-parallel-gene-hit" class="nav-link" data-scroll-target="#simulating-the-number-of-replicates-with-a-parallel-gene-hit"><span class="header-section-number">4.2.1</span> Simulating the number of replicates with a parallel gene hit</a></li>
  <li><a href="#visualize-the-survival-curves-for-each-treatment-combination" id="toc-visualize-the-survival-curves-for-each-treatment-combination" class="nav-link" data-scroll-target="#visualize-the-survival-curves-for-each-treatment-combination"><span class="header-section-number">4.2.2</span> Visualize the survival curves for each treatment combination</a></li>
  <li><a href="#overall-g-scores" id="toc-overall-g-scores" class="nav-link" data-scroll-target="#overall-g-scores"><span class="header-section-number">4.2.3</span> Overall G scores</a></li>
  <li><a href="#inspecting-individual-genes" id="toc-inspecting-individual-genes" class="nav-link" data-scroll-target="#inspecting-individual-genes"><span class="header-section-number">4.2.4</span> Inspecting individual genes</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#convergentdivergent-evolution" id="toc-convergentdivergent-evolution" class="nav-link" data-scroll-target="#convergentdivergent-evolution"><span class="header-section-number">5</span> Convergent/divergent evolution</a>
  <ul class="collapse">
  <li><a href="#jaccard-index-for-convergence-between-treatments" id="toc-jaccard-index-for-convergence-between-treatments" class="nav-link" data-scroll-target="#jaccard-index-for-convergence-between-treatments"><span class="header-section-number">5.1</span> Jaccard Index for convergence between treatments</a>
  <ul class="collapse">
  <li><a href="#hambi_1287" id="toc-hambi_1287" class="nav-link" data-scroll-target="#hambi_1287"><span class="header-section-number">5.1.1</span> HAMBI_1287</a></li>
  <li><a href="#hambi_1972" id="toc-hambi_1972" class="nav-link" data-scroll-target="#hambi_1972"><span class="header-section-number">5.1.2</span> HAMBI_1972</a></li>
  <li><a href="#hambi_1977" id="toc-hambi_1977" class="nav-link" data-scroll-target="#hambi_1977"><span class="header-section-number">5.1.3</span> HAMBI_1977</a></li>
  <li><a href="#hambi_2659" id="toc-hambi_2659" class="nav-link" data-scroll-target="#hambi_2659"><span class="header-section-number">5.1.4</span> HAMBI_2659</a></li>
  </ul></li>
  <li><a href="#enrichment-of-individual-cog-categories" id="toc-enrichment-of-individual-cog-categories" class="nav-link" data-scroll-target="#enrichment-of-individual-cog-categories"><span class="header-section-number">5.2</span> Enrichment of individual COG categories</a>
  <ul class="collapse">
  <li><a href="#jensen-shannon-divergence" id="toc-jensen-shannon-divergence" class="nav-link" data-scroll-target="#jensen-shannon-divergence"><span class="header-section-number">5.2.1</span> Jensen Shannon Divergence</a></li>
  <li><a href="#enrichment-of-individual-cog-categories-1" id="toc-enrichment-of-individual-cog-categories-1" class="nav-link" data-scroll-target="#enrichment-of-individual-cog-categories-1"><span class="header-section-number">5.2.2</span> Enrichment of individual COG categories</a></li>
  <li><a href="#cog-distribution-plot" id="toc-cog-distribution-plot" class="nav-link" data-scroll-target="#cog-distribution-plot"><span class="header-section-number">5.2.3</span> COG Distribution Plot</a></li>
  <li><a href="#species-present-in-the-metagenomes" id="toc-species-present-in-the-metagenomes" class="nav-link" data-scroll-target="#species-present-in-the-metagenomes"><span class="header-section-number">5.2.4</span> Species present in the metagenomes</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../R/metagenome/01_format_variants.html">Metagenome sequencing</a></li><li class="breadcrumb-item"><a href="../../R/metagenome/02_parallelism.html">2. Parallelism analysis</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Metagenome genetic parallelism</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shane Hogle </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 3, 2024</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    This notebook reads in the formatted metagenome variant frequencies and annotations. It then uses statistical tests to determine which mutations and which functional categories appeared across biological replicates within condition more often than would be expected by chance. It also looks for mutations/functions that arise within treatment categories more than expected by chance.
  </div>
</div>


</header>


<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<p>Libraries and global variables</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(fs)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(vctrs)</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"metagenome"</span>, <span class="st">"utils_parallelism.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Set up some directories</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>data_raw <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"metagenome"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>data <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"metagenome"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>shared <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"shared"</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>figs <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs"</span>, <span class="st">"metagenome"</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># make processed data directory if it doesn't exist</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(data)</span>
<span id="cb2-8"><a href="#cb2-8"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(figs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Read data</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># these were already filtered in the last step</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>mgvars <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"metagenome_variant_timeseries.tsv"</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>degentab <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"annotations_codon_degeneracy.rds"</span>))</span>
<span id="cb3-4"><a href="#cb3-4"></a>genome_len <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"HAMBI_genome_len.tsv"</span>))</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># annotations</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>annotations <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"annotations_codon_degeneracy.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parallelism-at-nucleotide-level" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Parallelism at nucleotide level</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># exclude fixed variants from day 0 </span></span>
<span id="cb4-2"><a href="#cb4-2"></a>tofilter <span class="ot">&lt;-</span> mgvars <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">filter</span>(time_days <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">filter</span>(freq_alt_complete <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(chrom, pos, ref, alt) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">distinct</span>()</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># mobile regions have already been masked in the data wrangling step</span></span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a>mgvars_filt_mb <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(mgvars, tofilter, <span class="at">by =</span> <span class="fu">join_by</span>(chrom, pos, ref, alt)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="co"># exclude variants that were added to make complete time course</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(freq_alt_complete)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="fu">filter</span>(freq_alt_complete <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="fu">filter</span>(time_days <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at all mutations (inside and outside of coding sequences, synonymous and nonsynonymous)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mgvars_filt_mb <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history, chrom, pos, ref, alt) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">mutate</span>(<span class="at">mi=</span><span class="fu">n_distinct</span>(replicate)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">count</span>(mi) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">group_by</span>(mi) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">mutate</span>(<span class="at">tot =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["strainID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mi"],"name":[2],"type":["int"],"align":["right"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]},{"label":["tot"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"HAMBI_1287","2":"3","3":"29","4":"155"},{"1":"HAMBI_1972","2":"3","3":"5","4":"155"},{"1":"HAMBI_1977","2":"3","3":"48","4":"155"},{"1":"HAMBI_2659","2":"3","3":"73","4":"155"},{"1":"HAMBI_1287","2":"2","3":"25","4":"185"},{"1":"HAMBI_1972","2":"2","3":"20","4":"185"},{"1":"HAMBI_1977","2":"2","3":"38","4":"185"},{"1":"HAMBI_2659","2":"2","3":"102","4":"185"},{"1":"HAMBI_0403","2":"1","3":"6","4":"1586"},{"1":"HAMBI_1287","2":"1","3":"203","4":"1586"},{"1":"HAMBI_1972","2":"1","3":"478","4":"1586"},{"1":"HAMBI_1977","2":"1","3":"367","4":"1586"},{"1":"HAMBI_2659","2":"1","3":"532","4":"1586"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We identified 13 species <span class="math inline">\(\times\)</span> treatment combinations with detectable mutations. To put these observations in context, we can compare them to a simple null model in which mutations are uniformly distributed across the sites in the genome. We can then check how many sites with 1, 2, and 3-fold multiplicity that we would expect by chance. We define nucleotide parallelism as the number of mutations occurring at the same site in the genome in independent populations for a given species <span class="math inline">\(\times\)</span> treatment combination. For each site, we define the multiplicity, <span class="math inline">\(m_{i}\)</span>, as the number of populations (i.e., replicates) with a mutation detected at that site, so that the multiplicity in this experiment can range from one to three.</p>
<p>The expected number of mutations with <span class="math inline">\(m_{i} \geq m\)</span> in a sample of total mutations size <span class="math inline">\(n_{tot}\)</span> is:</p>
<p><span class="math display">\[ S(m) \approx \sum_{n \geq m} \frac{n}{n_{tot}} \cdot L_{tot} \cdot \frac{ \left( \frac{n_{tot}}{L_{tot}} \right) ^n}{n!} e^{-n_{tot}/L_{tot}} \]</span></p>
<p>where <span class="math inline">\(L_{tot}\)</span> is the total number of bases in the genome.</p>
<section id="nucleotide-parallelism-by-treatment" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="nucleotide-parallelism-by-treatment"><span class="header-section-number">3.1</span> Nucleotide parallelism by treatment</h2>
<p>Here we will do the estimation separately for each species <span class="math inline">\(\times\)</span> treatment combination.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>nuc_survival <span class="ot">&lt;-</span> mgvars_filt_mb <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(strainID, prey_history, predator_history, pos, ref, alt, replicate) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="co"># multiplicity = number of replicate populations each unique mutation is</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="co"># observed in</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">n_distinct</span>(replicate), <span class="at">.by =</span> <span class="fu">c</span>(strainID, prey_history, predator_history, pos, ref, alt)) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="co"># now calculate the total number of mutations across all replicates so we need</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="co"># to ungroup by mutation position/alt allele but because we still want to</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="co"># determine this value by treatment category we keep the treatment category</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="co"># grouping. However, this should be changed if you want to for example average</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="co"># over all the treatment conditions on a species basis</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">count</span>(m, <span class="at">name =</span> <span class="st">"m_count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> m <span class="sc">*</span> m_count,</span>
<span id="cb6-14"><a href="#cb6-14"></a>         <span class="at">Ntot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb6-15"><a href="#cb6-15"></a>         <span class="at">perc =</span> n <span class="sc">/</span> Ntot <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">left_join</span>(genome_len, <span class="at">by =</span> <span class="fu">join_by</span>(strainID)) <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="fu">arrange</span>(<span class="fu">cur_group_id</span>(), <span class="fu">desc</span>(m)) <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="co">#  dpois() tells the probability mass at a given number of counts. Here we</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>  <span class="co">#  want to get the probability of observing n mutations with multiplicity</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="co">#  = mi (i.e. the counts of mi in the observed data). We assume that</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>  <span class="co">#  mutations independently occur on the genome of size Ltot at a rate of</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>  <span class="co">#  lambda = Ntot/Ltot and that generally the events are rare. Thus this</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>  <span class="co">#  situation can be modeled by the Poisson distribution. We can get the</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>  <span class="co">#  binned number of mutations per level of multiplicity m by multiplying</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="co">#  the probability by the length of the genome and the binned mutations</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>  <span class="co">#  divided by the total number of mutations.</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>  <span class="fu">mutate</span>(<span class="at">m_count_expected =</span> <span class="fu">cumsum</span>((m_count <span class="sc">/</span> Ntot) <span class="sc">*</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>                                     total_len <span class="sc">*</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>                                     <span class="fu">dpois</span>(m, <span class="at">lambda =</span> Ntot <span class="sc">/</span> total_len))) <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>num_contigs) <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>  <span class="fu">relocate</span>(m, n, Ntot, perc, m_count, m_count_expected) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb6-33"><a href="#cb6-33"></a></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co"># setup for plotting</span></span>
<span id="cb6-35"><a href="#cb6-35"></a>nuc_survival_plot <span class="ot">&lt;-</span> nuc_survival <span class="sc">%&gt;%</span> </span>
<span id="cb6-36"><a href="#cb6-36"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb6-37"><a href="#cb6-37"></a>  <span class="co"># when there is only one multiplicity observed for a mutation filter such</span></span>
<span id="cb6-38"><a href="#cb6-38"></a>  <span class="co"># that the multiplicty of that mutation must be greater than one.</span></span>
<span id="cb6-39"><a href="#cb6-39"></a>  <span class="co"># Otherwise include all remaining mutations (m &gt; 0)</span></span>
<span id="cb6-40"><a href="#cb6-40"></a>  <span class="fu">filter</span>(<span class="fu">case_when</span>(<span class="fu">n</span>() <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> m <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb6-41"><a href="#cb6-41"></a>                       <span class="cn">TRUE</span> <span class="sc">~</span> m <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-42"><a href="#cb6-42"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"m_count"</span>, <span class="st">"m_count_expected"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-43"><a href="#cb6-43"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste</span>(strainID, <span class="st">"prey:"</span>, prey_history, <span class="st">"</span><span class="sc">\n</span><span class="st">predator:"</span>, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-44"><a href="#cb6-44"></a>  <span class="co"># and make final plot</span></span>
<span id="cb6-45"><a href="#cb6-45"></a>  <span class="fu">plot_nuc_survival</span>(., <span class="dv">5000</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_parallelism_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of nucleotide multiplicity <span class="math inline">\((m_{i})\)</span> - i.e., the number of replicates with with the same genomic mutation including site and alternative allele - for species <span class="math inline">\(\times\)</span> treatment combination with sufficient sequencing depth and multiplicities <span class="math inline">\(\gt 1\)</span>. The observed data is shown in blue while the null expectation is shown in red. In all cases the observed <span class="math inline">\(m_{i}\)</span> exceeded the null expectation meaning that we must reject the simple null model of uniform mutation distribution in favor of the alternative model where mutations are nonrandom and cluster across replicate populations.
</figcaption>
</figure>
</div>
</section>
<section id="conclusion" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">3.2</span> Conclusion</h2>
<p>Nucleotide parallelism results are presented in Figure <a href="#fig-01" class="quarto-xref">Figure&nbsp;1</a>. For these species and evolution treatments this very simple null model mostly predicts that we should expect fewer than two parallel mutations (same position, same alternative allele) across the three replicate populations. For 8 species <span class="math inline">\(times\)</span> treatment combinations the observed data show an excess of nucleotide parallelism relative to this simple null expectation. In particular all species have at least 1 mutation that is identical across all three replicate evolved populations. HAMBI_1287, HAMBI_1972, and HAMBI_2659 did evolve some new parallel nucleotide mutation de novo in the ancestral prey treatment. These will be interesting to follow up on. Still, multi-hit sites constitute only a small fraction of the total observed mutations across all species (~ 14% across species with multi-hit sites). Thus, we will continue our analysis but looking at the gene level.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>nuc_survival <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">mutate</span>(<span class="at">Ntot_f =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">summarize</span>(<span class="at">perc =</span> <span class="fu">sum</span>(n)<span class="sc">/</span>Ntot_f<span class="sc">*</span><span class="dv">100</span>, <span class="at">.by =</span> <span class="st">"m"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">mutate</span>(<span class="at">cum_perc =</span> <span class="fu">cumsum</span>(perc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["m"],"name":[1],"type":["int"],"align":["right"]},{"label":["perc"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cum_perc"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"5.339486","3":"5.339486"},{"1":"2","2":"8.701384","3":"14.040870"},{"1":"1","2":"85.959130","3":"100.000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="parallelism-at-gene-level" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Parallelism at gene level</h1>
<p>If selection pressures and mutation rates did not vary between genes, the number of mutations in each gene should be proportional to the target gene size. We assume that gene length is a primary driver of the target size. We then define a multiplicity for each gene according to:</p>
<p><span id="eq-01"><span class="math display">\[m_{i} = n_{i} \cdot \frac{\overline{L}}{L_{i}} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\(n_{i}\)</span> is the number of nonsynonymous mutations (i.e., amino acid changing) in <span class="math inline">\(gene_{i}\)</span> across all replicate populations per species, <span class="math inline">\(L_{i}\)</span> is the total number of nonsynonymous sites (i.e., excluding 4-fold degenerate sites) in <span class="math inline">\(gene_{i}\)</span>, and <span class="math inline">\(\overline{L}\)</span> is the average value of <span class="math inline">\(L_{i}\)</span> across all genes in the genome. This definition ensures that under the null hypothesis, all genes have the same expected multiplicity <span class="math inline">\(\overline{m} = n_{tot}/n_{genes}\)</span>.</p>
<p>We next define a null model for gene multiplicity that assumes mutations are assigned to genes with probability:</p>
<p><span id="eq-02"><span class="math display">\[p_{i} \propto L_{i} r_{i} \tag{2}\]</span></span></p>
<p>for some set of enrichment factors <span class="math inline">\(r_{i}\)</span>. In the alternate model, the maximum likelihood estimator of the enrichment factors <span class="math inline">\(r_{i}\)</span> is the ratio of observed to expected gene multiplicities, <span class="math inline">\(r_{i} = m_{i}/\overline{m}\)</span>. The net increase of the log-likelihood relative to the null model (<span class="math inline">\(r_{i} = 1\)</span>) is then given by:</p>
<p><span id="eq-03"><span class="math display">\[\Delta \ell = \sum_{i} n_{i} \log \left ( \frac{m_{i}}{\overline{m}} \right ) \tag{3}\]</span></span></p>
<p>This likelihood ratio estimator is equivalent to the total G-score introduced in earlier work <span class="citation" data-cites="tenaillon2016">(<a href="#ref-tenaillon2016" role="doc-biblioref">Tenaillon et al. 2016</a>)</span>. Here we assess statistical significance using permutation tests following Shoemaker <em>et al.</em> <span class="citation" data-cites="shoemaker2021">(<a href="#ref-shoemaker2021" role="doc-biblioref">Shoemaker et al. 2021</a>)</span>. For permutations tests (n = 10,000) we randomly resample mutations to the observed <span class="math inline">\(n_{tot}\)</span> set size from each species using the multinomial distribution, where the probability of sampling a non-synonymous mutation at <span class="math inline">\(gene_{i}\)</span> was given by <span class="math inline">\(p_{i} = {L_{i}} / {L_{tot}}\)</span> where <span class="math inline">\(L_{i}\)</span> is the total number of nonsynonymous sites in <span class="math inline">\(gene_{i}\)</span> and <span class="math inline">\(L_{tot}\)</span> is the total number of nonsynonymous sites in the genome.</p>
<p>We next identify specific genes enriched for mutations following the criteria of Good <em>et. al</em> . <span class="citation" data-cites="good2017">(<a href="#ref-good2017" role="doc-biblioref">Good et al. 2017</a>)</span>. We calculate a value for each gene using the equation:</p>
<p><span id="eq-04"><span class="math display">\[P_{i} = \sum_{n \geq n_{i}} \frac{ \left ( \frac{n_{tot} L_{i}}{ \overline{L} N_{genes}} \right )^{n}}{n!} e^{- \frac{n_{tot} L_{i} }{\overline{L} N_{genes}}} \tag{4}\]</span></span></p>
<p>Here we only consider genes with <span class="math inline">\(n_{i} \geq 3\)</span> to exclude low values driven primarily by gene length. Under the null hypothesis, the expected number of genes with <span class="math inline">\(P_{i} \geq p\)</span> can be found using a Poisson survival curve given by:</p>
<p><span id="eq-05"><span class="math display">\[\overline{N}(P) \approx \sum_{i=1}^{N_{genes}} \sum_{n=3}^{\infty} \theta (P - P_{i}(n, L_{i}) \cdot \frac{ \left( \frac{n_{tot} L_{i}}{\overline{L} N_{genes}} \right)^{n}}{n!} e^{-\left( \frac{n_{tot} L_{i}}{\overline{L} N_{genes}} \right)} \tag{5}\]</span></span></p>
<p>We can compare this expected number to the observed number of genes <span class="math inline">\(N(P)\)</span> using a critical value (<span class="math inline">\(P^{\ast}\)</span>) such that</p>
<p><span id="eq-06"><span class="math display">\[\frac{\overline{N}(P^{\ast})}{N(P^{\ast})} \leq \alpha \tag{6}\]</span></span></p>
<p>for a given FDR <span class="math inline">\(\alpha\)</span> value of 0.05. For this value we then define the set of significantly enriched genes as:</p>
<p><span id="eq-07"><span class="math display">\[I = \left\{ i : P_{i} \leq P^{\ast} \left(\alpha \right) \right\} \tag{7}\]</span></span></p>
<section id="prepare-input-data-for-non-syn-mutations-only" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="prepare-input-data-for-non-syn-mutations-only"><span class="header-section-number">4.1</span> Prepare input data for non-syn mutations only</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>mgvars_filt_mb_ns <span class="ot">&lt;-</span> mgvars_filt_mb <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="co"># exclude intragenic, intergenic, and synonymous mutations. Also exclude</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="co"># fusion functions because these are weird and also rare. Excluding the</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="co"># modifier category also ensures that we filter out any tRNAs with mutations</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(effect, <span class="st">"intergenic|intragenic|synonymous|fusion"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(impact, <span class="st">"MODIFIER"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="g-score" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="g-score"><span class="header-section-number">4.2</span> G score</h2>
<p>Warning! this takes some time</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>muts_by_sp_treat <span class="ot">&lt;-</span> mgvars_filt_mb_ns <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(freq_alt_complete, time_days)) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">mutate</span>(<span class="at">groupid =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">group_by</span>(groupid, strainID, prey_history, predator_history)</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># doing 10000 permutations</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>result_sp_treat <span class="ot">&lt;-</span> <span class="fu">run_full_gene_parallelism_pipeline</span>(muts_by_sp_treat, degentab, <span class="dv">10000</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># Save this for later</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="fu">write_rds</span>(result_sp_treat, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"parallelism_results_sp_treat.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Read in previous results</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>result_sp_treat <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"parallelism_results_sp_treat.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="simulating-the-number-of-replicates-with-a-parallel-gene-hit" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="simulating-the-number-of-replicates-with-a-parallel-gene-hit"><span class="header-section-number">4.2.1</span> Simulating the number of replicates with a parallel gene hit</h3>
<p>As another sanity check, we took the resamplings from the null distribution and calculated the number of replicates with a parallel gene hit (i.e.&nbsp;the same gene hit in <span class="math inline">\(\geq 2\)</span> experimental replicates) and compared that to the observed distribution. The null distribution reflected the process of sampling a mutation under a multinomial distribution with probability proportional to the total number of nonsynonymous sites <span class="math inline">\(L_{i}\)</span> in <span class="math inline">\(gene_{i}\)</span>. We observed that in 9/16 cases the null distribution produced fewer parallel gene hits than observed in the data from 2 experimental replicates. In all 16 cases the null distribution produced fewer parallel gene hits than observed in the data from 3 experimental replicates. Thus, for some suspicious genes with very high mutational density (see below) we required these genes to be present in all three replicates to include them in our final significant gene lists.</p>
<div id="fig-03" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_parallelism_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Number of genes (y axis) with nonsynonymous mutation hits in <span class="math inline">\(N_{replicates} = \{n : 1 \leq n \leq 3\}\)</span> (x axis). Blue bars depict the distribution observed in the data, while red bars depict the null distribution from resampling mutations to the observed <span class="math inline">\(n_{tot}\)</span> set size from each species using the multinomial distribution, where the probability of sampling a non-synonymous mutation at <span class="math inline">\(gene_{i}\)</span> was dependent only on the number of nonsynonymous sites in the gene.
</figcaption>
</figure>
</div>
</section>
<section id="visualize-the-survival-curves-for-each-treatment-combination" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="visualize-the-survival-curves-for-each-treatment-combination"><span class="header-section-number">4.2.2</span> Visualize the survival curves for each treatment combination</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>survcurv <span class="ot">&lt;-</span> result_sp_treat<span class="sc">$</span>output_df2plot <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(xend)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste</span>(strainID, <span class="st">"prey:"</span>, prey_history, <span class="st">"</span><span class="sc">\n</span><span class="st">predator:"</span>, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="fu">geom_segment</span>(</span>
<span id="cb11-6"><a href="#cb11-6"></a>      <span class="fu">aes</span>(</span>
<span id="cb11-7"><a href="#cb11-7"></a>        <span class="at">x =</span> x,</span>
<span id="cb11-8"><a href="#cb11-8"></a>        <span class="at">y =</span> y,</span>
<span id="cb11-9"><a href="#cb11-9"></a>        <span class="at">xend =</span> xend,</span>
<span id="cb11-10"><a href="#cb11-10"></a>        <span class="at">yend =</span> yend</span>
<span id="cb11-11"><a href="#cb11-11"></a>      ),</span>
<span id="cb11-12"><a href="#cb11-12"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>      <span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>    ) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>    <span class="fu">geom_step</span>( <span class="fu">aes</span>(<span class="at">x =</span> obs_p, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(<span class="st">"$-log_{10}P$"</span>), <span class="at">y =</span> <span class="st">"Number of genes"</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"grey50"</span>)) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19"></a>    <span class="fu">scale_y_log10</span>(</span>
<span id="cb11-20"><a href="#cb11-20"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>),</span>
<span id="cb11-21"><a href="#cb11-21"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">"log10"</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span> <span class="sc">^</span>.x))</span>
<span id="cb11-22"><a href="#cb11-22"></a>    ) <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>    <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"l"</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26"></a>    <span class="fu">theme</span>(</span>
<span id="cb11-27"><a href="#cb11-27"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-28"><a href="#cb11-28"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-29"><a href="#cb11-29"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb11-30"><a href="#cb11-30"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-04" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_parallelism_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The observed <span class="math inline">\((N)\)</span> (blue line) and expected number <span class="math inline">\((\overline{N})\)</span> (grey line) of genes with <span class="math inline">\(P_{i} \leq P\)</span>, as a function of <span class="math inline">\(P\)</span>. The red dashed line denotes the genome-wide significance threshold <span class="math inline">\(P^{*}\)</span> for <span class="math inline">\(\alpha = 0.05\)</span> defined in Equation <a href="#eq-06" class="quarto-xref">Equation&nbsp;6</a>.
</figcaption>
</figure>
</div>
</section>
<section id="overall-g-scores" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="overall-g-scores"><span class="header-section-number">4.2.3</span> Overall G scores</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>result_sp_treat<span class="sc">$</span>output_gscore <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["groupid"],"name":[1],"type":["int"],"align":["right"]},{"label":["observed_g_score"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["pvalue"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["strainID"],"name":[4],"type":["chr"],"align":["left"]},{"label":["prey_history"],"name":[5],"type":["chr"],"align":["left"]},{"label":["predator_history"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"2","2":"5.310767","3":"0.0010","4":"HAMBI_1287","5":"anc","6":"evo"},{"1":"3","2":"5.060385","3":"0.0000","4":"HAMBI_1287","5":"evo","6":"anc"},{"1":"4","2":"6.104585","3":"0.0000","4":"HAMBI_1287","5":"evo","6":"evo"},{"1":"5","2":"6.521849","3":"0.0002","4":"HAMBI_1972","5":"anc","6":"anc"},{"1":"6","2":"4.890527","3":"0.0000","4":"HAMBI_1972","5":"anc","6":"evo"},{"1":"7","2":"3.765116","3":"0.0000","4":"HAMBI_1972","5":"evo","6":"anc"},{"1":"8","2":"5.319056","3":"0.0000","4":"HAMBI_1972","5":"evo","6":"evo"},{"1":"9","2":"7.920390","3":"0.0044","4":"HAMBI_1977","5":"anc","6":"anc"},{"1":"10","2":"4.447789","3":"0.0000","4":"HAMBI_1977","5":"evo","6":"anc"},{"1":"11","2":"6.493475","3":"0.0000","4":"HAMBI_1977","5":"evo","6":"evo"},{"1":"12","2":"6.926177","3":"0.0002","4":"HAMBI_2659","5":"anc","6":"anc"},{"1":"13","2":"4.246637","3":"0.0000","4":"HAMBI_2659","5":"anc","6":"evo"},{"1":"14","2":"4.402549","3":"0.0000","4":"HAMBI_2659","5":"evo","6":"anc"},{"1":"15","2":"5.899601","3":"0.0000","4":"HAMBI_2659","5":"evo","6":"evo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="inspecting-individual-genes" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="inspecting-individual-genes"><span class="header-section-number">4.2.4</span> Inspecting individual genes</h3>
<p>Some genes tend to have a large number of consecutive mutations which is probably due to incorrect read mapping and not real mutations so we will try and filter these out. Well do this by filtering on genes with a mutational density <span class="math inline">\(d_{g} \gt 0.15\)</span>, where the mutational density in gene <span class="math inline">\(g\)</span> was defined as</p>
<p><span class="math display">\[d_{g} = \frac{|A|_{g}}{b_{g} - a_{g}}\]</span></p>
<p>for all genome positions <span class="math inline">\(x\)</span> on the interval <span class="math inline">\(\{x | a_{g} \leq x \leq b_{g}\}\)</span> where <span class="math inline">\(b_{g}\)</span> is the greatest position and <span class="math inline">\(a_{g}\)</span> is the smallest position of observed mutations in gene <span class="math inline">\(g\)</span> and <span class="math inline">\(|A|_{g}\)</span> is the cardinality of the mutation set.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>high_density_genes <span class="ot">&lt;-</span> mgvars_filt_mb_ns <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">group_by</span>(strainID, locus_tag, replicate, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">mutate</span>(<span class="at">mutwindox =</span> pos <span class="sc">-</span> <span class="fu">lag</span>(pos),</span>
<span id="cb13-4"><a href="#cb13-4"></a>         <span class="at">mut_num =</span> <span class="fu">n</span>(),</span>
<span id="cb13-5"><a href="#cb13-5"></a>         <span class="at">mut_dens =</span> <span class="fu">n</span>()<span class="sc">/</span>(<span class="fu">max</span>(pos) <span class="sc">-</span>  <span class="fu">min</span>(pos))) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">filter</span>(mut_dens <span class="sc">!=</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="fu">filter</span>(mut_dens <span class="sc">&gt;</span> <span class="fl">0.15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="fu">distinct</span>(locus_tag) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="fu">pull</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>output_gene_table_filt <span class="ot">&lt;-</span> result_sp_treat<span class="sc">$</span>output_gene_table <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="co"># only genes exceeding the critical pstar value from the survival curves above</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">filter</span>(neg_log10P <span class="sc">&gt;=</span> pstar) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="co"># only include genes with at least 3 hits in the same gene or found in more than one replicate.</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">filter</span>(observed_hits_n_i <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">|</span> n_replicate <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="co"># filters out the problematic genes above unless the number of replicates detected is 2 or more</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">filter</span>(<span class="fu">case_when</span>(n_replicate <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="sc">!</span>(locus_tag <span class="sc">%in%</span> high_density_genes), </span>
<span id="cb14-8"><a href="#cb14-8"></a>                   <span class="cn">TRUE</span> <span class="sc">~</span> n_replicate <span class="sc">&gt;</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="fu">left_join</span>(annotations, <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="convergentdivergent-evolution" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Convergent/divergent evolution</h1>
<p>So now we have a list of enriched genes for each condition. We can see that, for example, H0403_00778 occurs in the significant hit lists of multiple conditions. Now we would like to determine whether a significant gene popping up in these multiple conditions happens more than would be expected by chance.</p>
<section id="jaccard-index-for-convergence-between-treatments" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="jaccard-index-for-convergence-between-treatments"><span class="header-section-number">5.1</span> Jaccard Index for convergence between treatments</h2>
<p>We follow the same approach as in <span class="citation" data-cites="shoemaker2021">(<a href="#ref-shoemaker2021" role="doc-biblioref">Shoemaker et al. 2021</a>)</span> where we simulate the process of randomly sampling <span class="math inline">\(n = 100,000\)</span> draws of significant gene set pairs <span class="math inline">\((I_{i},I_{j})\)</span> from every species <span class="math inline">\(\times\)</span> treatment pair where the probability of sampling a gene is proportional to its length. We then calculate the Jaccard index</p>
<p><span class="math display">\[J(I_{i},I_{j}) = \left|I_{i} \cap I_{j}\right|/ \left|I_{i} \cup I_{j}\right|\]</span> for each null simulation <span class="math inline">\(J(I_{i},I_{j})_{null}\)</span> and calculate an empirical <span class="math inline">\(P\)</span> value for the number of null simulation results exceeding the observed <span class="math inline">\(J(I_{i},I_{j})_{observed}\)</span> to determine whether the intersection of the set of genes was greater (convergence) or less than (divergence) expected by chance.</p>
<section id="hambi_1287" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="hambi_1287"><span class="header-section-number">5.1.1</span> HAMBI_1287</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>H1287_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb15-3"><a href="#cb15-3"></a>                                                     <span class="st">"HAMBI_1287"</span>, prey_history, predator_history)</span>
<span id="cb15-4"><a href="#cb15-4"></a>                               )</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="fu">write_rds</span>(H1287_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1287_cvdv.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treat_pair"],"name":[1],"type":["int"],"align":["right"]},{"label":["p_values"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["groupid1"],"name":[3],"type":["int"],"align":["right"]},{"label":["groupid2"],"name":[4],"type":["int"],"align":["right"]},{"label":["groupname1"],"name":[5],"type":["chr"],"align":["left"]},{"label":["groupname2"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0","3":"1","4":"2","5":"bact: evo, predator: anc","6":"bact: evo, predator: evo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="hambi_1972" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="hambi_1972"><span class="header-section-number">5.1.2</span> HAMBI_1972</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>H1972_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb16-2"><a href="#cb16-2"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb16-3"><a href="#cb16-3"></a>                                                     <span class="st">"HAMBI_1972"</span>, prey_history, predator_history)</span>
<span id="cb16-4"><a href="#cb16-4"></a>                               )</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="fu">write_rds</span>(H1972_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1972_cvdv.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treat_pair"],"name":[1],"type":["int"],"align":["right"]},{"label":["p_values"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["groupid1"],"name":[3],"type":["int"],"align":["right"]},{"label":["groupid2"],"name":[4],"type":["int"],"align":["right"]},{"label":["groupname1"],"name":[5],"type":["chr"],"align":["left"]},{"label":["groupname2"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0.00097","3":"1","4":"2","5":"bact: anc, predator: anc","6":"bact: anc, predator: evo"},{"1":"3","2":"0.00000","3":"1","4":"4","5":"bact: anc, predator: anc","6":"bact: evo, predator: evo"},{"1":"4","2":"0.00434","3":"2","4":"3","5":"bact: anc, predator: evo","6":"bact: evo, predator: anc"},{"1":"5","2":"0.00000","3":"2","4":"4","5":"bact: anc, predator: evo","6":"bact: evo, predator: evo"},{"1":"6","2":"0.00000","3":"3","4":"4","5":"bact: evo, predator: anc","6":"bact: evo, predator: evo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="hambi_1977" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="hambi_1977"><span class="header-section-number">5.1.3</span> HAMBI_1977</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>H1977_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb17-2"><a href="#cb17-2"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb17-3"><a href="#cb17-3"></a>                                                     <span class="st">"HAMBI_1977"</span>, prey_history, predator_history)</span>
<span id="cb17-4"><a href="#cb17-4"></a>                               )</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="fu">write_rds</span>(H1977_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1977_cvdv.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treat_pair"],"name":[1],"type":["int"],"align":["right"]},{"label":["p_values"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["groupid1"],"name":[3],"type":["int"],"align":["right"]},{"label":["groupid2"],"name":[4],"type":["int"],"align":["right"]},{"label":["groupname1"],"name":[5],"type":["chr"],"align":["left"]},{"label":["groupname2"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0","3":"1","4":"2","5":"bact: evo, predator: anc","6":"bact: evo, predator: evo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="hambi_2659" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="hambi_2659"><span class="header-section-number">5.1.4</span> HAMBI_2659</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>H2659_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb18-2"><a href="#cb18-2"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb18-3"><a href="#cb18-3"></a>                                                     <span class="st">"HAMBI_2659"</span>, prey_history, predator_history)</span>
<span id="cb18-4"><a href="#cb18-4"></a>                               )</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="fu">write_rds</span>(H2659_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H2659_cvdv.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treat_pair"],"name":[1],"type":["int"],"align":["right"]},{"label":["p_values"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["groupid1"],"name":[3],"type":["int"],"align":["right"]},{"label":["groupid2"],"name":[4],"type":["int"],"align":["right"]},{"label":["groupname1"],"name":[5],"type":["chr"],"align":["left"]},{"label":["groupname2"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0","3":"1","4":"2","5":"bact: evo, predator: anc","6":"bact: evo, predator: evo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="enrichment-of-individual-cog-categories" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="enrichment-of-individual-cog-categories"><span class="header-section-number">5.2</span> Enrichment of individual COG categories</h2>
<p>So now we have a list of enriched genes for each species. We can see that, for example, some gene functions pop up multiple times (like transcription factors and sensory kinases). Are these different functions popping up across species more that we would expect by chance? Well try and test this using a simulation based approach</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># read back the formatted eggnog data</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>eggnog <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"HAMBI_all_eggnog_formatted.tsv.xz"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>cog_description <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="sc">~</span>COG_category_single,                                                  <span class="sc">~</span>COG_category_long,</span>
<span id="cb20-3"><a href="#cb20-3"></a>            <span class="st">"J"</span>,               <span class="st">"J - Translation, ribosomal structure and biogenesis"</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>            <span class="st">"A"</span>,                               <span class="st">"A - RNA processing and modification"</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>            <span class="st">"K"</span>,                                                 <span class="st">"K  Transcription"</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>            <span class="st">"L"</span>,                         <span class="st">"L - Replication, recombination and repair"</span>,</span>
<span id="cb20-7"><a href="#cb20-7"></a>            <span class="st">"B"</span>,                              <span class="st">"B - Chromatin structure and dynamics"</span>,</span>
<span id="cb20-8"><a href="#cb20-8"></a>            <span class="st">"D"</span>,    <span class="st">"D - Cell cycle control, cell division, chromosome partitioning"</span>,</span>
<span id="cb20-9"><a href="#cb20-9"></a>            <span class="st">"Y"</span>,                                             <span class="st">"Y - Nuclear structure"</span>,</span>
<span id="cb20-10"><a href="#cb20-10"></a>            <span class="st">"V"</span>,                                            <span class="st">"V - Defense mechanisms"</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>            <span class="st">"T"</span>,                                <span class="st">"T - Signal transduction mechanisms"</span>,</span>
<span id="cb20-12"><a href="#cb20-12"></a>            <span class="st">"M"</span>,                        <span class="st">"M - Cell wall/membrane/envelope biogenesis"</span>,</span>
<span id="cb20-13"><a href="#cb20-13"></a>            <span class="st">"N"</span>,                                                 <span class="st">"N - Cell motility"</span>,</span>
<span id="cb20-14"><a href="#cb20-14"></a>            <span class="st">"Z"</span>,                                                  <span class="st">"Z  Cytoskeleton"</span>,</span>
<span id="cb20-15"><a href="#cb20-15"></a>            <span class="st">"W"</span>,                                      <span class="st">"W - Extracellular structures"</span>,</span>
<span id="cb20-16"><a href="#cb20-16"></a>            <span class="st">"U"</span>, <span class="st">"U - Intracellular trafficking, secretion, and vesicular transport"</span>,</span>
<span id="cb20-17"><a href="#cb20-17"></a>            <span class="st">"O"</span>,  <span class="st">"O - Posttranslational modification, protein turnover, chaperones"</span>,</span>
<span id="cb20-18"><a href="#cb20-18"></a>            <span class="st">"X"</span>,                              <span class="st">"X - Mobilome: prophages, transposons"</span>,</span>
<span id="cb20-19"><a href="#cb20-19"></a>            <span class="st">"C"</span>,                              <span class="st">"C - Energy production and conversion"</span>,</span>
<span id="cb20-20"><a href="#cb20-20"></a>            <span class="st">"G"</span>,                         <span class="st">"G - Carbohydrate transport and metabolism"</span>,</span>
<span id="cb20-21"><a href="#cb20-21"></a>            <span class="st">"E"</span>,                           <span class="st">"E - Amino acid transport and metabolism"</span>,</span>
<span id="cb20-22"><a href="#cb20-22"></a>            <span class="st">"F"</span>,                           <span class="st">"F - Nucleotide transport and metabolism"</span>,</span>
<span id="cb20-23"><a href="#cb20-23"></a>            <span class="st">"H"</span>,                             <span class="st">"H - Coenzyme transport and metabolism"</span>,</span>
<span id="cb20-24"><a href="#cb20-24"></a>            <span class="st">"I"</span>,                                <span class="st">"I - Lipid transport and metabolism"</span>,</span>
<span id="cb20-25"><a href="#cb20-25"></a>            <span class="st">"P"</span>,                        <span class="st">"P - Inorganic ion transport and metabolism"</span>,</span>
<span id="cb20-26"><a href="#cb20-26"></a>            <span class="st">"Q"</span>,  <span class="st">"Q - Secondary metabolites biosynthesis, transport and catabolism"</span>,</span>
<span id="cb20-27"><a href="#cb20-27"></a>            <span class="st">"R"</span>,                              <span class="st">"R - General function prediction only"</span>,</span>
<span id="cb20-28"><a href="#cb20-28"></a>            <span class="st">"S"</span>,                                              <span class="st">"S - Function unknown"</span></span>
<span id="cb20-29"><a href="#cb20-29"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>save a copy of significantly parallel genes as a table</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>output_gene_table_filt_cog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog) <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">rename</span>(<span class="at">prokka_annotation =</span> product) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">relocate</span>(strainID, prey_history, predator_history, COG_category_long, Preferred_name, Description, prokka_annotation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(locus_tag, strainID)`</code></pre>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">write_tsv</span>(output_gene_table_filt_cog, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"enriched_parallel_genes.tsv"</span>))</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>output_gene_table_filt_cog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["strainID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prey_history"],"name":[2],"type":["chr"],"align":["left"]},{"label":["predator_history"],"name":[3],"type":["chr"],"align":["left"]},{"label":["COG_category_long"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Preferred_name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Description"],"name":[6],"type":["chr"],"align":["left"]},{"label":["prokka_annotation"],"name":[7],"type":["chr"],"align":["left"]},{"label":["groupid"],"name":[8],"type":["int"],"align":["right"]},{"label":["locus_tag"],"name":[9],"type":["chr"],"align":["left"]},{"label":["neg_log10P"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["pstar"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["nonsyn_sites"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["observed_hits_n_i"],"name":[13],"type":["int"],"align":["right"]},{"label":["n_replicate"],"name":[14],"type":["int"],"align":["right"]},{"label":["gene_multiplicity_m_i"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["C"],"name":[16],"type":["int"],"align":["right"]},{"label":["E"],"name":[17],"type":["int"],"align":["right"]},{"label":["A"],"name":[18],"type":["int"],"align":["right"]},{"label":["chrom"],"name":[19],"type":["chr"],"align":["left"]},{"label":["feature_type"],"name":[20],"type":["chr"],"align":["left"]},{"label":["start"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["end"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["strand"],"name":[23],"type":["chr"],"align":["left"]},{"label":["cds_length"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["ns_length"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["f0"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["f2"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["f3"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["f4"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["gene"],"name":[30],"type":["chr"],"align":["left"]},{"label":["db_xref"],"name":[31],"type":["chr"],"align":["left"]},{"label":["eC_number"],"name":[32],"type":["chr"],"align":["left"]},{"label":["rpt_family"],"name":[33],"type":["chr"],"align":["left"]},{"label":["rpt_type"],"name":[34],"type":["chr"],"align":["left"]},{"label":["description"],"name":[35],"type":["chr"],"align":["left"]},{"label":["COG_category_single"],"name":[36],"type":["chr"],"align":["left"]},{"label":["seed_ortholog"],"name":[37],"type":["chr"],"align":["left"]},{"label":["evalue"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["score"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["eggNOG_OGs"],"name":[40],"type":["chr"],"align":["left"]},{"label":["max_annot_lvl"],"name":[41],"type":["chr"],"align":["left"]},{"label":["COG_category"],"name":[42],"type":["chr"],"align":["left"]},{"label":["GOs"],"name":[43],"type":["chr"],"align":["left"]},{"label":["EC"],"name":[44],"type":["chr"],"align":["left"]},{"label":["KEGG_ko"],"name":[45],"type":["chr"],"align":["left"]},{"label":["KEGG_Pathway"],"name":[46],"type":["chr"],"align":["left"]},{"label":["KEGG_Module"],"name":[47],"type":["chr"],"align":["left"]},{"label":["KEGG_Reaction"],"name":[48],"type":["chr"],"align":["left"]},{"label":["KEGG_rclass"],"name":[49],"type":["chr"],"align":["left"]},{"label":["BRITE"],"name":[50],"type":["chr"],"align":["left"]},{"label":["KEGG_TC"],"name":[51],"type":["chr"],"align":["left"]},{"label":["CAZy"],"name":[52],"type":["chr"],"align":["left"]},{"label":["BiGG_Reaction"],"name":[53],"type":["chr"],"align":["left"]},{"label":["PFAMs"],"name":[54],"type":["chr"],"align":["left"]}],"data":[{"1":"HAMBI_1287","2":"evo","3":"anc","4":"G - Carbohydrate transport and metabolism","5":"agaS","6":"SIS domain","7":"Putative D-galactosamine-6-phosphate deaminase AgaS","8":"3","9":"H1287_00563","10":"8.375889","11":"8.103222","12":"937","13":"2","14":"2","15":"1.7013359","16":"1","17":"1","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"580681","22":"581826","23":"-","24":"1146","25":"937","26":"744","27":"169","28":"24","29":"209","30":"agaS","31":"COG:COG2222","32":"3.5.99.-","33":"NA","34":"NA","35":"NA","36":"G","37":"469595.CSAG_02944","38":"2.17e-250","39":"690","40":"COG2222@1|root,COG2222@2|Bacteria,1NICK@1224|Proteobacteria,1RRU0@1236|Gammaproteobacteria,3WY6N@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"G","43":"GO:0003674,GO:0003824,GO:0005215,GO:0005575,GO:0005623,GO:0005886,GO:0005887,GO:0006040,GO:0006044,GO:0006046,GO:0006810,GO:0008150,GO:0008152,GO:0008448,GO:0008643,GO:0009056,GO:0009401,GO:0015144,GO:0016020,GO:0016021,GO:0016787,GO:0016810,GO:0016811,GO:0019213,GO:0022857,GO:0031224,GO:0031226,GO:0034219,GO:0044425,GO:0044459,GO:0044464,GO:0046348,GO:0051119,GO:0051179,GO:0051234,GO:0055085,GO:0071702,GO:0071704,GO:0071944,GO:1901071,GO:1901072,GO:1901135,GO:1901136,GO:1901575","44":"-","45":"ko:K02082","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko01000","51":"-","52":"-","53":"-","54":"SIS"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"artM5","6":"Binding-protein-dependent transport system inner membrane component","7":"Inner membrane amino-acid ABC transporter permease protein YhdY","8":"3","9":"H1287_02337","10":"9.472020","11":"8.103222","12":"540","13":"2","14":"2","15":"2.9521328","16":"1","17":"1","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"2490100","22":"2490777","23":"+","24":"678","25":"540","26":"434","27":"89","28":"17","29":"138","30":"yhdY_2","31":"COG:COG0765","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"1080067.BAZH01000013_gene1058","38":"3.78e-147","39":"416","40":"COG0765@1|root,COG0765@2|Bacteria,1PT12@1224|Proteobacteria,1RRQK@1236|Gammaproteobacteria,3WW71@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"P","43":"-","44":"-","45":"ko:K02029","46":"-","47":"M00236","48":"-","49":"-","50":"ko00000,ko00002,ko02000","51":"3.A.1.3","52":"-","53":"-","54":"BPD_transp_1"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"C - Energy production and conversion","5":"-","6":"Molybdopterin oxidoreductase Fe4S4 domain","7":"Formate dehydrogenase H","8":"3","9":"H1287_03912","10":"10.359299","11":"8.103222","12":"346","13":"2","14":"2","15":"4.6073749","16":"1","17":"1","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"4172633","22":"4173052","23":"+","24":"420","25":"346","26":"276","27":"62","28":"8","29":"74","30":"fdhF_2","31":"COG:COG0243","32":"1.17.1.9","33":"NA","34":"NA","35":"NA","36":"C","37":"1080067.BAZH01000003_gene3657","38":"1.15e-99","39":"288","40":"COG3383@1|root,COG3383@2|Bacteria,1PDYT@1224|Proteobacteria,1RXCD@1236|Gammaproteobacteria,3WWJ6@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"C","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"Molybdop_Fe4S4,Molybdopterin"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"S - Function unknown","5":"srfB","6":"Virulence factor SrfB","7":"hypothetical protein","8":"3","9":"H1287_02160","10":"10.442284","11":"8.103222","12":"2459","13":"3","14":"1","15":"0.9724390","16":"3","17":"0","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"2300376","22":"2303357","23":"-","24":"2982","25":"2459","26":"1908","27":"515","28":"36","29":"523","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"S","37":"469595.CSAG_01397","38":"0.00e+00","39":"1898","40":"COG4457@1|root,COG4457@2|Bacteria,1MVRQ@1224|Proteobacteria,1RPSQ@1236|Gammaproteobacteria,3WW1Z@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"S","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"SrfB"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"Q - Secondary metabolites biosynthesis, transport and catabolism","5":"dhaR","6":"Bacterial regulatory protein, Fis family","7":"PTS-dependent dihydroxyacetone kinase operon regulatory protein","8":"3","9":"H1287_00623","10":"11.694499","11":"8.103222","12":"1612","13":"3","14":"1","15":"1.4833918","16":"0","17":"3","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"648154","22":"650079","23":"+","24":"1926","25":"1612","26":"1222","27":"355","28":"35","29":"314","30":"dhaR","31":"COG:COG3284","32":"NA","33":"NA","34":"NA","35":"NA","36":"Q","37":"500640.CIT292_10833","38":"0.00e+00","39":"1206","40":"COG3284@1|root,COG3284@2|Bacteria,1NRG5@1224|Proteobacteria,1RQQD@1236|Gammaproteobacteria,3WXRM@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"KQ","43":"GO:0006139,GO:0006351,GO:0006355,GO:0006725,GO:0006807,GO:0008150,GO:0008152,GO:0009058,GO:0009059,GO:0009889,GO:0009987,GO:0010467,GO:0010468,GO:0010556,GO:0016070,GO:0018130,GO:0019219,GO:0019222,GO:0019438,GO:0031323,GO:0031326,GO:0032774,GO:0034641,GO:0034645,GO:0034654,GO:0043170,GO:0044237,GO:0044238,GO:0044249,GO:0044260,GO:0044271,GO:0046483,GO:0050789,GO:0050794,GO:0051171,GO:0051252,GO:0060255,GO:0065007,GO:0071704,GO:0080090,GO:0090304,GO:0097659,GO:1901360,GO:1901362,GO:1901576,GO:1903506,GO:2000112,GO:2001141","44":"-","45":"ko:K05880","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03000","51":"-","52":"-","53":"-","54":"GAF,HTH_8,PAS,Sigma54_activat"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"M - Cell wall/membrane/envelope biogenesis","5":"ybhG","6":"Biotin-lipoyl like","7":"hypothetical protein","8":"3","9":"H1287_02829","10":"13.745230","11":"8.103222","12":"810","13":"3","14":"1","15":"2.9521328","16":"3","17":"0","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"3012097","22":"3013092","23":"+","24":"996","25":"810","26":"643","27":"157","28":"10","29":"186","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"UPF0194 membrane protein YbhG","36":"M","37":"637910.ROD_07951","38":"5.82e-197","39":"550","40":"COG0845@1|root,COG0845@2|Bacteria,1MUG6@1224|Proteobacteria,1RP16@1236|Gammaproteobacteria,3WV94@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"M","43":"GO:0005575,GO:0005623,GO:0005886,GO:0008150,GO:0016020,GO:0042221,GO:0044464,GO:0046677,GO:0050896,GO:0071944","44":"-","45":"ko:K01993","46":"-","47":"-","48":"-","49":"-","50":"ko00000","51":"-","52":"-","53":"-","54":"Biotin_lipoyl_2,HlyD_3,HlyD_D23"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"S - Function unknown","5":"-","6":"Pfam:DUF1341","7":"2-dehydro-3-deoxy-phosphogluconate aldolase","8":"3","9":"H1287_00057","10":"14.617103","11":"8.103222","12":"605","13":"3","14":"2","15":"3.9524423","16":"1","17":"2","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"61215","22":"61958","23":"+","24":"744","25":"605","26":"491","27":"98","28":"16","29":"139","30":"dgaF_1","31":"NA","32":"4.1.2.14","33":"NA","34":"NA","35":"NA","36":"S","37":"35703.DQ02_00240","38":"6.17e-157","39":"442","40":"2DBAP@1|root,2Z844@2|Bacteria,1R59N@1224|Proteobacteria,1RYTS@1236|Gammaproteobacteria,3WXZY@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"S","43":"-","44":"4.1.2.14","45":"ko:K17463","46":"ko00030,ko01100,ko01120,map00030,map01100,map01120","47":"M00061,M00631","48":"R05605","49":"RC00307,RC00435","50":"ko00000,ko00001,ko00002,ko01000","51":"-","52":"-","53":"-","54":"KDGP_aldolase"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"cbiM","6":"Part of the energy-coupling factor (ECF) transporter complex CbiMNOQ involved in cobalt import","7":"Cobalt transport protein CbiM","8":"3","9":"H1287_01647","10":"14.671960","11":"8.103222","12":"594","13":"3","14":"1","15":"4.0256357","16":"0","17":"0","18":"3","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"1749065","22":"1749802","23":"+","24":"738","25":"594","26":"472","27":"107","28":"15","29":"144","30":"cbiM","31":"COG:COG0310","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"571.MC52_02905","38":"1.48e-163","39":"459","40":"COG0310@1|root,COG0310@2|Bacteria,1NTQK@1224|Proteobacteria,1RS8D@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"P","43":"-","44":"-","45":"ko:K02007","46":"ko02010,map02010","47":"M00245,M00246","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.18,3.A.1.22,3.A.1.23","52":"-","53":"-","54":"CbiM"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"afuB","6":"Binding-protein-dependent transport system inner membrane component","7":"hypothetical protein","8":"3","9":"H1287_03251","10":"16.198470","11":"8.103222","12":"1685","13":"4","14":"2","15":"1.8921682","16":"2","17":"2","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"3464473","22":"3466551","23":"+","24":"2079","25":"1685","26":"1344","27":"273","28":"68","29":"394","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"469595.CSAG_00140","38":"0.00e+00","39":"1292","40":"COG1178@1|root,COG1178@2|Bacteria,1MXZZ@1224|Proteobacteria,1RY3W@1236|Gammaproteobacteria,3WWVY@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"P","43":"GO:0005575,GO:0005623,GO:0005886,GO:0016020,GO:0044464,GO:0071944","44":"-","45":"ko:K02011","46":"ko02010,map02010","47":"M00190","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.10","52":"-","53":"-","54":"BPD_transp_1"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"K  Transcription","5":"ompR","6":"Response regulator receiver","7":"Transcriptional regulatory protein OmpR","8":"3","9":"H1287_00316","10":"39.224321","11":"8.103222","12":"726","13":"7","14":"3","15":"7.6853045","16":"3","17":"2","18":"2","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"347273","22":"348145","23":"+","24":"873","25":"726","26":"565","27":"146","28":"15","29":"147","30":"ompR_1","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"1045856.EcWSU1_04191","38":"6.92e-169","39":"474","40":"COG0745@1|root,COG0745@2|Bacteria,1MY3D@1224|Proteobacteria,1RPKN@1236|Gammaproteobacteria,3X0ZQ@547|Enterobacter","41":"1236|Gammaproteobacteria","42":"K","43":"GO:0000156,GO:0000160,GO:0000976,GO:0001067,GO:0001130,GO:0001216,GO:0001217,GO:0003674,GO:0003676,GO:0003677,GO:0003690,GO:0003700,GO:0005488,GO:0005575,GO:0005622,GO:0005623,GO:0005737,GO:0006355,GO:0007154,GO:0007165,GO:0008150,GO:0009889,GO:0009890,GO:0009891,GO:0009892,GO:0009893,GO:0009987,GO:0010468,GO:0010556,GO:0010557,GO:0010558,GO:0010604,GO:0010605,GO:0010628,GO:0010629,GO:0019219,GO:0019222,GO:0023052,GO:0031323,GO:0031324,GO:0031325,GO:0031326,GO:0031327,GO:0031328,GO:0032991,GO:0032993,GO:0035556,GO:0043565,GO:0044212,GO:0044424,GO:0044464,GO:0045892,GO:0045893,GO:0045934,GO:0045935,GO:0048518,GO:0048519,GO:0048522,GO:0048523,GO:0050789,GO:0050794,GO:0050896,GO:0051171,GO:0051172,GO:0051173,GO:0051252,GO:0051253,GO:0051254,GO:0051716,GO:0060089,GO:0060255,GO:0065007,GO:0080090,GO:0097159,GO:0140110,GO:1901363,GO:1902679,GO:1902680,GO:1903506,GO:1903507,GO:1903508,GO:1990837,GO:2000112,GO:2000113,GO:2001141","44":"-","45":"ko:K07659","46":"ko02020,ko02026,map02020,map02026","47":"M00445,M00742,M00743","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02022","51":"-","52":"-","53":"-","54":"Response_reg,Trans_reg_C"},{"1":"HAMBI_1287","2":"evo","3":"anc","4":"T - Signal transduction mechanisms","5":"-","6":"diguanylate cyclase","7":"hypothetical protein","8":"3","9":"H1287_02172","10":"39.224321","11":"8.103222","12":"923","13":"17","14":"3","15":"14.6807039","16":"8","17":"3","18":"6","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"2315639","22":"2316742","23":"-","24":"1104","25":"923","26":"715","27":"184","28":"24","29":"181","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"T","37":"399742.Ent638_1946","38":"1.08e-127","39":"378","40":"COG2199@1|root,COG3706@2|Bacteria,1R7HC@1224|Proteobacteria,1RYTK@1236|Gammaproteobacteria,3X21K@547|Enterobacter","41":"1236|Gammaproteobacteria","42":"T","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"GGDEF,MASE5"},{"1":"HAMBI_1287","2":"evo","3":"evo","4":"S - Function unknown","5":"srfB","6":"Virulence factor SrfB","7":"hypothetical protein","8":"4","9":"H1287_02160","10":"12.355187","11":"8.578115","12":"2459","13":"3","14":"1","15":"0.9724390","16":"3","17":"0","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"2300376","22":"2303357","23":"-","24":"2982","25":"2459","26":"1908","27":"515","28":"36","29":"523","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"S","37":"469595.CSAG_01397","38":"0.00e+00","39":"1898","40":"COG4457@1|root,COG4457@2|Bacteria,1MVRQ@1224|Proteobacteria,1RPSQ@1236|Gammaproteobacteria,3WW1Z@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"S","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"SrfB"},{"1":"HAMBI_1287","2":"evo","3":"evo","4":"M - Cell wall/membrane/envelope biogenesis","5":"ybhG","6":"Biotin-lipoyl like","7":"hypothetical protein","8":"4","9":"H1287_02829","10":"15.671648","11":"8.578115","12":"810","13":"3","14":"1","15":"2.9521328","16":"3","17":"0","18":"0","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"3012097","22":"3013092","23":"+","24":"996","25":"810","26":"643","27":"157","28":"10","29":"186","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"UPF0194 membrane protein YbhG","36":"M","37":"637910.ROD_07951","38":"5.82e-197","39":"550","40":"COG0845@1|root,COG0845@2|Bacteria,1MUG6@1224|Proteobacteria,1RP16@1236|Gammaproteobacteria,3WV94@544|Citrobacter","41":"1236|Gammaproteobacteria","42":"M","43":"GO:0005575,GO:0005623,GO:0005886,GO:0008150,GO:0016020,GO:0042221,GO:0044464,GO:0046677,GO:0050896,GO:0071944","44":"-","45":"ko:K01993","46":"-","47":"-","48":"-","49":"-","50":"ko00000","51":"-","52":"-","53":"-","54":"Biotin_lipoyl_2,HlyD_3,HlyD_D23"},{"1":"HAMBI_1287","2":"evo","3":"evo","4":"T - Signal transduction mechanisms","5":"-","6":"diguanylate cyclase","7":"hypothetical protein","8":"4","9":"H1287_02172","10":"36.736801","11":"8.578115","12":"923","13":"13","14":"3","15":"11.2264206","16":"6","17":"4","18":"3","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"2315639","22":"2316742","23":"-","24":"1104","25":"923","26":"715","27":"184","28":"24","29":"181","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"T","37":"399742.Ent638_1946","38":"1.08e-127","39":"378","40":"COG2199@1|root,COG3706@2|Bacteria,1R7HC@1224|Proteobacteria,1RYTK@1236|Gammaproteobacteria,3X21K@547|Enterobacter","41":"1236|Gammaproteobacteria","42":"T","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"GGDEF,MASE5"},{"1":"HAMBI_1287","2":"evo","3":"evo","4":"K  Transcription","5":"ompR","6":"Response regulator receiver","7":"Transcriptional regulatory protein OmpR","8":"4","9":"H1287_00316","10":"59.762651","11":"8.578115","12":"726","13":"7","14":"3","15":"7.6853045","16":"3","17":"2","18":"2","19":"HAMBI_1287_chrm01_circ","20":"CDS","21":"347273","22":"348145","23":"+","24":"873","25":"726","26":"565","27":"146","28":"15","29":"147","30":"ompR_1","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"1045856.EcWSU1_04191","38":"6.92e-169","39":"474","40":"COG0745@1|root,COG0745@2|Bacteria,1MY3D@1224|Proteobacteria,1RPKN@1236|Gammaproteobacteria,3X0ZQ@547|Enterobacter","41":"1236|Gammaproteobacteria","42":"K","43":"GO:0000156,GO:0000160,GO:0000976,GO:0001067,GO:0001130,GO:0001216,GO:0001217,GO:0003674,GO:0003676,GO:0003677,GO:0003690,GO:0003700,GO:0005488,GO:0005575,GO:0005622,GO:0005623,GO:0005737,GO:0006355,GO:0007154,GO:0007165,GO:0008150,GO:0009889,GO:0009890,GO:0009891,GO:0009892,GO:0009893,GO:0009987,GO:0010468,GO:0010556,GO:0010557,GO:0010558,GO:0010604,GO:0010605,GO:0010628,GO:0010629,GO:0019219,GO:0019222,GO:0023052,GO:0031323,GO:0031324,GO:0031325,GO:0031326,GO:0031327,GO:0031328,GO:0032991,GO:0032993,GO:0035556,GO:0043565,GO:0044212,GO:0044424,GO:0044464,GO:0045892,GO:0045893,GO:0045934,GO:0045935,GO:0048518,GO:0048519,GO:0048522,GO:0048523,GO:0050789,GO:0050794,GO:0050896,GO:0051171,GO:0051172,GO:0051173,GO:0051252,GO:0051253,GO:0051254,GO:0051716,GO:0060089,GO:0060255,GO:0065007,GO:0080090,GO:0097159,GO:0140110,GO:1901363,GO:1902679,GO:1902680,GO:1903506,GO:1903507,GO:1903508,GO:1990837,GO:2000112,GO:2000113,GO:2001141","44":"-","45":"ko:K07659","46":"ko02020,ko02026,map02020,map02026","47":"M00445,M00742,M00743","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02022","51":"-","52":"-","53":"-","54":"Response_reg,Trans_reg_C"},{"1":"HAMBI_1972","2":"anc","3":"anc","4":"M - Cell wall/membrane/envelope biogenesis","5":"lamB","6":"involved in the transport of maltose and maltodextrins","7":"Maltoporin","8":"5","9":"H1972_01106","10":"12.052243","11":"9.086965","12":"1107","13":"2","14":"2","15":"1.4408057","16":"1","17":"1","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1167031","22":"1168353","23":"+","24":"1323","25":"1107","26":"888","27":"206","28":"13","29":"216","30":"lamB_2","31":"COG:COG4580","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"380703.AHA_1166","38":"1.33e-291","39":"813","40":"COG4580@1|root,COG4580@2|Bacteria,1MX77@1224|Proteobacteria,1RPMF@1236|Gammaproteobacteria,1Y5CH@135624|Aeromonadales","41":"135624|Aeromonadales","42":"M","43":"-","44":"-","45":"ko:K02024","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.3.1.1","52":"-","53":"-","54":"LamB"},{"1":"HAMBI_1972","2":"anc","3":"evo","4":"P - Inorganic ion transport and metabolism","5":"-","6":"transport system permease component","7":"hypothetical protein","8":"6","9":"H1972_02826","10":"12.489195","11":"8.116082","12":"1263","13":"3","14":"1","15":"1.8942659","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"3139841","22":"3141493","23":"+","24":"1653","25":"1263","26":"1030","27":"217","28":"16","29":"390","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"380703.AHA_1545","38":"4.71e-252","39":"708","40":"COG4135@1|root,COG4135@2|Bacteria,1MV6R@1224|Proteobacteria,1RR4B@1236|Gammaproteobacteria,1Y56H@135624|Aeromonadales","41":"135624|Aeromonadales","42":"P","43":"-","44":"-","45":"ko:K05778","46":"-","47":"M00192","48":"-","49":"-","50":"ko00000,ko00002,ko02000","51":"-","52":"-","53":"-","54":"BPD_transp_1"},{"1":"HAMBI_1972","2":"anc","3":"evo","4":"S - Function unknown","5":"-","6":"Protein of unknown function DUF115","7":"hypothetical protein","8":"6","9":"H1972_00421","10":"13.781179","11":"8.116082","12":"819","13":"3","14":"1","15":"2.9211940","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"447796","22":"448797","23":"+","24":"1002","25":"819","26":"630","27":"180","28":"9","29":"183","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"S","37":"382245.ASA_0374","38":"2.18e-181","39":"528","40":"COG2604@1|root,COG2604@2|Bacteria,1NNJY@1224|Proteobacteria,1SI36@1236|Gammaproteobacteria,1Y61D@135624|Aeromonadales","41":"135624|Aeromonadales","42":"S","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"-"},{"1":"HAMBI_1972","2":"anc","3":"evo","4":"M - Cell wall/membrane/envelope biogenesis","5":"lamB","6":"involved in the transport of maltose and maltodextrins","7":"Maltoporin","8":"6","9":"H1972_01106","10":"36.736801","11":"8.116082","12":"1107","13":"13","14":"3","15":"9.3652371","16":"4","17":"6","18":"3","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1167031","22":"1168353","23":"+","24":"1323","25":"1107","26":"888","27":"206","28":"13","29":"216","30":"lamB_2","31":"COG:COG4580","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"380703.AHA_1166","38":"1.33e-291","39":"813","40":"COG4580@1|root,COG4580@2|Bacteria,1MX77@1224|Proteobacteria,1RPMF@1236|Gammaproteobacteria,1Y5CH@135624|Aeromonadales","41":"135624|Aeromonadales","42":"M","43":"-","44":"-","45":"ko:K02024","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.3.1.1","52":"-","53":"-","54":"LamB"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"K  Transcription","5":"rpoB","6":"DNA-dependent RNA polymerase catalyzes the transcription of DNA into RNA using the four ribonucleoside triphosphates as substrates","7":"DNA-directed RNA polymerase subunit beta","8":"7","9":"H1972_00269","10":"6.931670","11":"6.567460","12":"3343","13":"3","14":"1","15":"0.7156619","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"290580","22":"294608","23":"+","24":"4029","25":"3343","26":"2607","27":"655","28":"81","29":"686","30":"rpoB","31":"COG:COG0085","32":"2.7.7.6","33":"NA","34":"NA","35":"NA","36":"K","37":"1448139.AI20_20900","38":"0.00e+00","39":"2600","40":"COG0085@1|root,COG0085@2|Bacteria,1MUC4@1224|Proteobacteria,1RMK0@1236|Gammaproteobacteria,1Y3R5@135624|Aeromonadales","41":"135624|Aeromonadales","42":"K","43":"-","44":"2.7.7.6","45":"ko:K03043","46":"ko00230,ko00240,ko01100,ko03020,map00230,map00240,map01100,map03020","47":"M00183","48":"R00435,R00441,R00442,R00443","49":"RC02795","50":"br01611,ko00000,ko00001,ko00002,ko01000,ko03021,ko03400","51":"-","52":"-","53":"-","54":"RNA_pol_Rpb2_1,RNA_pol_Rpb2_2,RNA_pol_Rpb2_3,RNA_pol_Rpb2_45,RNA_pol_Rpb2_6,RNA_pol_Rpb2_7"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"D - Cell cycle control, cell division, chromosome partitioning","5":"smc","6":"Required for chromosome condensation and partitioning","7":"Chromosome partition protein Smc","8":"7","9":"H1972_01157","10":"7.488363","11":"6.567460","12":"2754","13":"3","14":"1","15":"0.8687211","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1227486","22":"1230860","23":"+","24":"3375","25":"2754","26":"2140","27":"580","28":"34","29":"621","30":"smc","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"D","37":"380703.AHA_1227","38":"0.00e+00","39":"1754","40":"COG1196@1|root,COG1196@2|Bacteria,1MUAQ@1224|Proteobacteria,1RNA6@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"D","43":"-","44":"-","45":"ko:K03529","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03036","51":"-","52":"-","53":"-","54":"SMC_N,SMC_hinge"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"V - Defense mechanisms","5":"-","6":"Efflux pump membrane transporter","7":"Multidrug resistance protein MexB","8":"7","9":"H1972_01043","10":"7.804096","11":"6.567460","12":"2469","13":"3","14":"2","15":"0.9689987","16":"1","17":"2","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1103597","22":"1106713","23":"-","24":"3117","25":"2469","26":"2018","27":"396","28":"55","29":"648","30":"mexB","31":"COG:COG0841","32":"NA","33":"NA","34":"NA","35":"NA","36":"V","37":"1448139.AI20_12570","38":"0.00e+00","39":"1825","40":"COG0841@1|root,COG0841@2|Bacteria,1MU48@1224|Proteobacteria,1RMBN@1236|Gammaproteobacteria,1Y3W3@135624|Aeromonadales","41":"135624|Aeromonadales","42":"V","43":"-","44":"-","45":"ko:K18146","46":"ko01501,map01501","47":"M00649","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko01504,ko02000","51":"2.A.6.2.40","52":"-","53":"-","54":"ACR_tran"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"-","6":"transport system permease component","7":"hypothetical protein","8":"7","9":"H1972_02826","10":"9.764216","11":"6.567460","12":"1263","13":"3","14":"1","15":"1.8942659","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"3139841","22":"3141493","23":"+","24":"1653","25":"1263","26":"1030","27":"217","28":"16","29":"390","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"380703.AHA_1545","38":"4.71e-252","39":"708","40":"COG4135@1|root,COG4135@2|Bacteria,1MV6R@1224|Proteobacteria,1RR4B@1236|Gammaproteobacteria,1Y56H@135624|Aeromonadales","41":"135624|Aeromonadales","42":"P","43":"-","44":"-","45":"ko:K05778","46":"-","47":"M00192","48":"-","49":"-","50":"ko00000,ko00002,ko02000","51":"-","52":"-","53":"-","54":"BPD_transp_1"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"E - Amino acid transport and metabolism","5":"-","6":"glutamine synthetase","7":"Gamma-glutamylputrescine synthetase PuuA","8":"7","9":"H1972_00157","10":"10.071588","11":"6.567460","12":"1138","13":"3","14":"1","15":"2.1023356","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"172564","22":"173922","23":"+","24":"1359","25":"1138","26":"889","27":"228","28":"21","29":"221","30":"puuA","31":"COG:COG0174","32":"6.3.1.11","33":"NA","34":"NA","35":"NA","36":"E","37":"382245.ASA_0172","38":"0.00e+00","39":"882","40":"COG0174@1|root,COG0174@2|Bacteria,1MU6V@1224|Proteobacteria,1RPNZ@1236|Gammaproteobacteria,1Y3X9@135624|Aeromonadales","41":"135624|Aeromonadales","42":"E","43":"-","44":"6.3.1.2","45":"ko:K01915","46":"ko00220,ko00250,ko00630,ko00910,ko01100,ko01120,ko01230,ko02020,ko04217,ko04724,ko04727,map00220,map00250,map00630,map00910,map01100,map01120,map01230,map02020,map04217,map04724,map04727","47":"-","48":"R00253","49":"RC00010,RC02798","50":"ko00000,ko00001,ko01000,ko04147","51":"-","52":"-","53":"-","54":"Gln-synt_C"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"-","6":"Required for the activity of the bacterial periplasmic transport system of putrescine","7":"Putrescine-binding periplasmic protein SpuD","8":"7","9":"H1972_00159","10":"10.703556","11":"6.567460","12":"919","13":"3","14":"1","15":"2.6033274","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"175629","22":"176726","23":"+","24":"1098","25":"919","26":"720","27":"181","28":"18","29":"179","30":"spuD_1","31":"COG:COG0687","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"998088.B565_0131","38":"6.07e-253","39":"695","40":"COG0687@1|root,COG0687@2|Bacteria,1MUYW@1224|Proteobacteria,1RM7W@1236|Gammaproteobacteria,1Y3J9@135624|Aeromonadales","41":"135624|Aeromonadales","42":"P","43":"-","44":"-","45":"ko:K11073","46":"ko02010,map02010","47":"M00300","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.11.2","52":"-","53":"-","54":"SBP_bac_8"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"M - Cell wall/membrane/envelope biogenesis","5":"-","6":"Belongs to the Gram-negative porin family","7":"Outer membrane porin PhoE","8":"7","9":"H1972_01539","10":"10.848882","11":"6.567460","12":"875","13":"3","14":"1","15":"2.7342376","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1655306","22":"1656343","23":"+","24":"1038","25":"875","26":"682","27":"176","28":"17","29":"163","30":"phoE_1","31":"COG:COG3203","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"1448139.AI20_05440","38":"3.40e-203","39":"568","40":"COG3203@1|root,COG3203@2|Bacteria,1MVRY@1224|Proteobacteria,1RNBS@1236|Gammaproteobacteria,1Y4TY@135624|Aeromonadales","41":"135624|Aeromonadales","42":"M","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"Porin_1,Porin_4"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"E - Amino acid transport and metabolism","5":"-","6":"Beta-eliminating lyase","7":"L-allo-threonine aldolase","8":"7","9":"H1972_01805","10":"11.052184","11":"6.567460","12":"817","13":"3","14":"1","15":"2.9283450","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1973335","22":"1974351","23":"+","24":"1017","25":"817","26":"646","27":"157","28":"14","29":"200","30":"ltaA","31":"NA","32":"4.1.2.49","33":"NA","34":"NA","35":"NA","36":"E","37":"380703.AHA_1795","38":"2.05e-203","39":"567","40":"COG2008@1|root,COG2008@2|Bacteria,1MWCR@1224|Proteobacteria,1RNYX@1236|Gammaproteobacteria,1Y69E@135624|Aeromonadales","41":"135624|Aeromonadales","42":"E","43":"-","44":"4.1.2.48,4.1.2.49","45":"ko:K01620,ko:K20801","46":"ko00260,ko01100,ko01110,ko01120,ko01130,ko01230,map00260,map01100,map01110,map01120,map01130,map01230","47":"-","48":"R00751,R06171","49":"RC00312,RC00372","50":"ko00000,ko00001,ko01000","51":"-","52":"-","53":"-","54":"Beta_elim_lyase"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"H - Coenzyme transport and metabolism","5":"-","6":"Belongs to the FPP GGPP synthase family","7":"Octaprenyl diphosphate synthase","8":"7","9":"H1972_00816","10":"11.099753","11":"6.567460","12":"804","13":"3","14":"1","15":"2.9756939","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"875821","22":"876792","23":"-","24":"972","25":"804","26":"627","27":"160","28":"17","29":"168","30":"ispB","31":"COG:COG0142","32":"2.5.1.90","33":"NA","34":"NA","35":"NA","36":"H","37":"380703.AHA_0929","38":"1.03e-218","39":"605","40":"COG0142@1|root,COG0142@2|Bacteria,1MUK6@1224|Proteobacteria,1RPR7@1236|Gammaproteobacteria,1Y47Z@135624|Aeromonadales","41":"135624|Aeromonadales","42":"H","43":"-","44":"2.5.1.90","45":"ko:K02523","46":"ko00900,ko01110,map00900,map01110","47":"-","48":"R09248","49":"RC00279","50":"ko00000,ko00001,ko01000,ko01006","51":"-","52":"-","53":"-","54":"polyprenyl_synt"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"D - Cell cycle control, cell division, chromosome partitioning","5":"minD","6":"Belongs to the ParA family","7":"Septum site-determining protein MinD","8":"7","9":"H1972_02204","10":"11.654386","11":"6.567460","12":"667","13":"3","14":"1","15":"3.5868934","16":"0","17":"0","18":"3","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"2411506","22":"2412318","23":"+","24":"813","25":"667","26":"518","27":"130","28":"19","29":"146","30":"minD","31":"COG:COG2894","32":"NA","33":"NA","34":"NA","35":"NA","36":"D","37":"1448139.AI20_07700","38":"4.82e-186","39":"518","40":"COG2894@1|root,COG2894@2|Bacteria,1MUEU@1224|Proteobacteria,1RNJ0@1236|Gammaproteobacteria,1Y45D@135624|Aeromonadales","41":"135624|Aeromonadales","42":"D","43":"-","44":"-","45":"ko:K03609","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03036,ko04812","51":"-","52":"-","53":"-","54":"AAA_31,CbiA"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"metN3","6":"Part of the ABC transporter complex MetNIQ involved in methionine import. Responsible for energy coupling to the transport system","7":"Methionine import ATP-binding protein MetN","8":"7","9":"H1972_03098","10":"11.800527","11":"6.567460","12":"635","13":"3","14":"1","15":"3.7676502","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"3421084","22":"3421878","23":"-","24":"795","25":"635","26":"493","27":"126","28":"16","29":"160","30":"metN_2","31":"COG:COG1135","32":"3.6.3.-","33":"NA","34":"NA","35":"NA","36":"P","37":"561229.Dd1591_2630","38":"1.44e-131","39":"379","40":"COG1135@1|root,COG1135@2|Bacteria,1QTTK@1224|Proteobacteria,1RNR2@1236|Gammaproteobacteria,2JE22@204037|Dickeya","41":"1236|Gammaproteobacteria","42":"P","43":"-","44":"-","45":"ko:K02071","46":"ko02010,map02010","47":"M00238","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.24","52":"-","53":"-","54":"ABC_tran,NIL"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"S - Function unknown","5":"-","6":"Branched-chain amino acid ATP-binding cassette transporter","7":"Lipopolysaccharide export system ATP-binding protein LptB","8":"7","9":"H1972_00362","10":"11.919967","11":"6.567460","12":"610","13":"3","14":"1","15":"3.9220621","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"397243","22":"397968","23":"+","24":"726","25":"610","26":"462","27":"127","28":"21","29":"116","30":"lptB_1","31":"COG:COG1137","32":"3.6.3.-","33":"NA","34":"NA","35":"NA","36":"S","37":"998088.B565_0304","38":"1.09e-163","39":"459","40":"COG1137@1|root,COG1137@2|Bacteria,1MU8M@1224|Proteobacteria,1RPW1@1236|Gammaproteobacteria,1Y3MI@135624|Aeromonadales","41":"135624|Aeromonadales","42":"S","43":"-","44":"-","45":"ko:K06861","46":"ko02010,map02010","47":"M00320","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko01000,ko02000","51":"1.B.42.1","52":"-","53":"-","54":"ABC_tran,BCA_ABC_TP_C"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"S - Function unknown","5":"-","6":"SNARE associated Golgi protein","7":"hypothetical protein","8":"7","9":"H1972_00671","10":"12.658419","11":"6.567460","12":"476","13":"3","14":"2","15":"5.0261720","16":"1","17":"2","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"706952","22":"707533","23":"+","24":"582","25":"476","26":"385","27":"79","28":"12","29":"106","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"S","37":"1448139.AI20_15105","38":"1.03e-126","39":"361","40":"COG1238@1|root,COG1238@2|Bacteria,1MWED@1224|Proteobacteria,1RPT7@1236|Gammaproteobacteria,1Y4GA@135624|Aeromonadales","41":"135624|Aeromonadales","42":"S","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"SNARE_assoc"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"K  Transcription","5":"rpoD","6":"Sigma factors are initiation factors that promote the attachment of RNA polymerase to specific initiation sites and are then released. This sigma factor is the primary sigma factor during exponential growth","7":"RNA polymerase sigma factor RpoD","8":"7","9":"H1972_00678","10":"12.924786","11":"6.567460","12":"1575","13":"4","14":"2","15":"2.0253612","16":"0","17":"1","18":"3","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"713684","22":"715540","23":"+","24":"1857","25":"1575","26":"1230","27":"298","28":"47","29":"282","30":"rpoD","31":"COG:COG0568","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"1448139.AI20_15070","38":"0.00e+00","39":"1100","40":"COG0568@1|root,COG0568@2|Bacteria,1MVNJ@1224|Proteobacteria,1RMQI@1236|Gammaproteobacteria,1Y430@135624|Aeromonadales","41":"135624|Aeromonadales","42":"K","43":"-","44":"-","45":"ko:K03086","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03021","51":"-","52":"-","53":"-","54":"Sigma70_ner,Sigma70_r1_1,Sigma70_r1_2,Sigma70_r2,Sigma70_r3,Sigma70_r4"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"Q - Secondary metabolites biosynthesis, transport and catabolism","5":"acpP","6":"Carrier of the growing fatty acid chain in fatty acid biosynthesis","7":"Acyl carrier protein","8":"7","9":"H1972_02107","10":"15.145124","11":"6.567460","12":"207","13":"3","14":"1","15":"11.5577675","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"2297927","22":"2298163","23":"-","24":"237","25":"207","26":"154","27":"45","28":"8","29":"30","30":"acpP","31":"COG:COG0236","32":"NA","33":"NA","34":"NA","35":"NA","36":"Q","37":"1448139.AI20_08275","38":"3.55e-43","39":"141","40":"COG0236@1|root,COG0236@2|Bacteria,1MZ4P@1224|Proteobacteria,1S8X4@1236|Gammaproteobacteria,1Y4N5@135624|Aeromonadales","41":"135624|Aeromonadales","42":"IQ","43":"-","44":"-","45":"ko:K02078","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko00001","51":"-","52":"-","53":"-","54":"PP-binding"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"F - Nucleotide transport and metabolism","5":"cdd","6":"This enzyme scavenges exogenous and endogenous cytidine and 2'-deoxycytidine for UMP synthesis","7":"Cytidine deaminase","8":"7","9":"H1972_02461","10":"16.039351","11":"6.567460","12":"716","13":"4","14":"2","15":"4.4552288","16":"2","17":"2","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"2705510","22":"2706391","23":"+","24":"882","25":"716","26":"567","27":"141","28":"8","29":"166","30":"cdd","31":"COG:COG0295","32":"3.5.4.5","33":"NA","34":"NA","35":"NA","36":"F","37":"380703.AHA_1894","38":"5.21e-197","39":"547","40":"COG0295@1|root,COG0295@2|Bacteria,1MY2R@1224|Proteobacteria,1RMRX@1236|Gammaproteobacteria,1Y5M3@135624|Aeromonadales","41":"135624|Aeromonadales","42":"F","43":"-","44":"3.5.4.5","45":"ko:K01489","46":"ko00240,ko00983,ko01100,map00240,map00983,map01100","47":"-","48":"R01878,R02485,R08221","49":"RC00074,RC00514","50":"ko00000,ko00001,ko01000","51":"-","52":"-","53":"-","54":"dCMP_cyt_deam_1,dCMP_cyt_deam_2"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"M - Cell wall/membrane/envelope biogenesis","5":"-","6":"Acid phosphatase homologues","7":"hypothetical protein","8":"7","9":"H1972_00299","10":"18.907175","11":"6.567460","12":"1061","13":"5","14":"2","15":"3.7581808","16":"1","17":"4","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"326772","22":"328148","23":"-","24":"1377","25":"1061","26":"846","27":"203","28":"12","29":"316","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"382245.ASA_4045","38":"4.84e-177","39":"510","40":"COG0494@1|root,COG0671@1|root,COG0494@2|Bacteria,COG0671@2|Bacteria,1RK7V@1224|Proteobacteria,1S6KG@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"M","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"NUDIX,PAP2"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"corC","6":"Magnesium and cobalt efflux protein CorC","7":"Magnesium and cobalt efflux protein CorC","8":"7","9":"H1972_03115","10":"20.600607","11":"6.567460","12":"754","13":"5","14":"2","15":"5.2883684","16":"1","17":"4","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"3437872","22":"3438753","23":"+","24":"882","25":"754","26":"576","27":"154","28":"24","29":"128","30":"corC","31":"COG:COG4535","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"998088.B565_0914","38":"9.35e-198","39":"549","40":"COG4535@1|root,COG4535@2|Bacteria,1QTU8@1224|Proteobacteria,1RMKX@1236|Gammaproteobacteria,1Y3VX@135624|Aeromonadales","41":"135624|Aeromonadales","42":"P","43":"-","44":"-","45":"ko:K06189","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"9.A.40.1.2","52":"-","53":"-","54":"CBS,CorC_HlyC"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"K  Transcription","5":"rpoS","6":"RNA polymerase sigma","7":"RNA polymerase sigma factor RpoS","8":"7","9":"H1972_00673","10":"25.092400","11":"6.567460","12":"814","13":"6","14":"2","15":"5.8782749","16":"4","17":"2","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"708660","22":"709643","23":"+","24":"984","25":"814","26":"631","27":"164","28":"19","29":"170","30":"rpoS","31":"COG:COG0568","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"1448139.AI20_15095","38":"7.15e-212","39":"588","40":"COG0568@1|root,COG0568@2|Bacteria,1MUDI@1224|Proteobacteria,1RN8V@1236|Gammaproteobacteria,1Y47D@135624|Aeromonadales","41":"135624|Aeromonadales","42":"K","43":"-","44":"-","45":"ko:K03087","46":"ko02026,ko05111,map02026,map05111","47":"-","48":"-","49":"-","50":"ko00000,ko00001,ko03021","51":"-","52":"-","53":"-","54":"Sigma70_r1_2,Sigma70_r2,Sigma70_r3,Sigma70_r4"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"D - Cell cycle control, cell division, chromosome partitioning","5":"minE","6":"Prevents the cell division inhibition by proteins MinC and MinD at internal division sites while permitting inhibition at polar sites. This ensures cell division at the proper site by restricting the formation of a division septum at the midpoint of the long axis of the cell","7":"Cell division topological specificity factor","8":"7","9":"H1972_02205","10":"36.736801","11":"6.567460","12":"236","13":"9","14":"2","15":"30.4126002","16":"5","17":"0","18":"4","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"2412321","22":"2412590","23":"+","24":"270","25":"236","26":"172","27":"57","28":"7","29":"34","30":"minE","31":"COG:COG0851","32":"NA","33":"NA","34":"NA","35":"NA","36":"D","37":"382245.ASA_2169","38":"3.71e-52","39":"164","40":"COG0851@1|root,COG0851@2|Bacteria,1N6QD@1224|Proteobacteria,1SC8W@1236|Gammaproteobacteria,1Y4N2@135624|Aeromonadales","41":"135624|Aeromonadales","42":"D","43":"-","44":"-","45":"ko:K03608","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03036,ko04812","51":"-","52":"-","53":"-","54":"MinE"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"M - Cell wall/membrane/envelope biogenesis","5":"-","6":"Bacterial sugar transferase","7":"UDP-N-acetylgalactosamine-undecaprenyl-phosphate N-acetylgalactosaminephosphotransferase","8":"8","9":"H1972_01454","10":"8.896895","11":"6.616081","12":"1056","13":"2","14":"2","15":"1.5103901","16":"1","17":"1","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1561429","22":"1562700","23":"+","24":"1272","25":"1056","26":"810","27":"217","28":"29","29":"216","30":"wecA","31":"NA","32":"2.7.8.40","33":"NA","34":"NA","35":"NA","36":"M","37":"1448139.AI20_04960","38":"3.48e-280","39":"768","40":"COG2148@1|root,COG2148@2|Bacteria,1MV6W@1224|Proteobacteria,1RMMN@1236|Gammaproteobacteria,1Y5VG@135624|Aeromonadales","41":"135624|Aeromonadales","42":"M","43":"GO:0000271,GO:0003674,GO:0003824,GO:0005975,GO:0005976,GO:0006629,GO:0008150,GO:0008152,GO:0008610,GO:0008653,GO:0009058,GO:0009059,GO:0009103,GO:0009243,GO:0009987,GO:0016051,GO:0016740,GO:0016772,GO:0016780,GO:0033692,GO:0034637,GO:0034645,GO:0043170,GO:0044237,GO:0044238,GO:0044249,GO:0044255,GO:0044260,GO:0044262,GO:0044264,GO:0046402,GO:0071704,GO:1901135,GO:1901137,GO:1901576,GO:1903509","44":"2.7.8.40,2.7.8.6","45":"ko:K00996,ko:K21303","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko01000,ko01003,ko01005","51":"-","52":"-","53":"-","54":"Bac_transf,CoA_binding_3"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"D - Cell cycle control, cell division, chromosome partitioning","5":"smc","6":"Required for chromosome condensation and partitioning","7":"Chromosome partition protein Smc","8":"8","9":"H1972_01157","10":"11.237560","11":"6.616081","12":"2754","13":"3","14":"1","15":"0.8687211","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1227486","22":"1230860","23":"+","24":"3375","25":"2754","26":"2140","27":"580","28":"34","29":"621","30":"smc","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"D","37":"380703.AHA_1227","38":"0.00e+00","39":"1754","40":"COG1196@1|root,COG1196@2|Bacteria,1MUAQ@1224|Proteobacteria,1RNA6@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"D","43":"-","44":"-","45":"ko:K03529","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03036","51":"-","52":"-","53":"-","54":"SMC_N,SMC_hinge"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"K  Transcription","5":"rpoD","6":"Sigma factors are initiation factors that promote the attachment of RNA polymerase to specific initiation sites and are then released. This sigma factor is the primary sigma factor during exponential growth","7":"RNA polymerase sigma factor RpoD","8":"8","9":"H1972_00678","10":"12.900053","11":"6.616081","12":"1575","13":"3","14":"1","15":"1.5190209","16":"0","17":"0","18":"3","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"713684","22":"715540","23":"+","24":"1857","25":"1575","26":"1230","27":"298","28":"47","29":"282","30":"rpoD","31":"COG:COG0568","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"1448139.AI20_15070","38":"0.00e+00","39":"1100","40":"COG0568@1|root,COG0568@2|Bacteria,1MVNJ@1224|Proteobacteria,1RMQI@1236|Gammaproteobacteria,1Y430@135624|Aeromonadales","41":"135624|Aeromonadales","42":"K","43":"-","44":"-","45":"ko:K03086","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03021","51":"-","52":"-","53":"-","54":"Sigma70_ner,Sigma70_r1_1,Sigma70_r1_2,Sigma70_r2,Sigma70_r3,Sigma70_r4"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"M - Cell wall/membrane/envelope biogenesis","5":"lamB","6":"involved in the transport of maltose and maltodextrins","7":"Maltoporin","8":"8","9":"H1972_01106","10":"13.952335","11":"6.616081","12":"1107","13":"3","14":"1","15":"2.1612086","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1167031","22":"1168353","23":"+","24":"1323","25":"1107","26":"888","27":"206","28":"13","29":"216","30":"lamB_2","31":"COG:COG4580","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"380703.AHA_1166","38":"1.33e-291","39":"813","40":"COG4580@1|root,COG4580@2|Bacteria,1MX77@1224|Proteobacteria,1RPMF@1236|Gammaproteobacteria,1Y5CH@135624|Aeromonadales","41":"135624|Aeromonadales","42":"M","43":"-","44":"-","45":"ko:K02024","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.3.1.1","52":"-","53":"-","54":"LamB"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"P - Inorganic ion transport and metabolism","5":"-","6":"Required for the activity of the bacterial periplasmic transport system of putrescine","7":"Putrescine-binding periplasmic protein SpuD","8":"8","9":"H1972_00159","10":"14.508484","11":"6.616081","12":"919","13":"3","14":"1","15":"2.6033274","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"175629","22":"176726","23":"+","24":"1098","25":"919","26":"720","27":"181","28":"18","29":"179","30":"spuD_1","31":"COG:COG0687","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"998088.B565_0131","38":"6.07e-253","39":"695","40":"COG0687@1|root,COG0687@2|Bacteria,1MUYW@1224|Proteobacteria,1RM7W@1236|Gammaproteobacteria,1Y3J9@135624|Aeromonadales","41":"135624|Aeromonadales","42":"P","43":"-","44":"-","45":"ko:K11073","46":"ko02010,map02010","47":"M00300","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.11.2","52":"-","53":"-","54":"SBP_bac_8"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"M - Cell wall/membrane/envelope biogenesis","5":"-","6":"Belongs to the Gram-negative porin family","7":"Outer membrane porin PhoE","8":"8","9":"H1972_01539","10":"14.655152","11":"6.616081","12":"875","13":"3","14":"1","15":"2.7342376","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"1655306","22":"1656343","23":"+","24":"1038","25":"875","26":"682","27":"176","28":"17","29":"163","30":"phoE_1","31":"COG:COG3203","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"1448139.AI20_05440","38":"3.40e-203","39":"568","40":"COG3203@1|root,COG3203@2|Bacteria,1MVRY@1224|Proteobacteria,1RNBS@1236|Gammaproteobacteria,1Y4TY@135624|Aeromonadales","41":"135624|Aeromonadales","42":"M","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"Porin_1,Porin_4"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"K  Transcription","5":"rpoS","6":"RNA polymerase sigma","7":"RNA polymerase sigma factor RpoS","8":"8","9":"H1972_00673","10":"14.871222","11":"6.616081","12":"814","13":"3","14":"1","15":"2.9391374","16":"0","17":"3","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"708660","22":"709643","23":"+","24":"984","25":"814","26":"631","27":"164","28":"19","29":"170","30":"rpoS","31":"COG:COG0568","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"1448139.AI20_15095","38":"7.15e-212","39":"588","40":"COG0568@1|root,COG0568@2|Bacteria,1MUDI@1224|Proteobacteria,1RN8V@1236|Gammaproteobacteria,1Y47D@135624|Aeromonadales","41":"135624|Aeromonadales","42":"K","43":"-","44":"-","45":"ko:K03087","46":"ko02026,ko05111,map02026,map05111","47":"-","48":"-","49":"-","50":"ko00000,ko00001,ko03021","51":"-","52":"-","53":"-","54":"Sigma70_r1_2,Sigma70_r2,Sigma70_r3,Sigma70_r4"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"D - Cell cycle control, cell division, chromosome partitioning","5":"minD","6":"Belongs to the ParA family","7":"Septum site-determining protein MinD","8":"8","9":"H1972_02204","10":"15.466997","11":"6.616081","12":"667","13":"3","14":"1","15":"3.5868934","16":"0","17":"0","18":"3","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"2411506","22":"2412318","23":"+","24":"813","25":"667","26":"518","27":"130","28":"19","29":"146","30":"minD","31":"COG:COG2894","32":"NA","33":"NA","34":"NA","35":"NA","36":"D","37":"1448139.AI20_07700","38":"4.82e-186","39":"518","40":"COG2894@1|root,COG2894@2|Bacteria,1MUEU@1224|Proteobacteria,1RNJ0@1236|Gammaproteobacteria,1Y45D@135624|Aeromonadales","41":"135624|Aeromonadales","42":"D","43":"-","44":"-","45":"ko:K03609","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko03036,ko04812","51":"-","52":"-","53":"-","54":"AAA_31,CbiA"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"P - Inorganic ion transport and metabolism","5":"metN3","6":"Part of the ABC transporter complex MetNIQ involved in methionine import. Responsible for energy coupling to the transport system","7":"Methionine import ATP-binding protein MetN","8":"8","9":"H1972_03098","10":"15.614115","11":"6.616081","12":"635","13":"3","14":"1","15":"3.7676502","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"3421084","22":"3421878","23":"-","24":"795","25":"635","26":"493","27":"126","28":"16","29":"160","30":"metN_2","31":"COG:COG1135","32":"3.6.3.-","33":"NA","34":"NA","35":"NA","36":"P","37":"561229.Dd1591_2630","38":"1.44e-131","39":"379","40":"COG1135@1|root,COG1135@2|Bacteria,1QTTK@1224|Proteobacteria,1RNR2@1236|Gammaproteobacteria,2JE22@204037|Dickeya","41":"1236|Gammaproteobacteria","42":"P","43":"-","44":"-","45":"ko:K02071","46":"ko02010,map02010","47":"M00238","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.24","52":"-","53":"-","54":"ABC_tran,NIL"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"S - Function unknown","5":"-","6":"Protein of unknown function, DUF","7":"hypothetical protein","8":"8","9":"H1972_02723","10":"17.511222","11":"6.616081","12":"337","13":"3","14":"1","15":"7.0992815","16":"3","17":"0","18":"0","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"3033288","22":"3033689","23":"+","24":"402","25":"337","26":"265","27":"68","28":"4","29":"65","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"S","37":"1448139.AI20_10805","38":"5.74e-80","39":"239","40":"COG3085@1|root,COG3085@2|Bacteria,1RD72@1224|Proteobacteria,1S3NW@1236|Gammaproteobacteria,1Y4MP@135624|Aeromonadales","41":"135624|Aeromonadales","42":"S","43":"-","44":"-","45":"ko:K09897","46":"-","47":"-","48":"-","49":"-","50":"ko00000","51":"-","52":"-","53":"-","54":"DUF413"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"S - Function unknown","5":"-","6":"Protein of unknown function DUF115","7":"hypothetical protein","8":"8","9":"H1972_00421","10":"32.676358","11":"6.616081","12":"819","13":"6","14":"2","15":"5.8423880","16":"0","17":"3","18":"3","19":"HAMBI_1972_chrm01_circ","20":"CDS","21":"447796","22":"448797","23":"+","24":"1002","25":"819","26":"630","27":"180","28":"9","29":"183","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"S","37":"382245.ASA_0374","38":"2.18e-181","39":"528","40":"COG2604@1|root,COG2604@2|Bacteria,1NNJY@1224|Proteobacteria,1SI36@1236|Gammaproteobacteria,1Y61D@135624|Aeromonadales","41":"135624|Aeromonadales","42":"S","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"-"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"I - Lipid transport and metabolism","5":"yciA","6":"Long-chain acyl-CoA thioester hydrolase","7":"putative acyl-CoA thioester hydrolase","8":"10","9":"H1977_05849","10":"9.352479","11":"6.837376","12":"327","13":"2","14":"2","15":"4.9568177","16":"1","17":"1","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"6524501","22":"6524905","23":"+","24":"405","25":"327","26":"270","27":"49","28":"8","29":"78","30":"NA","31":"COG:COG1607","32":"3.1.2.-","33":"NA","34":"NA","35":"NA","36":"I","37":"1124983.PFLCHA0_c60820","38":"4.39e-88","39":"259","40":"COG1607@1|root,COG1607@2|Bacteria,1MZAZ@1224|Proteobacteria,1SA9N@1236|Gammaproteobacteria,1YQAS@136843|Pseudomonas fluorescens group","41":"1236|Gammaproteobacteria","42":"I","43":"GO:0003674,GO:0003824,GO:0005575,GO:0005622,GO:0005623,GO:0005737,GO:0005829,GO:0006082,GO:0006139,GO:0006163,GO:0006629,GO:0006631,GO:0006637,GO:0006725,GO:0006732,GO:0006753,GO:0006790,GO:0006793,GO:0006796,GO:0006807,GO:0008150,GO:0008152,GO:0009117,GO:0009150,GO:0009259,GO:0009987,GO:0016289,GO:0016787,GO:0016788,GO:0016790,GO:0019637,GO:0019693,GO:0019752,GO:0032787,GO:0033865,GO:0033875,GO:0034032,GO:0034641,GO:0035383,GO:0043436,GO:0043603,GO:0044237,GO:0044238,GO:0044255,GO:0044281,GO:0044424,GO:0044444,GO:0044464,GO:0046483,GO:0047617,GO:0051186,GO:0055086,GO:0071704,GO:0072521,GO:1901135,GO:1901360,GO:1901564","44":"-","45":"ko:K10806","46":"ko01040,map01040","47":"-","48":"-","49":"-","50":"ko00000,ko00001,ko01000,ko01004","51":"-","52":"-","53":"-","54":"4HBT"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"E - Amino acid transport and metabolism","5":"-","6":"ABC-type oligopeptide transport system, periplasmic component","7":"hypothetical protein","8":"10","9":"H1977_02612","10":"10.217707","11":"6.837376","12":"1513","13":"3","14":"2","15":"1.6069525","16":"2","17":"1","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"2895386","22":"2897215","23":"-","24":"1830","25":"1513","26":"1168","27":"322","28":"23","29":"317","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"E","37":"587753.EY04_12980","38":"0.00e+00","39":"1239","40":"COG4166@1|root,COG4166@2|Bacteria,1MUVU@1224|Proteobacteria,1S1X3@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"E","43":"-","44":"-","45":"ko:K13893","46":"ko02010,map02010","47":"M00349","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.5.21,3.A.1.5.24","52":"-","53":"-","54":"SBP_bac_5"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"pstA","6":"phosphate transport system permease","7":"hypothetical protein","8":"10","9":"H1977_05845","10":"10.554745","11":"6.837376","12":"1350","13":"3","14":"1","15":"1.8009771","16":"0","17":"3","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"6517423","22":"6519093","23":"-","24":"1671","25":"1350","26":"1076","27":"243","28":"31","29":"321","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"587753.EY04_30040","38":"0.00e+00","39":"1081","40":"COG0581@1|root,COG0581@2|Bacteria,1MUWB@1224|Proteobacteria,1RPV9@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"P","43":"-","44":"-","45":"ko:K02038","46":"ko02010,map02010","47":"M00222","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.7","52":"-","53":"-","54":"BPD_transp_1"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"H - Coenzyme transport and metabolism","5":"pdxA","6":"Catalyzes the NAD(P)-dependent oxidation of 4- (phosphohydroxy)-L-threonine (HTP) into 2-amino-3-oxo-4- (phosphohydroxy)butyric acid which spontaneously decarboxylates to form 3-amino-2-oxopropyl phosphate (AHAP)","7":"4-hydroxythreonine-4-phosphate dehydrogenase","8":"10","9":"H1977_05366","10":"12.126493","11":"6.837376","12":"795","13":"3","14":"1","15":"3.0582630","16":"0","17":"3","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"5992566","22":"5993555","23":"+","24":"990","25":"795","26":"624","27":"153","28":"18","29":"195","30":"pdxA","31":"COG:COG1995","32":"1.1.1.262","33":"NA","34":"NA","35":"NA","36":"H","37":"587753.EY04_32350","38":"1.70e-236","39":"650","40":"COG1995@1|root,COG1995@2|Bacteria,1MX5W@1224|Proteobacteria,1RNZV@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"H","43":"GO:0000166,GO:0000287,GO:0003674,GO:0003824,GO:0005488,GO:0005515,GO:0006081,GO:0006725,GO:0006732,GO:0006766,GO:0006767,GO:0006793,GO:0006796,GO:0006807,GO:0008150,GO:0008152,GO:0008270,GO:0008614,GO:0008615,GO:0009058,GO:0009108,GO:0009110,GO:0009987,GO:0016491,GO:0016614,GO:0016616,GO:0017144,GO:0018130,GO:0019438,GO:0019637,GO:0034641,GO:0036094,GO:0042364,GO:0042802,GO:0042816,GO:0042819,GO:0042822,GO:0042823,GO:0043167,GO:0043169,GO:0044237,GO:0044249,GO:0044271,GO:0044281,GO:0044283,GO:0046184,GO:0046483,GO:0046872,GO:0046914,GO:0048037,GO:0050570,GO:0050662,GO:0051186,GO:0051188,GO:0051287,GO:0055114,GO:0071704,GO:0072524,GO:0072525,GO:0090407,GO:0097159,GO:1901265,GO:1901360,GO:1901362,GO:1901363,GO:1901564,GO:1901566,GO:1901576,GO:1901615,GO:1901617","44":"1.1.1.262","45":"ko:K00097","46":"ko00750,ko01100,map00750,map01100","47":"M00124","48":"R05681,R05837,R07406","49":"RC00089,RC00675,RC01475","50":"ko00000,ko00001,ko00002,ko01000","51":"-","52":"-","53":"iECO111_1330.ECO111_0056","54":"PdxA"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"E - Amino acid transport and metabolism","5":"argE","6":"Belongs to the peptidase M20A family. ArgE subfamily","7":"Acetylornithine deacetylase","8":"10","9":"H1977_05641","10":"16.181630","11":"6.837376","12":"965","13":"4","14":"2","15":"3.3593355","16":"2","17":"2","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"6297803","22":"6298987","23":"-","24":"1185","25":"965","26":"756","27":"192","28":"17","29":"220","30":"argE_3","31":"COG:COG0624","32":"3.5.1.16","33":"NA","34":"NA","35":"NA","36":"E","37":"587753.EY04_30965","38":"8.24e-283","39":"772","40":"COG0624@1|root,COG0624@2|Bacteria,1MVBR@1224|Proteobacteria,1RNDG@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"E","43":"GO:0003674,GO:0003824,GO:0005488,GO:0006082,GO:0006520,GO:0006525,GO:0006526,GO:0006807,GO:0008150,GO:0008152,GO:0008270,GO:0008652,GO:0008777,GO:0009058,GO:0009064,GO:0009084,GO:0009987,GO:0016053,GO:0016787,GO:0016810,GO:0016811,GO:0019213,GO:0019752,GO:0043167,GO:0043169,GO:0043436,GO:0044237,GO:0044238,GO:0044249,GO:0044281,GO:0044283,GO:0046394,GO:0046872,GO:0046914,GO:0050897,GO:0071704,GO:1901564,GO:1901566,GO:1901576,GO:1901605,GO:1901607","44":"3.5.1.16","45":"ko:K01438","46":"ko00220,ko01100,ko01110,ko01130,ko01210,ko01230,map00220,map01100,map01110,map01130,map01210,map01230","47":"M00028,M00845","48":"R00669,R09107","49":"RC00064,RC00300","50":"ko00000,ko00001,ko00002,ko01000","51":"-","52":"-","53":"iECUMN_1333.ECUMN_4488","54":"M20_dimer,Peptidase_M20,Peptidase_M28"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"K  Transcription","5":"nfxB","6":"Transcriptional regulator","7":"hypothetical protein","8":"10","9":"H1977_02929","10":"19.085825","11":"6.837376","12":"465","13":"4","14":"2","15":"6.9715242","16":"2","17":"2","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"3271922","22":"3272482","23":"-","24":"561","25":"465","26":"363","27":"94","28":"8","29":"96","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"K","37":"160488.PP_2820","38":"1.70e-110","39":"320","40":"COG1309@1|root,COG1309@2|Bacteria,1RM3U@1224|Proteobacteria,1SEUK@1236|Gammaproteobacteria,1YVGW@136845|Pseudomonas putida group","41":"1236|Gammaproteobacteria","42":"K","43":"-","44":"-","45":"ko:K18294","46":"-","47":"M00639","48":"-","49":"-","50":"ko00000,ko00002,ko01504,ko03000","51":"-","52":"-","53":"-","54":"HTH_IclR,TetR_N"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"M - Cell wall/membrane/envelope biogenesis","5":"yfiB","6":"Belongs to the ompA family","7":"Peptidoglycan-associated lipoprotein","8":"10","9":"H1977_00727","10":"42.111676","11":"6.837376","12":"407","13":"7","14":"3","15":"13.9387661","16":"3","17":"3","18":"1","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"841378","22":"841881","23":"+","24":"504","25":"407","26":"314","27":"86","28":"7","29":"97","30":"pal_1","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"M","37":"587753.EY04_03100","38":"2.24e-106","39":"308","40":"COG2885@1|root,COG2885@2|Bacteria,1RJ05@1224|Proteobacteria,1S695@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"M","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"OmpA"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"M - Cell wall/membrane/envelope biogenesis","5":"lpxC","6":"Catalyzes the hydrolysis of UDP-3-O-myristoyl-N- acetylglucosamine to form UDP-3-O-myristoylglucosamine and acetate, the committed step in lipid A biosynthesis","7":"UDP-3-O-acyl-N-acetylglucosamine deacetylase","8":"10","9":"H1977_04823","10":"42.111676","11":"6.837376","12":"755","13":"20","14":"3","15":"21.4686010","16":"6","17":"6","18":"8","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"5437988","22":"5438899","23":"-","24":"912","25":"755","26":"598","27":"139","28":"18","29":"157","30":"lpxC","31":"COG:COG0774","32":"3.5.1.108","33":"NA","34":"NA","35":"NA","36":"M","37":"587753.EY04_25625","38":"7.87e-213","39":"588","40":"COG0774@1|root,COG0774@2|Bacteria,1MV6T@1224|Proteobacteria,1RQ72@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"M","43":"GO:0003674,GO:0003824,GO:0005488,GO:0005506,GO:0005575,GO:0005622,GO:0005623,GO:0005737,GO:0005975,GO:0006629,GO:0006643,GO:0006644,GO:0006664,GO:0006793,GO:0006796,GO:0008150,GO:0008152,GO:0008270,GO:0008610,GO:0008654,GO:0008759,GO:0009058,GO:0009245,GO:0009247,GO:0009311,GO:0009312,GO:0009987,GO:0016051,GO:0016787,GO:0016810,GO:0016811,GO:0019213,GO:0019637,GO:0043167,GO:0043169,GO:0044237,GO:0044238,GO:0044249,GO:0044255,GO:0044424,GO:0044464,GO:0046467,GO:0046493,GO:0046872,GO:0046914,GO:0071704,GO:0090407,GO:1901135,GO:1901137,GO:1901269,GO:1901271,GO:1901576,GO:1903509","44":"3.5.1.108","45":"ko:K02535","46":"ko00540,ko01100,map00540,map01100","47":"M00060","48":"R04587","49":"RC00166,RC00300","50":"ko00000,ko00001,ko00002,ko01000,ko01005","51":"-","52":"-","53":"iECS88_1305.ECS88_0100","54":"LpxC"},{"1":"HAMBI_1977","2":"evo","3":"evo","4":"T - Signal transduction mechanisms","5":"cbrA","6":"COG0591 Na proline symporter","7":"Adaptive-response sensory-kinase SasA","8":"11","9":"H1977_05026","10":"14.384783","11":"10.527078","12":"2399","13":"3","14":"2","15":"1.0134719","16":"0","17":"2","18":"1","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"5642090","22":"5645044","23":"+","24":"2955","25":"2399","26":"1875","27":"461","28":"63","29":"556","30":"sasA_19","31":"NA","32":"2.7.-.-","33":"NA","34":"NA","35":"NA","36":"T","37":"587753.EY04_26720","38":"0.00e+00","39":"1895","40":"COG0591@1|root,COG4191@1|root,COG0591@2|Bacteria,COG4191@2|Bacteria,1QTSW@1224|Proteobacteria,1T1G2@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"T","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"HATPase_c,HisKA,PAS"},{"1":"HAMBI_1977","2":"evo","3":"evo","4":"P - Inorganic ion transport and metabolism","5":"pstA","6":"phosphate transport system permease","7":"hypothetical protein","8":"11","9":"H1977_05845","10":"16.104681","11":"10.527078","12":"1350","13":"3","14":"1","15":"1.8009771","16":"0","17":"3","18":"0","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"6517423","22":"6519093","23":"-","24":"1671","25":"1350","26":"1076","27":"243","28":"31","29":"321","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"587753.EY04_30040","38":"0.00e+00","39":"1081","40":"COG0581@1|root,COG0581@2|Bacteria,1MUWB@1224|Proteobacteria,1RPV9@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"P","43":"-","44":"-","45":"ko:K02038","46":"ko02010,map02010","47":"M00222","48":"-","49":"-","50":"ko00000,ko00001,ko00002,ko02000","51":"3.A.1.7","52":"-","53":"-","54":"BPD_transp_1"},{"1":"HAMBI_1977","2":"evo","3":"evo","4":"M - Cell wall/membrane/envelope biogenesis","5":"lpxC","6":"Catalyzes the hydrolysis of UDP-3-O-myristoyl-N- acetylglucosamine to form UDP-3-O-myristoylglucosamine and acetate, the committed step in lipid A biosynthesis","7":"UDP-3-O-acyl-N-acetylglucosamine deacetylase","8":"11","9":"H1977_04823","10":"39.130531","11":"10.527078","12":"755","13":"10","14":"3","15":"10.7343005","16":"2","17":"4","18":"4","19":"HAMBI_1977_chrm01_circ","20":"CDS","21":"5437988","22":"5438899","23":"-","24":"912","25":"755","26":"598","27":"139","28":"18","29":"157","30":"lpxC","31":"COG:COG0774","32":"3.5.1.108","33":"NA","34":"NA","35":"NA","36":"M","37":"587753.EY04_25625","38":"7.87e-213","39":"588","40":"COG0774@1|root,COG0774@2|Bacteria,1MV6T@1224|Proteobacteria,1RQ72@1236|Gammaproteobacteria","41":"1236|Gammaproteobacteria","42":"M","43":"GO:0003674,GO:0003824,GO:0005488,GO:0005506,GO:0005575,GO:0005622,GO:0005623,GO:0005737,GO:0005975,GO:0006629,GO:0006643,GO:0006644,GO:0006664,GO:0006793,GO:0006796,GO:0008150,GO:0008152,GO:0008270,GO:0008610,GO:0008654,GO:0008759,GO:0009058,GO:0009245,GO:0009247,GO:0009311,GO:0009312,GO:0009987,GO:0016051,GO:0016787,GO:0016810,GO:0016811,GO:0019213,GO:0019637,GO:0043167,GO:0043169,GO:0044237,GO:0044238,GO:0044249,GO:0044255,GO:0044424,GO:0044464,GO:0046467,GO:0046493,GO:0046872,GO:0046914,GO:0071704,GO:0090407,GO:1901135,GO:1901137,GO:1901269,GO:1901271,GO:1901576,GO:1903509","44":"3.5.1.108","45":"ko:K02535","46":"ko00540,ko01100,map00540,map01100","47":"M00060","48":"R04587","49":"RC00166,RC00300","50":"ko00000,ko00001,ko00002,ko01000,ko01005","51":"-","52":"-","53":"iECS88_1305.ECS88_0100","54":"LpxC"},{"1":"HAMBI_2659","2":"evo","3":"anc","4":"T - Signal transduction mechanisms","5":"-","6":"PAS fold","7":"Sensor histidine kinase RcsC","8":"14","9":"H2659_03908","10":"6.526004","11":"6.465463","12":"2107","13":"2","14":"2","15":"0.7394162","16":"1","17":"1","18":"0","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"4153318","22":"4155960","23":"+","24":"2643","25":"2107","26":"1669","27":"413","28":"25","29":"536","30":"rcsC_14","31":"NA","32":"2.7.13.3","33":"NA","34":"NA","35":"NA","36":"T","37":"522373.Smlt3944","38":"0.00e+00","39":"1708","40":"COG0784@1|root,COG4191@1|root,COG4251@1|root,COG0784@2|Bacteria,COG4191@2|Bacteria,COG4251@2|Bacteria,1QTVB@1224|Proteobacteria,1T1K3@1236|Gammaproteobacteria,1XD9Y@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"T","43":"-","44":"2.7.13.3","45":"ko:K10819","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko01000","51":"-","52":"-","53":"-","54":"HATPase_c,HisKA,PAS_7,Response_reg,dCache_1"},{"1":"HAMBI_2659","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"-","6":"Outer membrane protein beta-barrel family","7":"Vitamin B12 transporter BtuB","8":"14","9":"H2659_03917","10":"6.753190","11":"6.465463","12":"1877","13":"2","14":"2","15":"0.8300213","16":"0","17":"1","18":"1","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"4164763","22":"4167060","23":"+","24":"2298","25":"1877","26":"1493","27":"352","28":"32","29":"421","30":"btuB_32","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"522373.Smlt3954","38":"0.00e+00","39":"1484","40":"COG4774@1|root,COG4774@2|Bacteria,1QU2Y@1224|Proteobacteria,1T1NS@1236|Gammaproteobacteria,1XCSC@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"P","43":"-","44":"-","45":"ko:K02014","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.14","52":"-","53":"-","54":"Plug,TonB_dep_Rec"},{"1":"HAMBI_2659","2":"evo","3":"anc","4":"P - Inorganic ion transport and metabolism","5":"-","6":"receptor","7":"Vitamin B12 transporter BtuB","8":"14","9":"H2659_03614","10":"18.708184","11":"6.465463","12":"2386","13":"5","14":"2","15":"1.6323869","16":"0","17":"2","18":"3","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"3809259","22":"3812216","23":"-","24":"2958","25":"2386","26":"1931","27":"415","28":"40","29":"572","30":"btuB_26","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"522373.Smlt3645","38":"0.00e+00","39":"1940","40":"COG1629@1|root,COG1629@2|Bacteria,COG4771@2|Bacteria,1MU9K@1224|Proteobacteria,1RMTG@1236|Gammaproteobacteria,1X3YY@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"P","43":"-","44":"-","45":"ko:K02014","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.14","52":"-","53":"-","54":"Plug,TonB_dep_Rec"},{"1":"HAMBI_2659","2":"evo","3":"anc","4":"U - Intracellular trafficking, secretion, and vesicular transport","5":"-","6":"Fimbrial protein","7":"Major fimbrial subunit SMF-1","8":"14","9":"H2659_00656","10":"41.734035","11":"6.465463","12":"430","13":"7","14":"2","15":"12.6809886","16":"0","17":"4","18":"3","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"701730","22":"702269","23":"+","24":"540","25":"430","26":"349","27":"72","28":"9","29":"110","30":"smf-1","31":"COG:COG3539","32":"NA","33":"NA","34":"NA","35":"NA","36":"U","37":"391008.Smal_0561","38":"1.38e-115","39":"332","40":"COG3539@1|root,COG3539@2|Bacteria,1RCBG@1224|Proteobacteria,1S38Y@1236|Gammaproteobacteria,1X6ZG@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"NU","43":"-","44":"-","45":"ko:K07345","46":"ko05133,map05133","47":"-","48":"-","49":"-","50":"ko00000,ko00001,ko02035,ko02044","51":"-","52":"-","53":"-","54":"FimA"},{"1":"HAMBI_2659","2":"evo","3":"evo","4":"P - Inorganic ion transport and metabolism","5":"-","6":"Outer membrane protein beta-barrel family","7":"Vitamin B12 transporter BtuB","8":"15","9":"H2659_03917","10":"8.422027","11":"8.192568","12":"1877","13":"2","14":"2","15":"0.8300213","16":"1","17":"0","18":"1","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"4164763","22":"4167060","23":"+","24":"2298","25":"1877","26":"1493","27":"352","28":"32","29":"421","30":"btuB_32","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"522373.Smlt3954","38":"0.00e+00","39":"1484","40":"COG4774@1|root,COG4774@2|Bacteria,1QU2Y@1224|Proteobacteria,1T1NS@1236|Gammaproteobacteria,1XCSC@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"P","43":"-","44":"-","45":"ko:K02014","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.14","52":"-","53":"-","54":"Plug,TonB_dep_Rec"},{"1":"HAMBI_2659","2":"evo","3":"evo","4":"U - Intracellular trafficking, secretion, and vesicular transport","5":"yapH","6":"Autotransporter beta-domain","7":"hypothetical protein","8":"15","9":"H2659_01014","10":"8.968478","11":"8.192568","12":"8316","13":"3","14":"1","15":"0.2810155","16":"3","17":"0","18":"0","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"1061283","22":"1072187","23":"+","24":"10905","25":"8316","26":"6912","27":"1279","28":"125","29":"2589","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"U","37":"522373.Smlt1009","38":"0.00e+00","39":"2989","40":"COG3210@1|root,COG4625@1|root,COG3210@2|Bacteria,COG4625@2|Bacteria,1MU92@1224|Proteobacteria,1T1MJ@1236|Gammaproteobacteria,1X4X8@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"U","43":"-","44":"-","45":"-","46":"-","47":"-","48":"-","49":"-","50":"-","51":"-","52":"-","53":"-","54":"ESPR,PATR"},{"1":"HAMBI_2659","2":"evo","3":"evo","4":"NA","5":"NA","6":"NA","7":"hypothetical protein","8":"15","9":"H2659_01789","10":"20.143575","11":"8.192568","12":"196","13":"3","14":"1","15":"11.9230870","16":"0","17":"0","18":"3","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"1859335","22":"1859571","23":"+","24":"237","25":"196","26":"153","27":"40","28":"3","29":"41","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA"},{"1":"HAMBI_2659","2":"evo","3":"evo","4":"P - Inorganic ion transport and metabolism","5":"-","6":"receptor","7":"Vitamin B12 transporter BtuB","8":"15","9":"H2659_03614","10":"33.846429","11":"8.192568","12":"2386","13":"7","14":"3","15":"2.2853416","16":"1","17":"3","18":"3","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"3809259","22":"3812216","23":"-","24":"2958","25":"2386","26":"1931","27":"415","28":"40","29":"572","30":"btuB_26","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"P","37":"522373.Smlt3645","38":"0.00e+00","39":"1940","40":"COG1629@1|root,COG1629@2|Bacteria,COG4771@2|Bacteria,1MU9K@1224|Proteobacteria,1RMTG@1236|Gammaproteobacteria,1X3YY@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"P","43":"-","44":"-","45":"ko:K02014","46":"-","47":"-","48":"-","49":"-","50":"ko00000,ko02000","51":"1.B.14","52":"-","53":"-","54":"Plug,TonB_dep_Rec"},{"1":"HAMBI_2659","2":"evo","3":"evo","4":"U - Intracellular trafficking, secretion, and vesicular transport","5":"-","6":"Fimbrial protein","7":"Major fimbrial subunit SMF-1","8":"15","9":"H2659_00656","10":"56.872280","11":"8.192568","12":"430","13":"12","14":"3","15":"21.7388377","16":"1","17":"6","18":"5","19":"HAMBI_2659_chrm01_circ","20":"CDS","21":"701730","22":"702269","23":"+","24":"540","25":"430","26":"349","27":"72","28":"9","29":"110","30":"smf-1","31":"COG:COG3539","32":"NA","33":"NA","34":"NA","35":"NA","36":"U","37":"391008.Smal_0561","38":"1.38e-115","39":"332","40":"COG3539@1|root,COG3539@2|Bacteria,1RCBG@1224|Proteobacteria,1S38Y@1236|Gammaproteobacteria,1X6ZG@135614|Xanthomonadales","41":"135614|Xanthomonadales","42":"NU","43":"-","44":"-","45":"ko:K07345","46":"ko05133,map05133","47":"-","48":"-","49":"-","50":"ko00000,ko00001,ko02035,ko02044","51":"-","52":"-","53":"-","54":"FimA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Calculate the probability of each gene (ns_sites/total_ns_sites) and link to COG categories</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>eggnog_nslen <span class="ot">&lt;-</span> <span class="fu">left_join</span>(eggnog, degentab,</span>
<span id="cb24-2"><a href="#cb24-2"></a>                          <span class="at">by =</span> <span class="fu">join_by</span>(strainID, locus_tag)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(strainID, locus_tag, COG_category_single, ns_length) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> ns_length<span class="sc">/</span><span class="fu">sum</span>(ns_length), </span>
<span id="cb24-7"><a href="#cb24-7"></a>         <span class="at">cog_genes =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="jensen-shannon-divergence" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="jensen-shannon-divergence"><span class="header-section-number">5.2.1</span> Jensen Shannon Divergence</h3>
<p>This function draws n genes from each species with a probability proportional to gene length, where n = the number of significant parallel genes observed from the data. We repeat this simulation 10 000 times and below we check if 1) the Jensen Shannon divergence between the distribution of the COG categories drawn randomly and the background (i.e., the distribution of COG categories in the whole genome) is greater than the Jensen Shannon divergence between the background and the observed distribution of COG categories in significantly parallel genes. The idea is that if some COG categories are enriched/depleted in the parallel genes, then the JSD divergence between the observed and the background should be larger than the JSD between the random sampled genes (sampling probability based only on gene length) and the background. We calculate an empirical P value by counting how many times the simulated JSD exceeds the observed.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>gene_nest <span class="ot">&lt;-</span> output_gene_table_filt <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="fu">summarize</span>(<span class="at">nsiggenes =</span> <span class="fu">n</span>(), <span class="at">.by =</span> <span class="fu">c</span>(strainID, prey_history, predator_history)) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>    <span class="fu">left_join</span>(eggnog_nslen,</span>
<span id="cb25-4"><a href="#cb25-4"></a>              <span class="at">by =</span> <span class="fu">join_by</span>(strainID),</span>
<span id="cb25-5"><a href="#cb25-5"></a>              <span class="at">relationship =</span> <span class="st">"many-to-many"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>    <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span><span class="fu">c</span>(strainID, prey_history, predator_history))</span>
<span id="cb25-7"><a href="#cb25-7"></a></span>
<span id="cb25-8"><a href="#cb25-8"></a>gene_draw <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb25-9"><a href="#cb25-9"></a>  gene_nest <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>    <span class="fu">mutate</span>(<span class="at">locus_tag =</span> <span class="fu">map</span>(</span>
<span id="cb25-11"><a href="#cb25-11"></a>      data,</span>
<span id="cb25-12"><a href="#cb25-12"></a>      \(x) <span class="fu">sample</span>(</span>
<span id="cb25-13"><a href="#cb25-13"></a>        <span class="at">x =</span> x<span class="sc">$</span>locus_tag,</span>
<span id="cb25-14"><a href="#cb25-14"></a>        <span class="at">size =</span> <span class="fu">unique</span>(x<span class="sc">$</span>nsiggenes),</span>
<span id="cb25-15"><a href="#cb25-15"></a>        <span class="at">prob =</span> x<span class="sc">$</span>p,</span>
<span id="cb25-16"><a href="#cb25-16"></a>        <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb25-17"><a href="#cb25-17"></a>      )</span>
<span id="cb25-18"><a href="#cb25-18"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>data) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> locus_tag) </span>
<span id="cb25-21"><a href="#cb25-21"></a>}</span>
<span id="cb25-22"><a href="#cb25-22"></a></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="co"># take 10 000 random draws of the genes. Use a seed for reproducibility</span></span>
<span id="cb25-24"><a href="#cb25-24"></a>withr<span class="sc">::</span><span class="fu">with_seed</span>(<span class="dv">12367</span>,</span>
<span id="cb25-25"><a href="#cb25-25"></a>                 genes_simulated <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="sc">~</span><span class="fu">gene_draw</span>(), <span class="at">.progress=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-26"><a href="#cb25-26"></a>                   <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"id"</span>))</span>
<span id="cb25-27"><a href="#cb25-27"></a></span>
<span id="cb25-28"><a href="#cb25-28"></a><span class="co"># save the output so we don't need to run again</span></span>
<span id="cb25-29"><a href="#cb25-29"></a><span class="fu">write_rds</span>(genes_simulated, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"genes_simulated_nomobile.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Some data formatting</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># read data back</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>genes_simulated <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"genes_simulated_nomobile.rds"</span>))</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># map the locus_tags to COG categories for the simulated</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># gene draws</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>COGs_distribution_simulated <span class="ot">&lt;-</span> genes_simulated <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">left_join</span>(eggnog_nslen, <span class="at">by =</span> <span class="fu">join_by</span>(strainID, locus_tag)) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">group_by</span>(id, strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"nsim"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-11"><a href="#cb26-11"></a></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co"># get the discrete distribution of COGs in the significant parallel genes</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>COGs_distribution_observed <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb26-14"><a href="#cb26-14"></a>                                        <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"nobs"</span>) </span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co"># get the discrete distribution of COGs across the whole genome of all species</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co"># this is the null case (i.e. the background that we would expect if there was no</span></span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co"># enrichment)</span></span>
<span id="cb26-21"><a href="#cb26-21"></a>COGs_distribution_nullexpectation <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb26-22"><a href="#cb26-22"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb26-23"><a href="#cb26-23"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"nnull"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we calculate the Jensen Shannon divergence between the background and the simulated data to estimate an empirical P value</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># function to calculate the Jensen Shannon divergene of a pair of</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># distributions</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>JSD_pair <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q){</span>
<span id="cb27-4"><a href="#cb27-4"></a>  m <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> (p <span class="sc">+</span> q)</span>
<span id="cb27-5"><a href="#cb27-5"></a>  JS <span class="ot">&lt;-</span>  <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p<span class="sc">/</span>m)) <span class="sc">+</span> <span class="fu">sum</span>(q <span class="sc">*</span> <span class="fu">log</span>(q<span class="sc">/</span>m)))</span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="fu">return</span>(JS)</span>
<span id="cb27-7"><a href="#cb27-7"></a>}</span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co"># Calculate the Jensen Shannon divergence between the COG distribution observed in </span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co"># enriched genes and the COG distribution in the genomic background</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>JSD_observed <span class="ot">&lt;-</span> <span class="fu">left_join</span>(COGs_distribution_observed, COGs_distribution_nullexpectation,</span>
<span id="cb27-12"><a href="#cb27-12"></a>                          <span class="at">by =</span> <span class="fu">join_by</span>(COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="fu">group_by</span>(prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> nobs<span class="sc">/</span><span class="fu">sum</span>(nobs), </span>
<span id="cb27-15"><a href="#cb27-15"></a>         <span class="at">q =</span> nnull<span class="sc">/</span><span class="fu">sum</span>(nnull)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="fu">summarize</span>(<span class="at">JSD =</span> <span class="fu">JSD_pair</span>(p, q))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(COGs_distribution_observed, COGs_distribution_nullexpectation, : Detected an unexpected many-to-many relationship between `x` and `y`.
 Row 1 of `x` matches multiple rows in `y`.
 Row 11 of `y` matches multiple rows in `x`.
 If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'prey_history'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># now calculate JSD between the simulated draws and the backgound distribution</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>JSD_simulated <span class="ot">&lt;-</span> <span class="fu">left_join</span>(COGs_distribution_simulated, </span>
<span id="cb30-3"><a href="#cb30-3"></a>                           COGs_distribution_nullexpectation,</span>
<span id="cb30-4"><a href="#cb30-4"></a>                           <span class="at">by =</span> <span class="fu">join_by</span>(strainID, COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="co"># drops from calculation categories that aren't in both the observed data</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>  <span class="co"># and the resampled data. Need to do this because JSD can't handle zero values</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="fu">group_by</span>(id, strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> nsim<span class="sc">/</span><span class="fu">sum</span>(nsim), </span>
<span id="cb30-10"><a href="#cb30-10"></a>         <span class="at">q =</span> nnull<span class="sc">/</span><span class="fu">sum</span>(nnull)) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>  <span class="fu">summarize</span>(<span class="at">JSD =</span> <span class="fu">JSD_pair</span>(p, q))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'id', 'strainID', 'prey_history'. You can
override using the `.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># proportion of JSD measures between simulated and the background that are greater</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co"># than the JSD between the observed and the background</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>global_p <span class="ot">&lt;-</span> <span class="fu">left_join</span>(JSD_simulated, JSD_observed, <span class="at">by =</span> <span class="fu">join_by</span>(prey_history, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">mutate</span>(<span class="at">ngt =</span> JSD.x <span class="sc">&gt;=</span> JSD.y) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">summarize</span>(<span class="at">p =</span> <span class="fu">sum</span>(ngt)<span class="sc">/</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'strainID', 'prey_history'. You can
override using the `.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>global_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["strainID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prey_history"],"name":[2],"type":["chr"],"align":["left"]},{"label":["predator_history"],"name":[3],"type":["chr"],"align":["left"]},{"label":["p"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"HAMBI_1287","2":"evo","3":"anc","4":"0.2493"},{"1":"HAMBI_1287","2":"evo","3":"evo","4":"0.0819"},{"1":"HAMBI_1972","2":"anc","3":"anc","4":"0.0000"},{"1":"HAMBI_1972","2":"anc","3":"evo","4":"0.2471"},{"1":"HAMBI_1972","2":"evo","3":"anc","4":"0.1834"},{"1":"HAMBI_1972","2":"evo","3":"evo","4":"0.0900"},{"1":"HAMBI_1977","2":"evo","3":"anc","4":"0.3242"},{"1":"HAMBI_1977","2":"evo","3":"evo","4":"0.0977"},{"1":"HAMBI_2659","2":"evo","3":"anc","4":"0.3382"},{"1":"HAMBI_2659","2":"evo","3":"evo","4":"0.2296"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The overall distribution of COG categories in the parallel genes for each genome in each treatment combination is not significantly different than in the rest of the genome in 9/10 cases. However, for HAMBI_1972 there does seem to be a difference in the distribution of COG categories in enriched genes relative to the genome background.</p>
</section>
<section id="enrichment-of-individual-cog-categories-1" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="enrichment-of-individual-cog-categories-1"><span class="header-section-number">5.2.2</span> Enrichment of individual COG categories</h3>
<p>OK so the overall distribution of COG categories in the parallel genes is not significantly different than in the rest of the genome - ~40% of the time the JSD between the COG distribution in a random sample and the background is greater than the observed COG distribution and the background.</p>
<section id="hypergeometric-test" class="level4" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="hypergeometric-test"><span class="header-section-number">5.2.2.1</span> Hypergeometric Test</h4>
<p>We can test enrichment in individual COG categories in individual species using the hypergeometric test. We will correct for multiple testings by controlling the False Discovery Rate (FDR) using q-values<span class="citation" data-cites="storey2003a">(<a href="#ref-storey2003a" role="doc-biblioref">Storey and Tibshirani 2003</a>)</span> and choosing a maximum FDR threshold of 5%.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(qvalue)</span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a>par2test <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb35-4"><a href="#cb35-4"></a>                      <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"n_cog_par"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">mutate</span>(<span class="at">n_par =</span> <span class="fu">sum</span>(n_cog_par))</span>
<span id="cb35-9"><a href="#cb35-9"></a></span>
<span id="cb35-10"><a href="#cb35-10"></a>back2test <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-12"><a href="#cb35-12"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="#cb35-13"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"n_cog_background"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-14"><a href="#cb35-14"></a>  <span class="fu">mutate</span>(<span class="at">n_background =</span> <span class="fu">sum</span>(n_cog_background))</span>
<span id="cb35-15"><a href="#cb35-15"></a></span>
<span id="cb35-16"><a href="#cb35-16"></a>phypres <span class="ot">&lt;-</span> <span class="fu">left_join</span>(par2test, back2test, <span class="at">by =</span> <span class="fu">join_by</span>(strainID, COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-17"><a href="#cb35-17"></a>  <span class="fu">mutate</span>(<span class="at">p_enrich =</span> <span class="fu">enricher</span>(n_background, n_par, n_cog_background, n_cog_par, <span class="at">over=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-18"><a href="#cb35-18"></a>         <span class="at">p_deplete =</span> <span class="fu">enricher</span>(n_background, n_par, n_cog_background, n_cog_par, <span class="at">over=</span><span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-19"><a href="#cb35-19"></a>  <span class="fu">mutate</span>(<span class="at">p_enrich_adj =</span> <span class="fu">p.adjust</span>(p_enrich, <span class="at">method =</span> <span class="st">"fdr"</span>),</span>
<span id="cb35-20"><a href="#cb35-20"></a>         <span class="at">p_deplete_adj =</span> <span class="fu">p.adjust</span>(p_deplete, <span class="at">method =</span> <span class="st">"fdr"</span>)) </span>
<span id="cb35-21"><a href="#cb35-21"></a></span>
<span id="cb35-22"><a href="#cb35-22"></a>qenrich <span class="ot">&lt;-</span> <span class="fu">qvalue_truncp</span>(phypres<span class="sc">$</span>p_enrich)</span>
<span id="cb35-23"><a href="#cb35-23"></a>qdeplete <span class="ot">&lt;-</span> <span class="fu">qvalue_truncp</span>(phypres<span class="sc">$</span>p_deplete)</span>
<span id="cb35-24"><a href="#cb35-24"></a></span>
<span id="cb35-25"><a href="#cb35-25"></a>phypres<span class="sc">$</span>q_enrich <span class="ot">&lt;-</span> qenrich<span class="sc">$</span>qvalues</span>
<span id="cb35-26"><a href="#cb35-26"></a>phypres<span class="sc">$</span>q_deplete <span class="ot">&lt;-</span> qdeplete<span class="sc">$</span>qvalues</span>
<span id="cb35-27"><a href="#cb35-27"></a></span>
<span id="cb35-28"><a href="#cb35-28"></a>phypres <span class="sc">%&gt;%</span> </span>
<span id="cb35-29"><a href="#cb35-29"></a>  <span class="fu">relocate</span>(p_enrich, q_enrich, p_enrich_adj) <span class="sc">%&gt;%</span> </span>
<span id="cb35-30"><a href="#cb35-30"></a>  <span class="fu">arrange</span>(p_enrich)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["p_enrich"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["q_enrich"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["p_enrich_adj"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["strainID"],"name":[4],"type":["chr"],"align":["left"]},{"label":["prey_history"],"name":[5],"type":["chr"],"align":["left"]},{"label":["predator_history"],"name":[6],"type":["chr"],"align":["left"]},{"label":["COG_category_single"],"name":[7],"type":["chr"],"align":["left"]},{"label":["n_cog_par"],"name":[8],"type":["int"],"align":["right"]},{"label":["n_par"],"name":[9],"type":["int"],"align":["right"]},{"label":["n_cog_background"],"name":[10],"type":["int"],"align":["right"]},{"label":["n_background"],"name":[11],"type":["int"],"align":["right"]},{"label":["p_deplete"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["p_deplete_adj"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["q_deplete"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.002046360","2":"0.01884671","3":"0.02046360","4":"HAMBI_1972","5":"evo","6":"anc","7":"D","8":"3","9":"20","10":"48","11":"3671","12":"0.9998930","13":"0.9998930","14":"1"},{"1":"0.007061142","2":"0.02622342","3":"0.01412228","4":"HAMBI_2659","5":"evo","6":"evo","7":"U","8":"2","9":"4","10":"134","11":"3802","12":"0.9998331","13":"0.9998331","14":"1"},{"1":"0.008541952","2":"0.02622342","3":"0.04270976","4":"HAMBI_1972","5":"evo","6":"evo","7":"D","8":"2","9":"11","10":"48","11":"3671","12":"0.9996783","13":"0.9996783","14":"1"},{"1":"0.019822157","2":"0.03651190","3":"0.05946647","4":"HAMBI_2659","5":"evo","6":"anc","7":"P","8":"2","9":"4","10":"228","11":"3802","12":"0.9991859","13":"0.9991859","14":"1"},{"1":"0.019822157","2":"0.03651190","3":"0.01982216","4":"HAMBI_2659","5":"evo","6":"evo","7":"P","8":"2","9":"4","10":"228","11":"3802","12":"0.9991859","13":"0.9998331","14":"1"},{"1":"0.030435065","2":"0.04671716","3":"0.07608766","4":"HAMBI_1972","5":"evo","6":"evo","7":"M","8":"3","9":"11","10":"239","11":"3671","12":"0.9959844","13":"0.9996783","14":"1"},{"1":"0.048388972","2":"0.06366516","3":"0.24194486","4":"HAMBI_1972","5":"evo","6":"anc","7":"P","8":"4","9":"20","10":"260","11":"3671","12":"0.9890010","13":"0.9998930","14":"1"},{"1":"0.065104876","2":"0.06855872","3":"0.06510488","4":"HAMBI_1972","5":"anc","6":"anc","7":"M","8":"1","9":"1","10":"239","11":"3671","12":"1.0000000","13":"1.0000000","14":"1"},{"1":"0.066996441","2":"0.06855872","3":"0.53597152","4":"HAMBI_1287","5":"evo","6":"anc","7":"P","8":"3","9":"11","10":"366","11":"4121","12":"0.9878023","13":"0.9878023","14":"1"},{"1":"0.082509365","2":"0.07599005","3":"0.45517091","4":"HAMBI_1977","5":"evo","6":"anc","7":"M","8":"2","9":"8","10":"330","11":"5367","12":"0.9897709","13":"0.9897709","14":"1"},{"1":"0.128289094","2":"0.08837313","3":"0.37656909","4":"HAMBI_1287","5":"evo","6":"evo","7":"T","8":"1","9":"4","10":"139","11":"4121","12":"0.9935182","13":"0.9935182","14":"1"},{"1":"0.133748890","2":"0.08837313","3":"0.19803151","4":"HAMBI_2659","5":"evo","6":"anc","7":"U","8":"1","9":"4","10":"134","11":"3802","12":"0.9929389","13":"0.9991859","14":"1"},{"1":"0.146504294","2":"0.08837313","3":"0.20353750","4":"HAMBI_1977","5":"evo","6":"evo","7":"T","8":"1","9":"3","10":"276","11":"5367","12":"0.9923628","13":"0.9923628","14":"1"},{"1":"0.151723637","2":"0.08837313","3":"0.45517091","4":"HAMBI_1977","5":"evo","6":"anc","7":"E","8":"2","9":"8","10":"472","11":"5367","12":"0.9729343","13":"0.9897709","14":"1"},{"1":"0.173381430","2":"0.08837313","3":"0.20353750","4":"HAMBI_1977","5":"evo","6":"evo","7":"M","8":"1","9":"3","10":"330","11":"5367","12":"0.9891513","13":"0.9923628","14":"1"},{"1":"0.180383292","2":"0.08837313","3":"0.28003484","4":"HAMBI_1972","5":"evo","6":"evo","7":"P","8":"2","9":"11","10":"260","11":"3671","12":"0.9621343","13":"0.9996783","14":"1"},{"1":"0.182921173","2":"0.08837313","3":"0.29674909","4":"HAMBI_1972","5":"anc","6":"evo","7":"M","8":"1","9":"3","10":"239","11":"3671","12":"0.9878793","13":"0.9878793","14":"1"},{"1":"0.187574954","2":"0.08837313","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"Q","8":"1","9":"11","10":"77","11":"4121","12":"0.9830061","13":"0.9878023","14":"1"},{"1":"0.197832728","2":"0.08837313","3":"0.29674909","4":"HAMBI_1972","5":"anc","6":"evo","7":"P","8":"1","9":"3","10":"260","11":"3671","12":"0.9857080","13":"0.9878793","14":"1"},{"1":"0.198031515","2":"0.08837313","3":"0.19803151","4":"HAMBI_2659","5":"evo","6":"anc","7":"T","8":"1","9":"4","10":"204","11":"3802","12":"0.9840008","13":"0.9991859","14":"1"},{"1":"0.203537495","2":"0.08837313","3":"0.20353750","4":"HAMBI_1977","5":"evo","6":"evo","7":"P","8":"1","9":"3","10":"392","11":"5367","12":"0.9848075","13":"0.9923628","14":"1"},{"1":"0.219443925","2":"0.08837313","3":"0.53053622","4":"HAMBI_1972","5":"evo","6":"anc","7":"K","8":"3","9":"20","10":"299","11":"3671","12":"0.9260761","13":"0.9998930","14":"1"},{"1":"0.224027872","2":"0.08837313","3":"0.28003484","4":"HAMBI_1972","5":"evo","6":"evo","7":"K","8":"2","9":"11","10":"299","11":"3671","12":"0.9459853","13":"0.9996783","14":"1"},{"1":"0.235915182","2":"0.08837313","3":"0.37656909","4":"HAMBI_1287","5":"evo","6":"evo","7":"M","8":"1","9":"4","10":"268","11":"4121","12":"0.9768378","13":"0.9935182","14":"1"},{"1":"0.248792629","2":"0.08837313","3":"0.53053622","4":"HAMBI_1972","5":"evo","6":"anc","7":"Q","8":"1","9":"20","10":"52","11":"3671","12":"0.9682228","13":"0.9998930","14":"1"},{"1":"0.249482494","2":"0.08837313","3":"0.45998675","4":"HAMBI_1977","5":"evo","6":"anc","7":"H","8":"1","9":"8","10":"189","11":"5367","12":"0.9699688","13":"0.9897709","14":"1"},{"1":"0.265268108","2":"0.09048462","3":"0.53053622","4":"HAMBI_1972","5":"evo","6":"anc","7":"V","8":"1","9":"20","10":"56","11":"3671","12":"0.9635694","13":"0.9998930","14":"1"},{"1":"0.282426815","2":"0.09289693","3":"0.37656909","4":"HAMBI_1287","5":"evo","6":"evo","7":"K","8":"1","9":"4","10":"328","11":"4121","12":"0.9659785","13":"0.9935182","14":"1"},{"1":"0.306657832","2":"0.09661074","3":"0.45998675","4":"HAMBI_1977","5":"evo","6":"anc","7":"I","8":"1","9":"8","10":"240","11":"5367","12":"0.9533455","13":"0.9897709","14":"1"},{"1":"0.314697409","2":"0.09661074","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"T","8":"1","9":"11","10":"139","11":"4121","12":"0.9491061","13":"0.9878023","14":"1"},{"1":"0.377709062","2":"0.11221456","3":"0.56701635","4":"HAMBI_1972","5":"evo","6":"anc","7":"M","8":"2","9":"20","10":"239","11":"3671","12":"0.8627358","13":"0.9998930","14":"1"},{"1":"0.434992351","2":"0.12327803","3":"0.56701635","4":"HAMBI_1972","5":"evo","6":"anc","7":"E","8":"2","9":"20","10":"268","11":"3671","12":"0.8245362","13":"0.9998930","14":"1"},{"1":"0.453613083","2":"0.12327803","3":"0.56701635","4":"HAMBI_1972","5":"evo","6":"anc","7":"F","8":"1","9":"20","10":"109","11":"3671","12":"0.8825776","13":"0.9998930","14":"1"},{"1":"0.455104504","2":"0.12327803","3":"0.54612540","4":"HAMBI_1977","5":"evo","6":"anc","7":"P","8":"1","9":"8","10":"392","11":"5367","12":"0.8888553","13":"0.9897709","14":"1"},{"1":"0.494771042","2":"0.13019362","3":"0.49477104","4":"HAMBI_1972","5":"anc","6":"evo","7":"S","8":"1","9":"3","10":"747","11":"3671","12":"0.8927095","13":"0.9878793","14":"1"},{"1":"0.523177800","2":"0.13384443","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"M","8":"1","9":"11","10":"268","11":"4121","12":"0.8425968","13":"0.9878023","14":"1"},{"1":"0.554889879","2":"0.13445237","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"C","8":"1","9":"11","10":"292","11":"4121","12":"0.8194735","13":"0.9878023","14":"1"},{"1":"0.579838434","2":"0.13445237","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"G","8":"1","9":"11","10":"312","11":"4121","12":"0.7997337","13":"0.9878023","14":"1"},{"1":"0.582659429","2":"0.13445237","3":"0.58265943","4":"HAMBI_1977","5":"evo","6":"anc","7":"K","8":"1","9":"8","10":"555","11":"5367","12":"0.8029789","13":"0.9897709","14":"1"},{"1":"0.583949075","2":"0.13445237","3":"0.58394907","4":"HAMBI_1287","5":"evo","6":"evo","7":"S","8":"1","9":"4","10":"811","11":"4121","12":"0.8241759","13":"0.9935182","14":"1"},{"1":"0.598874389","2":"0.13452573","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"K","8":"1","9":"11","10":"328","11":"4121","12":"0.7836953","13":"0.9878023","14":"1"},{"1":"0.613580456","2":"0.13454753","3":"0.68175606","4":"HAMBI_1972","5":"evo","6":"anc","7":"H","8":"1","9":"20","10":"170","11":"3671","12":"0.7637390","13":"0.9998930","14":"1"},{"1":"0.668678894","2":"0.14321966","3":"0.66867889","4":"HAMBI_1287","5":"evo","6":"anc","7":"S","8":"2","9":"11","10":"811","11":"4121","12":"0.6280538","13":"0.9878023","14":"1"},{"1":"0.688468772","2":"0.14410699","3":"0.68846877","4":"HAMBI_1972","5":"evo","6":"evo","7":"S","8":"2","9":"11","10":"747","11":"3671","12":"0.6058046","13":"0.9996783","14":"1"},{"1":"0.935958041","2":"0.19155670","3":"0.93595804","4":"HAMBI_1972","5":"evo","6":"anc","7":"S","8":"2","9":"20","10":"747","11":"3671","12":"0.1947991","13":"0.9998930","14":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="nonparametric-simulation" class="level4" data-number="5.2.2.2">
<h4 data-number="5.2.2.2" class="anchored" data-anchor-id="nonparametric-simulation"><span class="header-section-number">5.2.2.2</span> Nonparametric simulation</h4>
<p>We can also look at different COG categories by simply counting the number of random samplings that have a COG count greater/less than that the observed COG count. Since we resampled the same number of genes as in the observed we can compare the two directly. Below we do this integrated over all species in the community to see if there was any pathway enriched across all species.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">left_join</span>(COGs_distribution_simulated, COGs_distribution_observed,</span>
<span id="cb36-2"><a href="#cb36-2"></a>          <span class="at">by =</span> <span class="fu">join_by</span>(COG_category_single, strainID, prey_history, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">mutate</span>(<span class="at">gt =</span> <span class="fu">if_else</span>(nsim <span class="sc">&gt;=</span> nobs, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="fu">group_by</span>(COG_category_single, strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="fu">summarize</span>(<span class="at">p =</span> <span class="fu">sum</span>(gt)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="fu">arrange</span>(p) <span class="sc">%&gt;%</span> </span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="fu">mutate</span>(<span class="at">p_adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'COG_category_single', 'strainID',
'prey_history'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["COG_category_single"],"name":[1],"type":["chr"],"align":["left"]},{"label":["strainID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["prey_history"],"name":[3],"type":["chr"],"align":["left"]},{"label":["predator_history"],"name":[4],"type":["chr"],"align":["left"]},{"label":["p"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p_adj"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"D","2":"HAMBI_1972","3":"evo","4":"anc","5":"0.009466437","6":"0.01893287"},{"1":"D","2":"HAMBI_1972","3":"evo","4":"evo","5":"0.052205882","6":"0.05220588"},{"1":"P","2":"HAMBI_1972","3":"evo","4":"anc","5":"0.070301475","6":"0.14060295"},{"1":"M","2":"HAMBI_1972","3":"evo","4":"evo","5":"0.072079972","6":"0.14415994"},{"1":"U","2":"HAMBI_2659","3":"evo","4":"evo","5":"0.087906977","6":"0.17581395"},{"1":"P","2":"HAMBI_2659","3":"evo","4":"anc","5":"0.108581436","6":"0.16133764"},{"1":"P","2":"HAMBI_1287","3":"evo","4":"anc","5":"0.125000000","6":"0.12500000"},{"1":"P","2":"HAMBI_2659","3":"evo","4":"evo","5":"0.161337636","6":"0.16133764"},{"1":"K","2":"HAMBI_1972","3":"evo","4":"anc","5":"0.194039914","6":"0.30564972"},{"1":"M","2":"HAMBI_1977","3":"evo","4":"anc","5":"0.252711497","6":"0.50542299"},{"1":"K","2":"HAMBI_1972","3":"evo","4":"evo","5":"0.305649718","6":"0.30564972"},{"1":"E","2":"HAMBI_1977","3":"evo","4":"anc","5":"0.314353284","6":"0.31435328"},{"1":"P","2":"HAMBI_1972","3":"evo","4":"evo","5":"0.324626866","6":"0.32462687"},{"1":"S","2":"HAMBI_1287","3":"evo","4":"anc","5":"0.559054138","6":"1.00000000"},{"1":"M","2":"HAMBI_1972","3":"evo","4":"anc","5":"0.560839161","6":"0.56083916"},{"1":"S","2":"HAMBI_1972","3":"evo","4":"evo","5":"0.604802703","6":"0.85788436"},{"1":"E","2":"HAMBI_1972","3":"evo","4":"anc","5":"0.609089810","6":"0.60908981"},{"1":"S","2":"HAMBI_1972","3":"evo","4":"anc","5":"0.857884356","6":"0.85788436"},{"1":"C","2":"HAMBI_1287","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"F","2":"HAMBI_1972","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"G","2":"HAMBI_1287","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"H","2":"HAMBI_1972","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"H","2":"HAMBI_1977","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"I","2":"HAMBI_1977","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"K","2":"HAMBI_1287","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"K","2":"HAMBI_1287","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"K","2":"HAMBI_1977","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"M","2":"HAMBI_1287","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"M","2":"HAMBI_1287","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"M","2":"HAMBI_1972","3":"anc","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"M","2":"HAMBI_1972","3":"anc","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"M","2":"HAMBI_1977","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"P","2":"HAMBI_1972","3":"anc","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"P","2":"HAMBI_1977","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"P","2":"HAMBI_1977","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"Q","2":"HAMBI_1287","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"Q","2":"HAMBI_1972","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"S","2":"HAMBI_1287","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"S","2":"HAMBI_1972","3":"anc","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"T","2":"HAMBI_1287","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"T","2":"HAMBI_1287","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"T","2":"HAMBI_1977","3":"evo","4":"evo","5":"1.000000000","6":"1.00000000"},{"1":"T","2":"HAMBI_2659","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"U","2":"HAMBI_2659","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"},{"1":"V","2":"HAMBI_1972","3":"evo","4":"anc","5":"1.000000000","6":"1.00000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="cog-distribution-plot" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="cog-distribution-plot"><span class="header-section-number">5.2.3</span> COG Distribution Plot</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>cog_pmut <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb38-2"><a href="#cb38-2"></a>                      <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">count</span>(COG_category_single) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb38-5"><a href="#cb38-5"></a>         <span class="at">n =</span> n<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb38-6"><a href="#cb38-6"></a>         <span class="at">type =</span> <span class="st">"parallel_mutations"</span>) </span>
<span id="cb38-7"><a href="#cb38-7"></a></span>
<span id="cb38-8"><a href="#cb38-8"></a>cog_everything <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9"></a>  <span class="fu">count</span>(COG_category_single) <span class="sc">%&gt;%</span> </span>
<span id="cb38-10"><a href="#cb38-10"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n), </span>
<span id="cb38-11"><a href="#cb38-11"></a>         <span class="at">type =</span> <span class="st">"all_genes"</span>) </span>
<span id="cb38-12"><a href="#cb38-12"></a></span>
<span id="cb38-13"><a href="#cb38-13"></a>pcogs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cog_pmut, cog_everything) <span class="sc">%&gt;%</span> </span>
<span id="cb38-14"><a href="#cb38-14"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-15"><a href="#cb38-15"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(COG_category_single, f, <span class="at">.desc =</span> F), <span class="at">y=</span>n, <span class="at">fill =</span> type), <span class="at">stat=</span><span class="st">"identity"</span>,</span>
<span id="cb38-17"><a href="#cb38-17"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>( <span class="at">preserve =</span> <span class="st">"total"</span>)) <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"COG Category"</span>, <span class="at">y =</span> <span class="st">"Fraction genes in COG category"</span>, <span class="at">fill =</span> <span class="st">"Subset"</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb38-21"><a href="#cb38-21"></a>    <span class="st">"N all genes"</span>, </span>
<span id="cb38-22"><a href="#cb38-22"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">name =</span> <span class="st">"N parallel genes"</span>)</span>
<span id="cb38-23"><a href="#cb38-23"></a>  ) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb38-25"><a href="#cb38-25"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-26"><a href="#cb38-26"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-27"><a href="#cb38-27"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-28"><a href="#cb38-28"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb38-29"><a href="#cb38-29"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-05" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_parallelism_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Fraction of genes in each Cluster of Orthologous Groups (COG) category for genes with a COG annotation (red bars, left y-axis) and only genes exhibiting significant genomic parallelism (blue bars, right y-axis) integrated over HAMBI species from metagenomes (i.e., species exceeding the coverage threshold).
</figcaption>
</figure>
</div>
</section>
<section id="species-present-in-the-metagenomes" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="species-present-in-the-metagenomes"><span class="header-section-number">5.2.4</span> Species present in the metagenomes</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># species detected in the metagenomes</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>mgsp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HAMBI_2659"</span>, <span class="st">"HAMBI_1972"</span>, <span class="st">"HAMBI_1977"</span>, <span class="st">"HAMBI_1287"</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a>cog_pmut_mgsp <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb39-5"><a href="#cb39-5"></a>                      <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-6"><a href="#cb39-6"></a>  <span class="fu">filter</span>(strainID <span class="sc">%in%</span> mgsp) <span class="sc">%&gt;%</span> </span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"tot"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-9"><a href="#cb39-9"></a>  <span class="co"># scaling factor to make ploting on 2 axes possible</span></span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> tot<span class="sc">*</span><span class="dv">250</span>,</span>
<span id="cb39-11"><a href="#cb39-11"></a>         <span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb39-12"><a href="#cb39-12"></a>         <span class="at">type =</span> <span class="st">"parallel_mutations"</span>) </span>
<span id="cb39-13"><a href="#cb39-13"></a></span>
<span id="cb39-14"><a href="#cb39-14"></a>cog_everything_mgsp <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb39-15"><a href="#cb39-15"></a>  <span class="fu">filter</span>(strainID <span class="sc">%in%</span> mgsp) <span class="sc">%&gt;%</span> </span>
<span id="cb39-16"><a href="#cb39-16"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb39-17"><a href="#cb39-17"></a>  <span class="fu">count</span>(COG_category_single) <span class="sc">%&gt;%</span> </span>
<span id="cb39-18"><a href="#cb39-18"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb39-19"><a href="#cb39-19"></a>         <span class="at">type =</span> <span class="st">"all_genes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-20"><a href="#cb39-20"></a>  <span class="fu">expand_grid</span>(<span class="at">prey_history =</span> <span class="fu">c</span>(<span class="st">"anc"</span>, <span class="st">"evo"</span>), <span class="at">predator_history =</span> <span class="fu">c</span>(<span class="st">"anc"</span>, <span class="st">"evo"</span>))</span>
<span id="cb39-21"><a href="#cb39-21"></a></span>
<span id="cb39-22"><a href="#cb39-22"></a>pcogs_mgsp <span class="ot">&lt;-</span> <span class="fu">semi_join</span>(cog_everything_mgsp, cog_pmut_mgsp,</span>
<span id="cb39-23"><a href="#cb39-23"></a>          <span class="at">by =</span> <span class="fu">join_by</span>(strainID, prey_history, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-24"><a href="#cb39-24"></a>  <span class="fu">bind_rows</span>(cog_pmut_mgsp) <span class="sc">%&gt;%</span> </span>
<span id="cb39-25"><a href="#cb39-25"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-26"><a href="#cb39-26"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">paste0</span>(<span class="st">"prey:"</span>, prey_history, <span class="st">" | pred:"</span>, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-27"><a href="#cb39-27"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb39-28"><a href="#cb39-28"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(COG_category_single, n, <span class="at">.desc =</span> F), <span class="at">y=</span>n, <span class="at">fill =</span> type), <span class="at">stat=</span><span class="st">"identity"</span>,</span>
<span id="cb39-29"><a href="#cb39-29"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>( <span class="at">preserve =</span> <span class="st">"total"</span>)) <span class="sc">+</span></span>
<span id="cb39-30"><a href="#cb39-30"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb39-31"><a href="#cb39-31"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"U"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"D"</span>, <span class="st">"P"</span>, <span class="st">"M"</span>),</span>
<span id="cb39-32"><a href="#cb39-32"></a>                           <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>),</span>
<span id="cb39-33"><a href="#cb39-33"></a>                           <span class="at">strainID =</span> <span class="fu">c</span>(<span class="st">"HAMBI_2659"</span>, <span class="st">"HAMBI_2659"</span>, <span class="st">"HAMBI_1972"</span>, <span class="st">"HAMBI_1972"</span>, <span class="st">"HAMBI_2659"</span> ,<span class="st">"HAMBI_1972"</span>),</span>
<span id="cb39-34"><a href="#cb39-34"></a>                           <span class="at">prey_history =</span> <span class="fu">c</span>(<span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>),</span>
<span id="cb39-35"><a href="#cb39-35"></a>                           <span class="at">predator_history =</span> <span class="fu">c</span>(<span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"anc"</span>, <span class="st">"evo"</span>, <span class="st">"anc"</span>, <span class="st">"evo"</span>)),</span>
<span id="cb39-36"><a href="#cb39-36"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">shape =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb39-37"><a href="#cb39-37"></a>  <span class="fu">facet_grid</span>(treat <span class="sc">~</span> strainID) <span class="sc">+</span></span>
<span id="cb39-38"><a href="#cb39-38"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"COG Category"</span>, <span class="at">y =</span> <span class="st">"Fraction genes in COG category"</span>, <span class="at">fill =</span> <span class="st">"Subset"</span>) <span class="sc">+</span></span>
<span id="cb39-39"><a href="#cb39-39"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb39-40"><a href="#cb39-40"></a>    <span class="st">"N all genes"</span>, </span>
<span id="cb39-41"><a href="#cb39-41"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">250</span>, <span class="at">name =</span> <span class="st">"N parallel genes"</span>)</span>
<span id="cb39-42"><a href="#cb39-42"></a>  ) <span class="sc">+</span></span>
<span id="cb39-43"><a href="#cb39-43"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb39-44"><a href="#cb39-44"></a>  <span class="fu">theme</span>(</span>
<span id="cb39-45"><a href="#cb39-45"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-46"><a href="#cb39-46"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-47"><a href="#cb39-47"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-48"><a href="#cb39-48"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb39-49"><a href="#cb39-49"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-06" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_parallelism_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Fraction of genes in each Cluster of Orthologous Groups (COG) category for genes with a COG annotation (red bars, left y-axis) and only genes exhibiting significant genomic parallelism (blue bars, right y-axis) for the four most abundant HAMBI genomes. COG categories for species <span class="math inline">\(\times\)</span> treatments combinationm are denoted with * if they are significantly enriched in parallel mutations relative to the genomic background. See statistical results in table below.
</figcaption>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show/hide code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(figs, <span class="st">"COG_enrich_mgs.svg"</span>), pcogs_mgsp, <span class="at">width=</span><span class="dv">7</span>, <span class="at">height=</span><span class="dv">7</span>, </span>
<span id="cb40-2"><a href="#cb40-2"></a>       <span class="at">units=</span><span class="st">"in"</span>, <span class="at">device=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>strainID</th>
<th>prey history</th>
<th>predator history</th>
<th>COG category</th>
<th>q value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HAMBI_1972</td>
<td>Evolved</td>
<td>Ancestral</td>
<td>D - Cell cycle control, cell division, chromosome partitioning</td>
<td>0.019</td>
</tr>
<tr class="even">
<td>HAMBI_1972</td>
<td>Evolved</td>
<td>Evolved</td>
<td>D - Cell cycle control, cell division, chromosome partitioning</td>
<td>0.026</td>
</tr>
<tr class="odd">
<td>HAMBI_1972</td>
<td>Evolved</td>
<td>Evolved</td>
<td>M - Cell wall/membrane/envelope biogenesis</td>
<td>0.047</td>
</tr>
<tr class="even">
<td>HAMBI_2659</td>
<td>Evolved</td>
<td>Evolved</td>
<td>U - Intracellular trafficking, secretion, and vesicular transport</td>
<td>0.026</td>
</tr>
<tr class="odd">
<td>HAMBI_2659</td>
<td>Evolved</td>
<td>Ancestral</td>
<td>P - Inorganic ion transport and metabolism</td>
<td>0.037</td>
</tr>
<tr class="even">
<td>HAMBI_2659</td>
<td>Evolved</td>
<td>Evolved</td>
<td>P - Inorganic ion transport and metabolism</td>
<td>0.037</td>
</tr>
</tbody>
</table>


<!-- -->


</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-good2017" class="csl-entry" role="listitem">
Good, Benjamin H., Michael J. McDonald, Jeffrey E. Barrick, Richard E. Lenski, and Michael M. Desai. 2017. <span>The Dynamics of Molecular Evolution over 60,000 Generations.</span> <em>Nature</em> 551 (7678): 4550. <a href="https://doi.org/10.1038/nature24287">https://doi.org/10.1038/nature24287</a>.
</div>
<div id="ref-shoemaker2021" class="csl-entry" role="listitem">
Shoemaker, William R, Evgeniya Polezhaeva, Kenzie B Givens, and Jay T Lennon. 2021. <span>Molecular Evolutionary Dynamics of Energy Limited Microorganisms.</span> Edited by Fabia Ursula Battistuzzi. <em>Molecular Biology and Evolution</em> 38 (10): 453245. <a href="https://doi.org/10.1093/molbev/msab195">https://doi.org/10.1093/molbev/msab195</a>.
</div>
<div id="ref-storey2003a" class="csl-entry" role="listitem">
Storey, John D., and Robert Tibshirani. 2003. <span>Statistical Significance for Genomewide Studies.</span> <em>Proceedings of the National Academy of Sciences</em> 100 (16): 944045. <a href="https://doi.org/10.1073/pnas.1530509100">https://doi.org/10.1073/pnas.1530509100</a>.
</div>
<div id="ref-tenaillon2016" class="csl-entry" role="listitem">
Tenaillon, Olivier, Jeffrey E. Barrick, Noah Ribeck, Daniel E. Deatherage, Jeffrey L. Blanchard, Aurko Dasgupta, Gabriel C. Wu, et al. 2016. <span>Tempo and Mode of Genome Evolution in a 50,000-Generation Experiment.</span> <em>Nature</em> 536 (7615): 16570. <a href="https://doi.org/10.1038/nature18959">https://doi.org/10.1038/nature18959</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb41" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">---</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="an">title:</span><span class="co"> "Metagenome genetic parallelism"</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="an">author:</span><span class="co"> "Shane Hogle"</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="an">link-citations:</span><span class="co"> true</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="an">abstract:</span><span class="co"> "This notebook reads in the formatted metagenome variant frequencies and annotations. It then uses statistical tests to determine which mutations and which functional categories appeared across biological replicates within condition more often than would be expected by chance. It also looks for mutations/functions that arise within treatment categories more than expected by chance."</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co">---</span></span>
<span id="cb41-9"><a href="#cb41-9"></a></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="fu"># Setup</span></span>
<span id="cb41-11"><a href="#cb41-11"></a></span>
<span id="cb41-12"><a href="#cb41-12"></a>Libraries and global variables</span>
<span id="cb41-13"><a href="#cb41-13"></a></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="in">```{r}</span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="co">#| output: false</span></span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="fu">library</span>(here)</span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="fu">library</span>(fs)</span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb41-22"><a href="#cb41-22"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb41-23"><a href="#cb41-23"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb41-24"><a href="#cb41-24"></a><span class="fu">library</span>(vctrs)</span>
<span id="cb41-25"><a href="#cb41-25"></a></span>
<span id="cb41-26"><a href="#cb41-26"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils_generic.R"</span>))</span>
<span id="cb41-27"><a href="#cb41-27"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"metagenome"</span>, <span class="st">"utils_parallelism.R"</span>))</span>
<span id="cb41-28"><a href="#cb41-28"></a><span class="in">```</span></span>
<span id="cb41-29"><a href="#cb41-29"></a></span>
<span id="cb41-30"><a href="#cb41-30"></a>Set up some directories</span>
<span id="cb41-31"><a href="#cb41-31"></a></span>
<span id="cb41-34"><a href="#cb41-34"></a><span class="in">```{r}</span></span>
<span id="cb41-35"><a href="#cb41-35"></a><span class="co">#| output: false</span></span>
<span id="cb41-36"><a href="#cb41-36"></a><span class="co">#| warning: false</span></span>
<span id="cb41-37"><a href="#cb41-37"></a><span class="co">#| error: false</span></span>
<span id="cb41-38"><a href="#cb41-38"></a>data_raw <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"metagenome"</span>)</span>
<span id="cb41-39"><a href="#cb41-39"></a>data <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"metagenome"</span>)</span>
<span id="cb41-40"><a href="#cb41-40"></a>shared <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_data_raw"</span>, <span class="st">"shared"</span>)</span>
<span id="cb41-41"><a href="#cb41-41"></a>figs <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs"</span>, <span class="st">"metagenome"</span>)</span>
<span id="cb41-42"><a href="#cb41-42"></a></span>
<span id="cb41-43"><a href="#cb41-43"></a><span class="co"># make processed data directory if it doesn't exist</span></span>
<span id="cb41-44"><a href="#cb41-44"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(data)</span>
<span id="cb41-45"><a href="#cb41-45"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(figs)</span>
<span id="cb41-46"><a href="#cb41-46"></a><span class="in">```</span></span>
<span id="cb41-47"><a href="#cb41-47"></a></span>
<span id="cb41-48"><a href="#cb41-48"></a><span class="fu"># Read data</span></span>
<span id="cb41-49"><a href="#cb41-49"></a></span>
<span id="cb41-52"><a href="#cb41-52"></a><span class="in">```{r}</span></span>
<span id="cb41-53"><a href="#cb41-53"></a><span class="co">#| output: false</span></span>
<span id="cb41-54"><a href="#cb41-54"></a><span class="co">#| warning: false</span></span>
<span id="cb41-55"><a href="#cb41-55"></a><span class="co">#| error: false</span></span>
<span id="cb41-56"><a href="#cb41-56"></a></span>
<span id="cb41-57"><a href="#cb41-57"></a><span class="co"># these were already filtered in the last step</span></span>
<span id="cb41-58"><a href="#cb41-58"></a>mgvars <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"metagenome_variant_timeseries.tsv"</span>))</span>
<span id="cb41-59"><a href="#cb41-59"></a>degentab <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"annotations_codon_degeneracy.rds"</span>))</span>
<span id="cb41-60"><a href="#cb41-60"></a>genome_len <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"HAMBI_genome_len.tsv"</span>))</span>
<span id="cb41-61"><a href="#cb41-61"></a><span class="co"># annotations</span></span>
<span id="cb41-62"><a href="#cb41-62"></a>annotations <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"annotations_codon_degeneracy.rds"</span>))</span>
<span id="cb41-63"><a href="#cb41-63"></a><span class="in">```</span></span>
<span id="cb41-64"><a href="#cb41-64"></a></span>
<span id="cb41-65"><a href="#cb41-65"></a><span class="fu"># Parallelism at nucleotide level</span></span>
<span id="cb41-66"><a href="#cb41-66"></a></span>
<span id="cb41-69"><a href="#cb41-69"></a><span class="in">```{r}</span></span>
<span id="cb41-70"><a href="#cb41-70"></a><span class="co"># exclude fixed variants from day 0 </span></span>
<span id="cb41-71"><a href="#cb41-71"></a>tofilter <span class="ot">&lt;-</span> mgvars <span class="sc">%&gt;%</span> </span>
<span id="cb41-72"><a href="#cb41-72"></a>  <span class="fu">filter</span>(time_days <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-73"><a href="#cb41-73"></a>  <span class="fu">filter</span>(freq_alt_complete <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-74"><a href="#cb41-74"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(chrom, pos, ref, alt) <span class="sc">%&gt;%</span> </span>
<span id="cb41-75"><a href="#cb41-75"></a>  <span class="fu">distinct</span>()</span>
<span id="cb41-76"><a href="#cb41-76"></a></span>
<span id="cb41-77"><a href="#cb41-77"></a><span class="co"># mobile regions have already been masked in the data wrangling step</span></span>
<span id="cb41-78"><a href="#cb41-78"></a></span>
<span id="cb41-79"><a href="#cb41-79"></a>mgvars_filt_mb <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(mgvars, tofilter, <span class="at">by =</span> <span class="fu">join_by</span>(chrom, pos, ref, alt)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-80"><a href="#cb41-80"></a>  <span class="co"># exclude variants that were added to make complete time course</span></span>
<span id="cb41-81"><a href="#cb41-81"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(freq_alt_complete)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-82"><a href="#cb41-82"></a>  <span class="fu">filter</span>(freq_alt_complete <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-83"><a href="#cb41-83"></a>  <span class="fu">filter</span>(time_days <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb41-84"><a href="#cb41-84"></a><span class="in">```</span></span>
<span id="cb41-85"><a href="#cb41-85"></a></span>
<span id="cb41-86"><a href="#cb41-86"></a>Looking at all mutations (inside and outside of coding sequences, synonymous and nonsynonymous)</span>
<span id="cb41-87"><a href="#cb41-87"></a></span>
<span id="cb41-90"><a href="#cb41-90"></a><span class="in">```{r}</span></span>
<span id="cb41-91"><a href="#cb41-91"></a>mgvars_filt_mb <span class="sc">%&gt;%</span> </span>
<span id="cb41-92"><a href="#cb41-92"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history, chrom, pos, ref, alt) <span class="sc">%&gt;%</span> </span>
<span id="cb41-93"><a href="#cb41-93"></a>  <span class="fu">mutate</span>(<span class="at">mi=</span><span class="fu">n_distinct</span>(replicate)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-94"><a href="#cb41-94"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb41-95"><a href="#cb41-95"></a>  <span class="fu">count</span>(mi) <span class="sc">%&gt;%</span> </span>
<span id="cb41-96"><a href="#cb41-96"></a>  <span class="fu">group_by</span>(mi) <span class="sc">%&gt;%</span> </span>
<span id="cb41-97"><a href="#cb41-97"></a>  <span class="fu">mutate</span>(<span class="at">tot =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-98"><a href="#cb41-98"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mi))</span>
<span id="cb41-99"><a href="#cb41-99"></a><span class="in">```</span></span>
<span id="cb41-100"><a href="#cb41-100"></a></span>
<span id="cb41-101"><a href="#cb41-101"></a>We identified 13 species $\times$ treatment combinations with detectable mutations. To put these observations in context, we can compare them to a simple null model in which mutations are uniformly distributed across the sites in the genome. We can then check how many sites with 1, 2, and 3-fold multiplicity that we would expect by chance. We define nucleotide parallelism as the number of mutations occurring at the same site in the genome in independent populations for a given species $\times$ treatment combination. For each site, we define the multiplicity, $m_{i}$, as the number of populations (i.e., replicates) with a mutation detected at that site, so that the multiplicity in this experiment can range from one to three.</span>
<span id="cb41-102"><a href="#cb41-102"></a></span>
<span id="cb41-103"><a href="#cb41-103"></a>The expected number of mutations with $m_{i} \geq m$ in a sample of total mutations size $n_{tot}$ is:</span>
<span id="cb41-104"><a href="#cb41-104"></a></span>
<span id="cb41-105"><a href="#cb41-105"></a>$$ S(m) \approx \sum_{n \geq m} \frac{n}{n_{tot}} \cdot L_{tot} \cdot \frac{ \left( \frac{n_{tot}}{L_{tot}} \right) ^n}{n!} e^{-n_{tot}/L_{tot}} $$</span>
<span id="cb41-106"><a href="#cb41-106"></a></span>
<span id="cb41-107"><a href="#cb41-107"></a>where $L_{tot}$ is the total number of bases in the genome.</span>
<span id="cb41-108"><a href="#cb41-108"></a></span>
<span id="cb41-109"><a href="#cb41-109"></a><span class="fu">## Nucleotide parallelism by treatment</span></span>
<span id="cb41-110"><a href="#cb41-110"></a></span>
<span id="cb41-111"><a href="#cb41-111"></a>Here we will do the estimation separately for each species $\times$ treatment combination.</span>
<span id="cb41-112"><a href="#cb41-112"></a></span>
<span id="cb41-115"><a href="#cb41-115"></a><span class="in">```{r}</span></span>
<span id="cb41-116"><a href="#cb41-116"></a>nuc_survival <span class="ot">&lt;-</span> mgvars_filt_mb <span class="sc">%&gt;%</span></span>
<span id="cb41-117"><a href="#cb41-117"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(strainID, prey_history, predator_history, pos, ref, alt, replicate) <span class="sc">%&gt;%</span> </span>
<span id="cb41-118"><a href="#cb41-118"></a>  <span class="co"># multiplicity = number of replicate populations each unique mutation is</span></span>
<span id="cb41-119"><a href="#cb41-119"></a>  <span class="co"># observed in</span></span>
<span id="cb41-120"><a href="#cb41-120"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">n_distinct</span>(replicate), <span class="at">.by =</span> <span class="fu">c</span>(strainID, prey_history, predator_history, pos, ref, alt)) <span class="sc">%&gt;%</span></span>
<span id="cb41-121"><a href="#cb41-121"></a>  <span class="co"># now calculate the total number of mutations across all replicates so we need</span></span>
<span id="cb41-122"><a href="#cb41-122"></a>  <span class="co"># to ungroup by mutation position/alt allele but because we still want to</span></span>
<span id="cb41-123"><a href="#cb41-123"></a>  <span class="co"># determine this value by treatment category we keep the treatment category</span></span>
<span id="cb41-124"><a href="#cb41-124"></a>  <span class="co"># grouping. However, this should be changed if you want to for example average</span></span>
<span id="cb41-125"><a href="#cb41-125"></a>  <span class="co"># over all the treatment conditions on a species basis</span></span>
<span id="cb41-126"><a href="#cb41-126"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span></span>
<span id="cb41-127"><a href="#cb41-127"></a>  <span class="fu">count</span>(m, <span class="at">name =</span> <span class="st">"m_count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-128"><a href="#cb41-128"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> m <span class="sc">*</span> m_count,</span>
<span id="cb41-129"><a href="#cb41-129"></a>         <span class="at">Ntot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb41-130"><a href="#cb41-130"></a>         <span class="at">perc =</span> n <span class="sc">/</span> Ntot <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-131"><a href="#cb41-131"></a>  <span class="fu">left_join</span>(genome_len, <span class="at">by =</span> <span class="fu">join_by</span>(strainID)) <span class="sc">%&gt;%</span></span>
<span id="cb41-132"><a href="#cb41-132"></a>  <span class="fu">arrange</span>(<span class="fu">cur_group_id</span>(), <span class="fu">desc</span>(m)) <span class="sc">%&gt;%</span></span>
<span id="cb41-133"><a href="#cb41-133"></a>  <span class="co">#  dpois() tells the probability mass at a given number of counts. Here we</span></span>
<span id="cb41-134"><a href="#cb41-134"></a>  <span class="co">#  want to get the probability of observing n mutations with multiplicity</span></span>
<span id="cb41-135"><a href="#cb41-135"></a>  <span class="co">#  = mi (i.e. the counts of mi in the observed data). We assume that</span></span>
<span id="cb41-136"><a href="#cb41-136"></a>  <span class="co">#  mutations independently occur on the genome of size Ltot at a rate of</span></span>
<span id="cb41-137"><a href="#cb41-137"></a>  <span class="co">#  lambda = Ntot/Ltot and that generally the events are rare. Thus this</span></span>
<span id="cb41-138"><a href="#cb41-138"></a>  <span class="co">#  situation can be modeled by the Poisson distribution. We can get the</span></span>
<span id="cb41-139"><a href="#cb41-139"></a>  <span class="co">#  binned number of mutations per level of multiplicity m by multiplying</span></span>
<span id="cb41-140"><a href="#cb41-140"></a>  <span class="co">#  the probability by the length of the genome and the binned mutations</span></span>
<span id="cb41-141"><a href="#cb41-141"></a>  <span class="co">#  divided by the total number of mutations.</span></span>
<span id="cb41-142"><a href="#cb41-142"></a>  <span class="fu">mutate</span>(<span class="at">m_count_expected =</span> <span class="fu">cumsum</span>((m_count <span class="sc">/</span> Ntot) <span class="sc">*</span></span>
<span id="cb41-143"><a href="#cb41-143"></a>                                     total_len <span class="sc">*</span></span>
<span id="cb41-144"><a href="#cb41-144"></a>                                     <span class="fu">dpois</span>(m, <span class="at">lambda =</span> Ntot <span class="sc">/</span> total_len))) <span class="sc">%&gt;%</span></span>
<span id="cb41-145"><a href="#cb41-145"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>num_contigs) <span class="sc">%&gt;%</span></span>
<span id="cb41-146"><a href="#cb41-146"></a>  <span class="fu">relocate</span>(m, n, Ntot, perc, m_count, m_count_expected) <span class="sc">%&gt;%</span></span>
<span id="cb41-147"><a href="#cb41-147"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-148"><a href="#cb41-148"></a></span>
<span id="cb41-149"><a href="#cb41-149"></a><span class="co"># setup for plotting</span></span>
<span id="cb41-150"><a href="#cb41-150"></a>nuc_survival_plot <span class="ot">&lt;-</span> nuc_survival <span class="sc">%&gt;%</span> </span>
<span id="cb41-151"><a href="#cb41-151"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-152"><a href="#cb41-152"></a>  <span class="co"># when there is only one multiplicity observed for a mutation filter such</span></span>
<span id="cb41-153"><a href="#cb41-153"></a>  <span class="co"># that the multiplicty of that mutation must be greater than one.</span></span>
<span id="cb41-154"><a href="#cb41-154"></a>  <span class="co"># Otherwise include all remaining mutations (m &gt; 0)</span></span>
<span id="cb41-155"><a href="#cb41-155"></a>  <span class="fu">filter</span>(<span class="fu">case_when</span>(<span class="fu">n</span>() <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> m <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb41-156"><a href="#cb41-156"></a>                       <span class="cn">TRUE</span> <span class="sc">~</span> m <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-157"><a href="#cb41-157"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"m_count"</span>, <span class="st">"m_count_expected"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-158"><a href="#cb41-158"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste</span>(strainID, <span class="st">"prey:"</span>, prey_history, <span class="st">"</span><span class="sc">\n</span><span class="st">predator:"</span>, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-159"><a href="#cb41-159"></a>  <span class="co"># and make final plot</span></span>
<span id="cb41-160"><a href="#cb41-160"></a>  <span class="fu">plot_nuc_survival</span>(., <span class="dv">5000</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>), <span class="dv">4</span>)</span>
<span id="cb41-161"><a href="#cb41-161"></a><span class="in">```</span></span>
<span id="cb41-162"><a href="#cb41-162"></a></span>
<span id="cb41-163"><a href="#cb41-163"></a>::: {#fig-01}</span>
<span id="cb41-166"><a href="#cb41-166"></a><span class="in">```{r}</span></span>
<span id="cb41-167"><a href="#cb41-167"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb41-168"><a href="#cb41-168"></a><span class="co">#| fig.height: 6</span></span>
<span id="cb41-169"><a href="#cb41-169"></a><span class="co">#| echo: false</span></span>
<span id="cb41-170"><a href="#cb41-170"></a><span class="co">#| warning: false</span></span>
<span id="cb41-171"><a href="#cb41-171"></a>nuc_survival_plot</span>
<span id="cb41-172"><a href="#cb41-172"></a><span class="in">```</span></span>
<span id="cb41-173"><a href="#cb41-173"></a></span>
<span id="cb41-174"><a href="#cb41-174"></a>Distribution of nucleotide multiplicity $(m_{i})$ - i.e., the number of replicates with with the same genomic mutation including site and alternative allele - for species $\times$ treatment combination with sufficient sequencing depth and multiplicities $\gt 1$. The observed data is shown in blue while the null expectation is shown in red. In all cases the observed $m_{i}$ exceeded the null expectation meaning that we must reject the simple null model of uniform mutation distribution in favor of the alternative model where mutations are nonrandom and cluster across replicate populations.</span>
<span id="cb41-175"><a href="#cb41-175"></a>:::</span>
<span id="cb41-176"><a href="#cb41-176"></a></span>
<span id="cb41-177"><a href="#cb41-177"></a><span class="fu">## Conclusion</span></span>
<span id="cb41-178"><a href="#cb41-178"></a></span>
<span id="cb41-179"><a href="#cb41-179"></a>Nucleotide parallelism results are presented in Figure @fig-01. For these species and evolution treatments this very simple null model mostly predicts that we should expect fewer than two parallel mutations (same position, same alternative allele) across the three replicate populations. For 8 species $times$ treatment combinations the observed data show an excess of nucleotide parallelism relative to this simple null expectation. In particular all species have at least 1 mutation that is identical across all three replicate evolved populations. HAMBI_1287, HAMBI_1972, and HAMBI_2659 did evolve some new parallel nucleotide mutation de novo in the ancestral prey treatment. These will be interesting to follow up on. Still, multi-hit sites constitute only a small fraction of the total observed mutations across all species (\~ 14% across species with multi-hit sites). Thus, we will continue our analysis but looking at the gene level.</span>
<span id="cb41-180"><a href="#cb41-180"></a></span>
<span id="cb41-183"><a href="#cb41-183"></a><span class="in">```{r}</span></span>
<span id="cb41-184"><a href="#cb41-184"></a><span class="co">#| warning: false</span></span>
<span id="cb41-185"><a href="#cb41-185"></a>nuc_survival <span class="sc">%&gt;%</span> </span>
<span id="cb41-186"><a href="#cb41-186"></a>  <span class="fu">mutate</span>(<span class="at">Ntot_f =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-187"><a href="#cb41-187"></a>  <span class="fu">summarize</span>(<span class="at">perc =</span> <span class="fu">sum</span>(n)<span class="sc">/</span>Ntot_f<span class="sc">*</span><span class="dv">100</span>, <span class="at">.by =</span> <span class="st">"m"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-188"><a href="#cb41-188"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-189"><a href="#cb41-189"></a>  <span class="fu">mutate</span>(<span class="at">cum_perc =</span> <span class="fu">cumsum</span>(perc))</span>
<span id="cb41-190"><a href="#cb41-190"></a><span class="in">```</span></span>
<span id="cb41-191"><a href="#cb41-191"></a></span>
<span id="cb41-192"><a href="#cb41-192"></a><span class="fu"># Parallelism at gene level</span></span>
<span id="cb41-193"><a href="#cb41-193"></a></span>
<span id="cb41-194"><a href="#cb41-194"></a>If selection pressures and mutation rates did not vary between genes, the number of mutations in each gene should be proportional to the target gene size. We assume that gene length is a primary driver of the target size. We then define a multiplicity for each gene according to:</span>
<span id="cb41-195"><a href="#cb41-195"></a></span>
<span id="cb41-196"><a href="#cb41-196"></a>$$m_{i} = n_{i} \cdot \frac{\overline{L}}{L_{i}}$$ {#eq-01}</span>
<span id="cb41-197"><a href="#cb41-197"></a></span>
<span id="cb41-198"><a href="#cb41-198"></a>where $n_{i}$ is the number of nonsynonymous mutations (i.e., amino acid changing) in $gene_{i}$ across all replicate populations per species, $L_{i}$ is the total number of nonsynonymous sites (i.e., excluding 4-fold degenerate sites) in $gene_{i}$, and $\overline{L}$ is the average value of $L_{i}$ across all genes in the genome. This definition ensures that under the null hypothesis, all genes have the same expected multiplicity $\overline{m} = n_{tot}/n_{genes}$.</span>
<span id="cb41-199"><a href="#cb41-199"></a></span>
<span id="cb41-200"><a href="#cb41-200"></a>We next define a null model for gene multiplicity that assumes mutations are assigned to genes with probability:</span>
<span id="cb41-201"><a href="#cb41-201"></a></span>
<span id="cb41-202"><a href="#cb41-202"></a>$$p_{i} \propto L_{i} r_{i}$$ {#eq-02}</span>
<span id="cb41-203"><a href="#cb41-203"></a></span>
<span id="cb41-204"><a href="#cb41-204"></a>for some set of enrichment factors $r_{i}$. In the alternate model, the maximum likelihood estimator of the enrichment factors $r_{i}$ is the ratio of observed to expected gene multiplicities, $r_{i} = m_{i}/\overline{m}$. The net increase of the log-likelihood relative to the null model ($r_{i} = 1$) is then given by:</span>
<span id="cb41-205"><a href="#cb41-205"></a></span>
<span id="cb41-206"><a href="#cb41-206"></a>$$\Delta \ell = \sum_{i} n_{i} \log \left ( \frac{m_{i}}{\overline{m}} \right )$$ {#eq-03}</span>
<span id="cb41-207"><a href="#cb41-207"></a></span>
<span id="cb41-208"><a href="#cb41-208"></a>This likelihood ratio estimator is equivalent to the total G-score introduced in earlier work <span class="co">[</span><span class="ot">@tenaillon2016</span><span class="co">]</span>. Here we assess statistical significance using permutation tests following Shoemaker *et al.* <span class="co">[</span><span class="ot">@shoemaker2021</span><span class="co">]</span>. For permutations tests (n = 10,000) we randomly resample mutations to the observed $n_{tot}$ set size from each species using the multinomial distribution, where the probability of sampling a non-synonymous mutation at $gene_{i}$ was given by $p_{i} = {L_{i}} / {L_{tot}}$ where $L_{i}$ is the total number of nonsynonymous sites in $gene_{i}$ and $L_{tot}$ is the total number of nonsynonymous sites in the genome.</span>
<span id="cb41-209"><a href="#cb41-209"></a></span>
<span id="cb41-210"><a href="#cb41-210"></a>We next identify specific genes enriched for mutations following the criteria of Good *et. al* . <span class="co">[</span><span class="ot">@good2017</span><span class="co">]</span>. We calculate a \textit{p} value for each gene using the equation:</span>
<span id="cb41-211"><a href="#cb41-211"></a></span>
<span id="cb41-212"><a href="#cb41-212"></a>$$P_{i} = \sum_{n \geq n_{i}} \frac{ \left ( \frac{n_{tot} L_{i}}{ \overline{L} N_{genes}} \right )^{n}}{n!} e^{- \frac{n_{tot} L_{i} }{\overline{L} N_{genes}}}$$ {#eq-04}</span>
<span id="cb41-213"><a href="#cb41-213"></a></span>
<span id="cb41-214"><a href="#cb41-214"></a>Here we only consider genes with $n_{i} \geq 3$ to exclude low \textit{p} values driven primarily by gene length. Under the null hypothesis, the expected number of genes with $P_{i} \geq p$ can be found using a Poisson survival curve given by:</span>
<span id="cb41-215"><a href="#cb41-215"></a></span>
<span id="cb41-216"><a href="#cb41-216"></a>$$\overline{N}(P) \approx \sum_{i=1}^{N_{genes}} \sum_{n=3}^{\infty} \theta (P - P_{i}(n, L_{i}) \cdot \frac{ \left( \frac{n_{tot} L_{i}}{\overline{L} N_{genes}} \right)^{n}}{n!} e^{-\left( \frac{n_{tot} L_{i}}{\overline{L} N_{genes}} \right)}$$ {#eq-05}</span>
<span id="cb41-217"><a href="#cb41-217"></a></span>
<span id="cb41-218"><a href="#cb41-218"></a>We can compare this expected number to the observed number of genes $N(P)$ using a critical \textit{p} value ($P^{\ast}$) such that</span>
<span id="cb41-219"><a href="#cb41-219"></a></span>
<span id="cb41-220"><a href="#cb41-220"></a>$$\frac{\overline{N}(P^{\ast})}{N(P^{\ast})} \leq \alpha$$ {#eq-06}</span>
<span id="cb41-221"><a href="#cb41-221"></a></span>
<span id="cb41-222"><a href="#cb41-222"></a>for a given FDR $\alpha$ value of 0.05. For this value we then define the set of significantly enriched genes as:</span>
<span id="cb41-223"><a href="#cb41-223"></a></span>
<span id="cb41-224"><a href="#cb41-224"></a>$$I = \left<span class="sc">\{</span> i : P_{i} \leq P^{\ast} \left(\alpha \right) \right<span class="sc">\}</span>$$ {#eq-07}</span>
<span id="cb41-225"><a href="#cb41-225"></a></span>
<span id="cb41-226"><a href="#cb41-226"></a><span class="fu">## Prepare input data for non-syn mutations only</span></span>
<span id="cb41-227"><a href="#cb41-227"></a></span>
<span id="cb41-228"><a href="#cb41-228"></a></span>
<span id="cb41-231"><a href="#cb41-231"></a><span class="in">```{r}</span></span>
<span id="cb41-232"><a href="#cb41-232"></a>mgvars_filt_mb_ns <span class="ot">&lt;-</span> mgvars_filt_mb <span class="sc">%&gt;%</span> </span>
<span id="cb41-233"><a href="#cb41-233"></a>  <span class="co"># exclude intragenic, intergenic, and synonymous mutations. Also exclude</span></span>
<span id="cb41-234"><a href="#cb41-234"></a>  <span class="co"># fusion functions because these are weird and also rare. Excluding the</span></span>
<span id="cb41-235"><a href="#cb41-235"></a>  <span class="co"># modifier category also ensures that we filter out any tRNAs with mutations</span></span>
<span id="cb41-236"><a href="#cb41-236"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(effect, <span class="st">"intergenic|intragenic|synonymous|fusion"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-237"><a href="#cb41-237"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(impact, <span class="st">"MODIFIER"</span>)) </span>
<span id="cb41-238"><a href="#cb41-238"></a><span class="in">```</span></span>
<span id="cb41-239"><a href="#cb41-239"></a></span>
<span id="cb41-240"><a href="#cb41-240"></a><span class="fu">## G score</span></span>
<span id="cb41-241"><a href="#cb41-241"></a></span>
<span id="cb41-242"><a href="#cb41-242"></a>Warning! this takes some time</span>
<span id="cb41-243"><a href="#cb41-243"></a></span>
<span id="cb41-246"><a href="#cb41-246"></a><span class="in">```{r}</span></span>
<span id="cb41-247"><a href="#cb41-247"></a><span class="co">#| eval: false</span></span>
<span id="cb41-248"><a href="#cb41-248"></a><span class="co">#| echo: true</span></span>
<span id="cb41-249"><a href="#cb41-249"></a>muts_by_sp_treat <span class="ot">&lt;-</span> mgvars_filt_mb_ns <span class="sc">%&gt;%</span> </span>
<span id="cb41-250"><a href="#cb41-250"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(freq_alt_complete, time_days)) <span class="sc">%&gt;%</span></span>
<span id="cb41-251"><a href="#cb41-251"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-252"><a href="#cb41-252"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-253"><a href="#cb41-253"></a>  <span class="fu">mutate</span>(<span class="at">groupid =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb41-254"><a href="#cb41-254"></a>  <span class="fu">group_by</span>(groupid, strainID, prey_history, predator_history)</span>
<span id="cb41-255"><a href="#cb41-255"></a></span>
<span id="cb41-256"><a href="#cb41-256"></a><span class="co"># doing 10000 permutations</span></span>
<span id="cb41-257"><a href="#cb41-257"></a>result_sp_treat <span class="ot">&lt;-</span> <span class="fu">run_full_gene_parallelism_pipeline</span>(muts_by_sp_treat, degentab, <span class="dv">10000</span>)</span>
<span id="cb41-258"><a href="#cb41-258"></a></span>
<span id="cb41-259"><a href="#cb41-259"></a><span class="co"># Save this for later</span></span>
<span id="cb41-260"><a href="#cb41-260"></a><span class="fu">write_rds</span>(result_sp_treat, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"parallelism_results_sp_treat.rds"</span>))</span>
<span id="cb41-261"><a href="#cb41-261"></a><span class="in">```</span></span>
<span id="cb41-262"><a href="#cb41-262"></a></span>
<span id="cb41-265"><a href="#cb41-265"></a><span class="in">```{r}</span></span>
<span id="cb41-266"><a href="#cb41-266"></a><span class="co"># Read in previous results</span></span>
<span id="cb41-267"><a href="#cb41-267"></a>result_sp_treat <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"parallelism_results_sp_treat.rds"</span>))</span>
<span id="cb41-268"><a href="#cb41-268"></a><span class="in">```</span></span>
<span id="cb41-269"><a href="#cb41-269"></a></span>
<span id="cb41-270"><a href="#cb41-270"></a><span class="fu">### Simulating the number of replicates with a parallel gene hit</span></span>
<span id="cb41-271"><a href="#cb41-271"></a></span>
<span id="cb41-272"><a href="#cb41-272"></a>As another sanity check, we took the resamplings from the null distribution and calculated the number of replicates with a parallel gene hit (i.e. the same gene hit in $\geq 2$ experimental replicates) and compared that to the observed distribution. The null distribution reflected the process of sampling a mutation under a multinomial distribution with probability proportional to the total number of nonsynonymous sites $L_{i}$ in $gene_{i}$. We observed that in 9/16 cases the null distribution produced fewer parallel gene hits than observed in the data from 2 experimental replicates. In all 16 cases the null distribution produced fewer parallel gene hits than observed in the data from 3 experimental replicates. Thus, for some suspicious genes with very high mutational density (see below) we required these genes to be present in all three replicates to include them in our final significant gene lists.</span>
<span id="cb41-273"><a href="#cb41-273"></a></span>
<span id="cb41-274"><a href="#cb41-274"></a>::: {#fig-03}</span>
<span id="cb41-277"><a href="#cb41-277"></a><span class="in">```{r}</span></span>
<span id="cb41-278"><a href="#cb41-278"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb41-279"><a href="#cb41-279"></a><span class="co">#| fig.height: 8</span></span>
<span id="cb41-280"><a href="#cb41-280"></a><span class="co">#| echo: false</span></span>
<span id="cb41-281"><a href="#cb41-281"></a><span class="co">#| warning: false</span></span>
<span id="cb41-282"><a href="#cb41-282"></a><span class="fu">plot_sims</span>(result_sp_treat, <span class="dv">1</span>)</span>
<span id="cb41-283"><a href="#cb41-283"></a><span class="in">```</span></span>
<span id="cb41-284"><a href="#cb41-284"></a></span>
<span id="cb41-285"><a href="#cb41-285"></a>Number of genes (y axis) with nonsynonymous mutation hits in $N_{replicates} = <span class="sc">\{</span>n : 1 \leq n \leq 3<span class="sc">\}</span>$ (x axis). Blue bars depict the distribution observed in the data, while red bars depict the null distribution from resampling mutations to the observed $n_{tot}$ set size from each species using the multinomial distribution, where the probability of sampling a non-synonymous mutation at $gene_{i}$ was dependent only on the number of nonsynonymous sites in the gene.</span>
<span id="cb41-286"><a href="#cb41-286"></a>:::</span>
<span id="cb41-287"><a href="#cb41-287"></a></span>
<span id="cb41-288"><a href="#cb41-288"></a><span class="fu">### Visualize the survival curves for each treatment combination</span></span>
<span id="cb41-289"><a href="#cb41-289"></a></span>
<span id="cb41-292"><a href="#cb41-292"></a><span class="in">```{r}</span></span>
<span id="cb41-293"><a href="#cb41-293"></a>survcurv <span class="ot">&lt;-</span> result_sp_treat<span class="sc">$</span>output_df2plot <span class="sc">%&gt;%</span> </span>
<span id="cb41-294"><a href="#cb41-294"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(xend)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-295"><a href="#cb41-295"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste</span>(strainID, <span class="st">"prey:"</span>, prey_history, <span class="st">"</span><span class="sc">\n</span><span class="st">predator:"</span>, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-296"><a href="#cb41-296"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb41-297"><a href="#cb41-297"></a>    <span class="fu">geom_segment</span>(</span>
<span id="cb41-298"><a href="#cb41-298"></a>      <span class="fu">aes</span>(</span>
<span id="cb41-299"><a href="#cb41-299"></a>        <span class="at">x =</span> x,</span>
<span id="cb41-300"><a href="#cb41-300"></a>        <span class="at">y =</span> y,</span>
<span id="cb41-301"><a href="#cb41-301"></a>        <span class="at">xend =</span> xend,</span>
<span id="cb41-302"><a href="#cb41-302"></a>        <span class="at">yend =</span> yend</span>
<span id="cb41-303"><a href="#cb41-303"></a>      ),</span>
<span id="cb41-304"><a href="#cb41-304"></a>      <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb41-305"><a href="#cb41-305"></a>      <span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb41-306"><a href="#cb41-306"></a>    ) <span class="sc">+</span></span>
<span id="cb41-307"><a href="#cb41-307"></a>    <span class="fu">geom_step</span>( <span class="fu">aes</span>(<span class="at">x =</span> obs_p, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb41-308"><a href="#cb41-308"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb41-309"><a href="#cb41-309"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(<span class="st">"$-log_{10}P$"</span>), <span class="at">y =</span> <span class="st">"Number of genes"</span>) <span class="sc">+</span></span>
<span id="cb41-310"><a href="#cb41-310"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"grey50"</span>)) <span class="sc">+</span></span>
<span id="cb41-311"><a href="#cb41-311"></a>    <span class="fu">scale_y_log10</span>(</span>
<span id="cb41-312"><a href="#cb41-312"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>),</span>
<span id="cb41-313"><a href="#cb41-313"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">"log10"</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span> <span class="sc">^</span>.x))</span>
<span id="cb41-314"><a href="#cb41-314"></a>    ) <span class="sc">+</span></span>
<span id="cb41-315"><a href="#cb41-315"></a>    <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"l"</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb41-316"><a href="#cb41-316"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb41-317"><a href="#cb41-317"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-318"><a href="#cb41-318"></a>    <span class="fu">theme</span>(</span>
<span id="cb41-319"><a href="#cb41-319"></a>      <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-320"><a href="#cb41-320"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-321"><a href="#cb41-321"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb41-322"><a href="#cb41-322"></a>    )</span>
<span id="cb41-323"><a href="#cb41-323"></a><span class="in">```</span></span>
<span id="cb41-324"><a href="#cb41-324"></a></span>
<span id="cb41-325"><a href="#cb41-325"></a>::: {#fig-04}</span>
<span id="cb41-328"><a href="#cb41-328"></a><span class="in">```{r}</span></span>
<span id="cb41-329"><a href="#cb41-329"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb41-330"><a href="#cb41-330"></a><span class="co">#| fig.height: 8</span></span>
<span id="cb41-331"><a href="#cb41-331"></a><span class="co">#| echo: false</span></span>
<span id="cb41-332"><a href="#cb41-332"></a><span class="co">#| warning: false</span></span>
<span id="cb41-333"><a href="#cb41-333"></a>survcurv</span>
<span id="cb41-334"><a href="#cb41-334"></a><span class="in">```</span></span>
<span id="cb41-335"><a href="#cb41-335"></a></span>
<span id="cb41-336"><a href="#cb41-336"></a>The observed $(N)$ (blue line) and expected number $(\overline{N})$ (grey line) of genes with $P_{i} \leq P$, as a function of $P$. The red dashed line denotes the genome-wide significance threshold $P^{*}$ for $\alpha = 0.05$ defined in Equation @eq-06.</span>
<span id="cb41-337"><a href="#cb41-337"></a>:::</span>
<span id="cb41-338"><a href="#cb41-338"></a></span>
<span id="cb41-339"><a href="#cb41-339"></a></span>
<span id="cb41-340"><a href="#cb41-340"></a><span class="fu">### Overall G scores</span></span>
<span id="cb41-343"><a href="#cb41-343"></a><span class="in">```{r}</span></span>
<span id="cb41-344"><a href="#cb41-344"></a>result_sp_treat<span class="sc">$</span>output_gscore <span class="sc">%&gt;%</span> </span>
<span id="cb41-345"><a href="#cb41-345"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb41-346"><a href="#cb41-346"></a><span class="in">```</span></span>
<span id="cb41-347"><a href="#cb41-347"></a></span>
<span id="cb41-348"><a href="#cb41-348"></a><span class="fu">### Inspecting individual genes</span></span>
<span id="cb41-349"><a href="#cb41-349"></a></span>
<span id="cb41-350"><a href="#cb41-350"></a>Some genes tend to have a large number of consecutive mutations which is probably due to incorrect read mapping and not real mutations so we will try and filter these out. We'll do this by filtering on genes with a mutational density $d_{g} \gt 0.15$, where the mutational density in gene $g$ was defined as</span>
<span id="cb41-351"><a href="#cb41-351"></a></span>
<span id="cb41-352"><a href="#cb41-352"></a>$$d_{g} = \frac{|A|_{g}}{b_{g} - a_{g}}$$</span>
<span id="cb41-353"><a href="#cb41-353"></a></span>
<span id="cb41-354"><a href="#cb41-354"></a>for all genome positions $x$ on the interval $<span class="sc">\{</span>x | a_{g} \leq x \leq b_{g}<span class="sc">\}</span>$ where $b_{g}$ is the greatest position and $a_{g}$ is the smallest position of observed mutations in gene $g$ and $|A|_{g}$ is the cardinality of the mutation set.</span>
<span id="cb41-355"><a href="#cb41-355"></a></span>
<span id="cb41-358"><a href="#cb41-358"></a><span class="in">```{r}</span></span>
<span id="cb41-359"><a href="#cb41-359"></a>high_density_genes <span class="ot">&lt;-</span> mgvars_filt_mb_ns <span class="sc">%&gt;%</span> </span>
<span id="cb41-360"><a href="#cb41-360"></a>  <span class="fu">group_by</span>(strainID, locus_tag, replicate, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-361"><a href="#cb41-361"></a>  <span class="fu">mutate</span>(<span class="at">mutwindox =</span> pos <span class="sc">-</span> <span class="fu">lag</span>(pos),</span>
<span id="cb41-362"><a href="#cb41-362"></a>         <span class="at">mut_num =</span> <span class="fu">n</span>(),</span>
<span id="cb41-363"><a href="#cb41-363"></a>         <span class="at">mut_dens =</span> <span class="fu">n</span>()<span class="sc">/</span>(<span class="fu">max</span>(pos) <span class="sc">-</span>  <span class="fu">min</span>(pos))) <span class="sc">%&gt;%</span> </span>
<span id="cb41-364"><a href="#cb41-364"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-365"><a href="#cb41-365"></a>  <span class="fu">filter</span>(mut_dens <span class="sc">!=</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-366"><a href="#cb41-366"></a>  <span class="fu">filter</span>(mut_dens <span class="sc">&gt;</span> <span class="fl">0.15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-367"><a href="#cb41-367"></a>  <span class="fu">distinct</span>(locus_tag) <span class="sc">%&gt;%</span> </span>
<span id="cb41-368"><a href="#cb41-368"></a>  <span class="fu">pull</span>()</span>
<span id="cb41-369"><a href="#cb41-369"></a><span class="in">```</span></span>
<span id="cb41-370"><a href="#cb41-370"></a></span>
<span id="cb41-373"><a href="#cb41-373"></a><span class="in">```{r}</span></span>
<span id="cb41-374"><a href="#cb41-374"></a>output_gene_table_filt <span class="ot">&lt;-</span> result_sp_treat<span class="sc">$</span>output_gene_table <span class="sc">%&gt;%</span> </span>
<span id="cb41-375"><a href="#cb41-375"></a>  <span class="co"># only genes exceeding the critical pstar value from the survival curves above</span></span>
<span id="cb41-376"><a href="#cb41-376"></a>  <span class="fu">filter</span>(neg_log10P <span class="sc">&gt;=</span> pstar) <span class="sc">%&gt;%</span> </span>
<span id="cb41-377"><a href="#cb41-377"></a>  <span class="co"># only include genes with at least 3 hits in the same gene or found in more than one replicate.</span></span>
<span id="cb41-378"><a href="#cb41-378"></a>  <span class="fu">filter</span>(observed_hits_n_i <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">|</span> n_replicate <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-379"><a href="#cb41-379"></a>  <span class="co"># filters out the problematic genes above unless the number of replicates detected is 2 or more</span></span>
<span id="cb41-380"><a href="#cb41-380"></a>  <span class="fu">filter</span>(<span class="fu">case_when</span>(n_replicate <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="sc">!</span>(locus_tag <span class="sc">%in%</span> high_density_genes), </span>
<span id="cb41-381"><a href="#cb41-381"></a>                   <span class="cn">TRUE</span> <span class="sc">~</span> n_replicate <span class="sc">&gt;</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-382"><a href="#cb41-382"></a>  <span class="fu">left_join</span>(annotations, <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID))</span>
<span id="cb41-383"><a href="#cb41-383"></a><span class="in">```</span></span>
<span id="cb41-384"><a href="#cb41-384"></a></span>
<span id="cb41-385"><a href="#cb41-385"></a><span class="fu"># Convergent/divergent evolution</span></span>
<span id="cb41-386"><a href="#cb41-386"></a></span>
<span id="cb41-387"><a href="#cb41-387"></a>So now we have a list of enriched genes for each condition. We can see that, for example, "H0403_00778" occurs in the significant hit lists of multiple conditions. Now we would like to determine whether a significant gene popping up in these multiple conditions happens more than would be expected by chance.</span>
<span id="cb41-388"><a href="#cb41-388"></a></span>
<span id="cb41-389"><a href="#cb41-389"></a><span class="fu">## Jaccard Index for convergence between treatments</span></span>
<span id="cb41-390"><a href="#cb41-390"></a></span>
<span id="cb41-391"><a href="#cb41-391"></a>We follow the same approach as in <span class="co">[</span><span class="ot">@shoemaker2021</span><span class="co">]</span> where we simulate the process of randomly sampling $n = 100,000$ draws of significant gene set pairs $(I_{i},I_{j})$ from every species $\times$ treatment pair where the probability of sampling a gene is proportional to its length. We then calculate the Jaccard index</span>
<span id="cb41-392"><a href="#cb41-392"></a></span>
<span id="cb41-393"><a href="#cb41-393"></a>$$J(I_{i},I_{j}) = \left|I_{i} \cap I_{j}\right|/ \left|I_{i} \cup I_{j}\right|$$ for each null simulation $J(I_{i},I_{j})_{null}$ and calculate an empirical $P$ value for the number of null simulation results exceeding the observed $J(I_{i},I_{j})_{observed}$ to determine whether the intersection of the set of genes was greater (convergence) or less than (divergence) expected by chance.</span>
<span id="cb41-394"><a href="#cb41-394"></a></span>
<span id="cb41-395"><a href="#cb41-395"></a><span class="fu">### HAMBI_1287</span></span>
<span id="cb41-396"><a href="#cb41-396"></a></span>
<span id="cb41-399"><a href="#cb41-399"></a><span class="in">```{r}</span></span>
<span id="cb41-400"><a href="#cb41-400"></a><span class="co">#| eval: false</span></span>
<span id="cb41-401"><a href="#cb41-401"></a><span class="co">#| echo: true</span></span>
<span id="cb41-402"><a href="#cb41-402"></a>H1287_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb41-403"><a href="#cb41-403"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb41-404"><a href="#cb41-404"></a>                                                     <span class="st">"HAMBI_1287"</span>, prey_history, predator_history)</span>
<span id="cb41-405"><a href="#cb41-405"></a>                               )</span>
<span id="cb41-406"><a href="#cb41-406"></a></span>
<span id="cb41-407"><a href="#cb41-407"></a><span class="fu">write_rds</span>(H1287_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1287_cvdv.rds"</span>))</span>
<span id="cb41-408"><a href="#cb41-408"></a><span class="in">```</span></span>
<span id="cb41-409"><a href="#cb41-409"></a></span>
<span id="cb41-412"><a href="#cb41-412"></a><span class="in">```{r}</span></span>
<span id="cb41-413"><a href="#cb41-413"></a><span class="co">#| eval: true</span></span>
<span id="cb41-414"><a href="#cb41-414"></a><span class="co">#| echo: false</span></span>
<span id="cb41-415"><a href="#cb41-415"></a><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1287_cvdv.rds"</span>))</span>
<span id="cb41-416"><a href="#cb41-416"></a><span class="in">```</span></span>
<span id="cb41-417"><a href="#cb41-417"></a></span>
<span id="cb41-418"><a href="#cb41-418"></a><span class="fu">### HAMBI_1972</span></span>
<span id="cb41-419"><a href="#cb41-419"></a></span>
<span id="cb41-422"><a href="#cb41-422"></a><span class="in">```{r}</span></span>
<span id="cb41-423"><a href="#cb41-423"></a><span class="co">#| eval: false</span></span>
<span id="cb41-424"><a href="#cb41-424"></a><span class="co">#| echo: true</span></span>
<span id="cb41-425"><a href="#cb41-425"></a>H1972_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb41-426"><a href="#cb41-426"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb41-427"><a href="#cb41-427"></a>                                                     <span class="st">"HAMBI_1972"</span>, prey_history, predator_history)</span>
<span id="cb41-428"><a href="#cb41-428"></a>                               )</span>
<span id="cb41-429"><a href="#cb41-429"></a></span>
<span id="cb41-430"><a href="#cb41-430"></a><span class="fu">write_rds</span>(H1972_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1972_cvdv.rds"</span>))</span>
<span id="cb41-431"><a href="#cb41-431"></a><span class="in">```</span></span>
<span id="cb41-432"><a href="#cb41-432"></a></span>
<span id="cb41-435"><a href="#cb41-435"></a><span class="in">```{r}</span></span>
<span id="cb41-436"><a href="#cb41-436"></a><span class="co">#| eval: true</span></span>
<span id="cb41-437"><a href="#cb41-437"></a><span class="co">#| echo: false</span></span>
<span id="cb41-438"><a href="#cb41-438"></a><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1972_cvdv.rds"</span>))</span>
<span id="cb41-439"><a href="#cb41-439"></a><span class="in">```</span></span>
<span id="cb41-440"><a href="#cb41-440"></a></span>
<span id="cb41-441"><a href="#cb41-441"></a><span class="fu">### HAMBI_1977</span></span>
<span id="cb41-442"><a href="#cb41-442"></a></span>
<span id="cb41-445"><a href="#cb41-445"></a><span class="in">```{r}</span></span>
<span id="cb41-446"><a href="#cb41-446"></a><span class="co">#| eval: false</span></span>
<span id="cb41-447"><a href="#cb41-447"></a><span class="co">#| echo: true</span></span>
<span id="cb41-448"><a href="#cb41-448"></a>H1977_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb41-449"><a href="#cb41-449"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb41-450"><a href="#cb41-450"></a>                                                     <span class="st">"HAMBI_1977"</span>, prey_history, predator_history)</span>
<span id="cb41-451"><a href="#cb41-451"></a>                               )</span>
<span id="cb41-452"><a href="#cb41-452"></a></span>
<span id="cb41-453"><a href="#cb41-453"></a><span class="fu">write_rds</span>(H1977_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1977_cvdv.rds"</span>))</span>
<span id="cb41-454"><a href="#cb41-454"></a><span class="in">```</span></span>
<span id="cb41-455"><a href="#cb41-455"></a></span>
<span id="cb41-458"><a href="#cb41-458"></a><span class="in">```{r}</span></span>
<span id="cb41-459"><a href="#cb41-459"></a><span class="co">#| eval: true</span></span>
<span id="cb41-460"><a href="#cb41-460"></a><span class="co">#| echo: false</span></span>
<span id="cb41-461"><a href="#cb41-461"></a><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H1977_cvdv.rds"</span>))</span>
<span id="cb41-462"><a href="#cb41-462"></a><span class="in">```</span></span>
<span id="cb41-463"><a href="#cb41-463"></a></span>
<span id="cb41-464"><a href="#cb41-464"></a><span class="fu">### HAMBI_2659</span></span>
<span id="cb41-465"><a href="#cb41-465"></a></span>
<span id="cb41-468"><a href="#cb41-468"></a><span class="in">```{r}</span></span>
<span id="cb41-469"><a href="#cb41-469"></a><span class="co">#| eval: false</span></span>
<span id="cb41-470"><a href="#cb41-470"></a><span class="co">#| echo: true</span></span>
<span id="cb41-471"><a href="#cb41-471"></a>H2659_cvdv <span class="ot">&lt;-</span> <span class="fu">resample_jaccard</span>(<span class="dv">100000</span>, </span>
<span id="cb41-472"><a href="#cb41-472"></a>                               <span class="fu">prep4jaccard_resample</span>(output_gene_table_filt, degentab, </span>
<span id="cb41-473"><a href="#cb41-473"></a>                                                     <span class="st">"HAMBI_2659"</span>, prey_history, predator_history)</span>
<span id="cb41-474"><a href="#cb41-474"></a>                               )</span>
<span id="cb41-475"><a href="#cb41-475"></a></span>
<span id="cb41-476"><a href="#cb41-476"></a><span class="fu">write_rds</span>(H2659_cvdv, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H2659_cvdv.rds"</span>))</span>
<span id="cb41-477"><a href="#cb41-477"></a><span class="in">```</span></span>
<span id="cb41-478"><a href="#cb41-478"></a></span>
<span id="cb41-481"><a href="#cb41-481"></a><span class="in">```{r}</span></span>
<span id="cb41-482"><a href="#cb41-482"></a><span class="co">#| eval: true</span></span>
<span id="cb41-483"><a href="#cb41-483"></a><span class="co">#| echo: false</span></span>
<span id="cb41-484"><a href="#cb41-484"></a><span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"jaccard_H2659_cvdv.rds"</span>))</span>
<span id="cb41-485"><a href="#cb41-485"></a><span class="in">```</span></span>
<span id="cb41-486"><a href="#cb41-486"></a></span>
<span id="cb41-487"><a href="#cb41-487"></a><span class="fu">## Enrichment of individual COG categories</span></span>
<span id="cb41-488"><a href="#cb41-488"></a></span>
<span id="cb41-489"><a href="#cb41-489"></a>So now we have a list of enriched genes for each species. We can see that, for example, some gene functions pop up multiple times (like transcription factors and sensory kinases). Are these different functions popping up across species more that we would expect by chance? We'll try and test this using a simulation based approach</span>
<span id="cb41-490"><a href="#cb41-490"></a></span>
<span id="cb41-493"><a href="#cb41-493"></a><span class="in">```{r}</span></span>
<span id="cb41-494"><a href="#cb41-494"></a><span class="co">#| output: false</span></span>
<span id="cb41-495"><a href="#cb41-495"></a><span class="co"># read back the formatted eggnog data</span></span>
<span id="cb41-496"><a href="#cb41-496"></a>eggnog <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(here<span class="sc">::</span><span class="fu">here</span>(shared, <span class="st">"HAMBI_all_eggnog_formatted.tsv.xz"</span>))</span>
<span id="cb41-497"><a href="#cb41-497"></a><span class="in">```</span></span>
<span id="cb41-498"><a href="#cb41-498"></a></span>
<span id="cb41-501"><a href="#cb41-501"></a><span class="in">```{r}</span></span>
<span id="cb41-502"><a href="#cb41-502"></a>cog_description <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb41-503"><a href="#cb41-503"></a>  <span class="sc">~</span>COG_category_single,                                                  <span class="sc">~</span>COG_category_long,</span>
<span id="cb41-504"><a href="#cb41-504"></a>            <span class="st">"J"</span>,               <span class="st">"J - Translation, ribosomal structure and biogenesis"</span>,</span>
<span id="cb41-505"><a href="#cb41-505"></a>            <span class="st">"A"</span>,                               <span class="st">"A - RNA processing and modification"</span>,</span>
<span id="cb41-506"><a href="#cb41-506"></a>            <span class="st">"K"</span>,                                                 <span class="st">"K  Transcription"</span>,</span>
<span id="cb41-507"><a href="#cb41-507"></a>            <span class="st">"L"</span>,                         <span class="st">"L - Replication, recombination and repair"</span>,</span>
<span id="cb41-508"><a href="#cb41-508"></a>            <span class="st">"B"</span>,                              <span class="st">"B - Chromatin structure and dynamics"</span>,</span>
<span id="cb41-509"><a href="#cb41-509"></a>            <span class="st">"D"</span>,    <span class="st">"D - Cell cycle control, cell division, chromosome partitioning"</span>,</span>
<span id="cb41-510"><a href="#cb41-510"></a>            <span class="st">"Y"</span>,                                             <span class="st">"Y - Nuclear structure"</span>,</span>
<span id="cb41-511"><a href="#cb41-511"></a>            <span class="st">"V"</span>,                                            <span class="st">"V - Defense mechanisms"</span>,</span>
<span id="cb41-512"><a href="#cb41-512"></a>            <span class="st">"T"</span>,                                <span class="st">"T - Signal transduction mechanisms"</span>,</span>
<span id="cb41-513"><a href="#cb41-513"></a>            <span class="st">"M"</span>,                        <span class="st">"M - Cell wall/membrane/envelope biogenesis"</span>,</span>
<span id="cb41-514"><a href="#cb41-514"></a>            <span class="st">"N"</span>,                                                 <span class="st">"N - Cell motility"</span>,</span>
<span id="cb41-515"><a href="#cb41-515"></a>            <span class="st">"Z"</span>,                                                  <span class="st">"Z  Cytoskeleton"</span>,</span>
<span id="cb41-516"><a href="#cb41-516"></a>            <span class="st">"W"</span>,                                      <span class="st">"W - Extracellular structures"</span>,</span>
<span id="cb41-517"><a href="#cb41-517"></a>            <span class="st">"U"</span>, <span class="st">"U - Intracellular trafficking, secretion, and vesicular transport"</span>,</span>
<span id="cb41-518"><a href="#cb41-518"></a>            <span class="st">"O"</span>,  <span class="st">"O - Posttranslational modification, protein turnover, chaperones"</span>,</span>
<span id="cb41-519"><a href="#cb41-519"></a>            <span class="st">"X"</span>,                              <span class="st">"X - Mobilome: prophages, transposons"</span>,</span>
<span id="cb41-520"><a href="#cb41-520"></a>            <span class="st">"C"</span>,                              <span class="st">"C - Energy production and conversion"</span>,</span>
<span id="cb41-521"><a href="#cb41-521"></a>            <span class="st">"G"</span>,                         <span class="st">"G - Carbohydrate transport and metabolism"</span>,</span>
<span id="cb41-522"><a href="#cb41-522"></a>            <span class="st">"E"</span>,                           <span class="st">"E - Amino acid transport and metabolism"</span>,</span>
<span id="cb41-523"><a href="#cb41-523"></a>            <span class="st">"F"</span>,                           <span class="st">"F - Nucleotide transport and metabolism"</span>,</span>
<span id="cb41-524"><a href="#cb41-524"></a>            <span class="st">"H"</span>,                             <span class="st">"H - Coenzyme transport and metabolism"</span>,</span>
<span id="cb41-525"><a href="#cb41-525"></a>            <span class="st">"I"</span>,                                <span class="st">"I - Lipid transport and metabolism"</span>,</span>
<span id="cb41-526"><a href="#cb41-526"></a>            <span class="st">"P"</span>,                        <span class="st">"P - Inorganic ion transport and metabolism"</span>,</span>
<span id="cb41-527"><a href="#cb41-527"></a>            <span class="st">"Q"</span>,  <span class="st">"Q - Secondary metabolites biosynthesis, transport and catabolism"</span>,</span>
<span id="cb41-528"><a href="#cb41-528"></a>            <span class="st">"R"</span>,                              <span class="st">"R - General function prediction only"</span>,</span>
<span id="cb41-529"><a href="#cb41-529"></a>            <span class="st">"S"</span>,                                              <span class="st">"S - Function unknown"</span></span>
<span id="cb41-530"><a href="#cb41-530"></a>  )</span>
<span id="cb41-531"><a href="#cb41-531"></a><span class="in">```</span></span>
<span id="cb41-532"><a href="#cb41-532"></a></span>
<span id="cb41-533"><a href="#cb41-533"></a>save a copy of significantly parallel genes as a table</span>
<span id="cb41-534"><a href="#cb41-534"></a></span>
<span id="cb41-537"><a href="#cb41-537"></a><span class="in">```{r}</span></span>
<span id="cb41-538"><a href="#cb41-538"></a>output_gene_table_filt_cog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog) <span class="sc">%&gt;%</span> </span>
<span id="cb41-539"><a href="#cb41-539"></a>  <span class="fu">rename</span>(<span class="at">prokka_annotation =</span> product) <span class="sc">%&gt;%</span> </span>
<span id="cb41-540"><a href="#cb41-540"></a>  <span class="fu">relocate</span>(strainID, prey_history, predator_history, COG_category_long, Preferred_name, Description, prokka_annotation)</span>
<span id="cb41-541"><a href="#cb41-541"></a></span>
<span id="cb41-542"><a href="#cb41-542"></a><span class="fu">write_tsv</span>(output_gene_table_filt_cog, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"enriched_parallel_genes.tsv"</span>))</span>
<span id="cb41-543"><a href="#cb41-543"></a></span>
<span id="cb41-544"><a href="#cb41-544"></a>output_gene_table_filt_cog</span>
<span id="cb41-545"><a href="#cb41-545"></a><span class="in">```</span></span>
<span id="cb41-546"><a href="#cb41-546"></a></span>
<span id="cb41-547"><a href="#cb41-547"></a>Calculate the probability of each gene (ns_sites/total_ns_sites) and link to COG categories</span>
<span id="cb41-548"><a href="#cb41-548"></a></span>
<span id="cb41-551"><a href="#cb41-551"></a><span class="in">```{r}</span></span>
<span id="cb41-552"><a href="#cb41-552"></a>eggnog_nslen <span class="ot">&lt;-</span> <span class="fu">left_join</span>(eggnog, degentab,</span>
<span id="cb41-553"><a href="#cb41-553"></a>                          <span class="at">by =</span> <span class="fu">join_by</span>(strainID, locus_tag)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-554"><a href="#cb41-554"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(strainID, locus_tag, COG_category_single, ns_length) <span class="sc">%&gt;%</span> </span>
<span id="cb41-555"><a href="#cb41-555"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-556"><a href="#cb41-556"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb41-557"><a href="#cb41-557"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> ns_length<span class="sc">/</span><span class="fu">sum</span>(ns_length), </span>
<span id="cb41-558"><a href="#cb41-558"></a>         <span class="at">cog_genes =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-559"><a href="#cb41-559"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-560"><a href="#cb41-560"></a><span class="in">```</span></span>
<span id="cb41-561"><a href="#cb41-561"></a></span>
<span id="cb41-562"><a href="#cb41-562"></a><span class="fu">### Jensen Shannon Divergence</span></span>
<span id="cb41-563"><a href="#cb41-563"></a></span>
<span id="cb41-564"><a href="#cb41-564"></a>This function draws n genes from each species with a probability proportional to gene length, where n = the number of significant parallel genes observed from the data. We repeat this simulation 10 000 times and below we check if 1) the Jensen Shannon divergence between the distribution of the COG categories drawn randomly and the background (i.e., the distribution of COG categories in the whole genome) is greater than the Jensen Shannon divergence between the background and the observed distribution of COG categories in significantly parallel genes. The idea is that if some COG categories are enriched/depleted in the parallel genes, then the JSD divergence between the observed and the background should be larger than the JSD between the random sampled genes (sampling probability based only on gene length) and the background. We calculate an empirical P value by "counting" how many times the simulated JSD exceeds the observed.</span>
<span id="cb41-565"><a href="#cb41-565"></a></span>
<span id="cb41-568"><a href="#cb41-568"></a><span class="in">```{r}</span></span>
<span id="cb41-569"><a href="#cb41-569"></a><span class="co">#| eval: false</span></span>
<span id="cb41-570"><a href="#cb41-570"></a><span class="co">#| echo: true</span></span>
<span id="cb41-571"><a href="#cb41-571"></a>gene_nest <span class="ot">&lt;-</span> output_gene_table_filt <span class="sc">%&gt;%</span></span>
<span id="cb41-572"><a href="#cb41-572"></a>    <span class="fu">summarize</span>(<span class="at">nsiggenes =</span> <span class="fu">n</span>(), <span class="at">.by =</span> <span class="fu">c</span>(strainID, prey_history, predator_history)) <span class="sc">%&gt;%</span></span>
<span id="cb41-573"><a href="#cb41-573"></a>    <span class="fu">left_join</span>(eggnog_nslen,</span>
<span id="cb41-574"><a href="#cb41-574"></a>              <span class="at">by =</span> <span class="fu">join_by</span>(strainID),</span>
<span id="cb41-575"><a href="#cb41-575"></a>              <span class="at">relationship =</span> <span class="st">"many-to-many"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-576"><a href="#cb41-576"></a>    <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span><span class="fu">c</span>(strainID, prey_history, predator_history))</span>
<span id="cb41-577"><a href="#cb41-577"></a></span>
<span id="cb41-578"><a href="#cb41-578"></a>gene_draw <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb41-579"><a href="#cb41-579"></a>  gene_nest <span class="sc">%&gt;%</span></span>
<span id="cb41-580"><a href="#cb41-580"></a>    <span class="fu">mutate</span>(<span class="at">locus_tag =</span> <span class="fu">map</span>(</span>
<span id="cb41-581"><a href="#cb41-581"></a>      data,</span>
<span id="cb41-582"><a href="#cb41-582"></a>      \(x) <span class="fu">sample</span>(</span>
<span id="cb41-583"><a href="#cb41-583"></a>        <span class="at">x =</span> x<span class="sc">$</span>locus_tag,</span>
<span id="cb41-584"><a href="#cb41-584"></a>        <span class="at">size =</span> <span class="fu">unique</span>(x<span class="sc">$</span>nsiggenes),</span>
<span id="cb41-585"><a href="#cb41-585"></a>        <span class="at">prob =</span> x<span class="sc">$</span>p,</span>
<span id="cb41-586"><a href="#cb41-586"></a>        <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb41-587"><a href="#cb41-587"></a>      )</span>
<span id="cb41-588"><a href="#cb41-588"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb41-589"><a href="#cb41-589"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>data) <span class="sc">%&gt;%</span></span>
<span id="cb41-590"><a href="#cb41-590"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> locus_tag) </span>
<span id="cb41-591"><a href="#cb41-591"></a>}</span>
<span id="cb41-592"><a href="#cb41-592"></a></span>
<span id="cb41-593"><a href="#cb41-593"></a><span class="co"># take 10 000 random draws of the genes. Use a seed for reproducibility</span></span>
<span id="cb41-594"><a href="#cb41-594"></a>withr<span class="sc">::</span><span class="fu">with_seed</span>(<span class="dv">12367</span>,</span>
<span id="cb41-595"><a href="#cb41-595"></a>                 genes_simulated <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="sc">~</span><span class="fu">gene_draw</span>(), <span class="at">.progress=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-596"><a href="#cb41-596"></a>                   <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"id"</span>))</span>
<span id="cb41-597"><a href="#cb41-597"></a></span>
<span id="cb41-598"><a href="#cb41-598"></a><span class="co"># save the output so we don't need to run again</span></span>
<span id="cb41-599"><a href="#cb41-599"></a><span class="fu">write_rds</span>(genes_simulated, here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"genes_simulated_nomobile.rds"</span>))</span>
<span id="cb41-600"><a href="#cb41-600"></a><span class="in">```</span></span>
<span id="cb41-601"><a href="#cb41-601"></a></span>
<span id="cb41-602"><a href="#cb41-602"></a>Some data formatting</span>
<span id="cb41-603"><a href="#cb41-603"></a></span>
<span id="cb41-606"><a href="#cb41-606"></a><span class="in">```{r}</span></span>
<span id="cb41-607"><a href="#cb41-607"></a><span class="co"># read data back</span></span>
<span id="cb41-608"><a href="#cb41-608"></a>genes_simulated <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(data, <span class="st">"genes_simulated_nomobile.rds"</span>))</span>
<span id="cb41-609"><a href="#cb41-609"></a></span>
<span id="cb41-610"><a href="#cb41-610"></a><span class="co"># map the locus_tags to COG categories for the simulated</span></span>
<span id="cb41-611"><a href="#cb41-611"></a><span class="co"># gene draws</span></span>
<span id="cb41-612"><a href="#cb41-612"></a>COGs_distribution_simulated <span class="ot">&lt;-</span> genes_simulated <span class="sc">%&gt;%</span></span>
<span id="cb41-613"><a href="#cb41-613"></a>  <span class="fu">left_join</span>(eggnog_nslen, <span class="at">by =</span> <span class="fu">join_by</span>(strainID, locus_tag)) <span class="sc">%&gt;%</span></span>
<span id="cb41-614"><a href="#cb41-614"></a>  <span class="fu">group_by</span>(id, strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-615"><a href="#cb41-615"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"nsim"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-616"><a href="#cb41-616"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-617"><a href="#cb41-617"></a></span>
<span id="cb41-618"><a href="#cb41-618"></a><span class="co"># get the discrete distribution of COGs in the significant parallel genes</span></span>
<span id="cb41-619"><a href="#cb41-619"></a>COGs_distribution_observed <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb41-620"><a href="#cb41-620"></a>                                        <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-621"><a href="#cb41-621"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-622"><a href="#cb41-622"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"nobs"</span>) </span>
<span id="cb41-623"><a href="#cb41-623"></a></span>
<span id="cb41-624"><a href="#cb41-624"></a><span class="co"># get the discrete distribution of COGs across the whole genome of all species</span></span>
<span id="cb41-625"><a href="#cb41-625"></a><span class="co"># this is the null case (i.e. the background that we would expect if there was no</span></span>
<span id="cb41-626"><a href="#cb41-626"></a><span class="co"># enrichment)</span></span>
<span id="cb41-627"><a href="#cb41-627"></a>COGs_distribution_nullexpectation <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb41-628"><a href="#cb41-628"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb41-629"><a href="#cb41-629"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"nnull"</span>) </span>
<span id="cb41-630"><a href="#cb41-630"></a><span class="in">```</span></span>
<span id="cb41-631"><a href="#cb41-631"></a></span>
<span id="cb41-632"><a href="#cb41-632"></a>Now we calculate the Jensen Shannon divergence between the background and the simulated data to estimate an empirical P value</span>
<span id="cb41-633"><a href="#cb41-633"></a></span>
<span id="cb41-636"><a href="#cb41-636"></a><span class="in">```{r}</span></span>
<span id="cb41-637"><a href="#cb41-637"></a><span class="co"># function to calculate the Jensen Shannon divergene of a pair of</span></span>
<span id="cb41-638"><a href="#cb41-638"></a><span class="co"># distributions</span></span>
<span id="cb41-639"><a href="#cb41-639"></a>JSD_pair <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q){</span>
<span id="cb41-640"><a href="#cb41-640"></a>  m <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> (p <span class="sc">+</span> q)</span>
<span id="cb41-641"><a href="#cb41-641"></a>  JS <span class="ot">&lt;-</span>  <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p<span class="sc">/</span>m)) <span class="sc">+</span> <span class="fu">sum</span>(q <span class="sc">*</span> <span class="fu">log</span>(q<span class="sc">/</span>m)))</span>
<span id="cb41-642"><a href="#cb41-642"></a>  <span class="fu">return</span>(JS)</span>
<span id="cb41-643"><a href="#cb41-643"></a>}</span>
<span id="cb41-644"><a href="#cb41-644"></a></span>
<span id="cb41-645"><a href="#cb41-645"></a><span class="co"># Calculate the Jensen Shannon divergence between the COG distribution observed in </span></span>
<span id="cb41-646"><a href="#cb41-646"></a><span class="co"># enriched genes and the COG distribution in the genomic background</span></span>
<span id="cb41-647"><a href="#cb41-647"></a>JSD_observed <span class="ot">&lt;-</span> <span class="fu">left_join</span>(COGs_distribution_observed, COGs_distribution_nullexpectation,</span>
<span id="cb41-648"><a href="#cb41-648"></a>                          <span class="at">by =</span> <span class="fu">join_by</span>(COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-649"><a href="#cb41-649"></a>  <span class="fu">group_by</span>(prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-650"><a href="#cb41-650"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> nobs<span class="sc">/</span><span class="fu">sum</span>(nobs), </span>
<span id="cb41-651"><a href="#cb41-651"></a>         <span class="at">q =</span> nnull<span class="sc">/</span><span class="fu">sum</span>(nnull)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-652"><a href="#cb41-652"></a>  <span class="fu">summarize</span>(<span class="at">JSD =</span> <span class="fu">JSD_pair</span>(p, q))</span>
<span id="cb41-653"><a href="#cb41-653"></a></span>
<span id="cb41-654"><a href="#cb41-654"></a><span class="co"># now calculate JSD between the simulated draws and the backgound distribution</span></span>
<span id="cb41-655"><a href="#cb41-655"></a>JSD_simulated <span class="ot">&lt;-</span> <span class="fu">left_join</span>(COGs_distribution_simulated, </span>
<span id="cb41-656"><a href="#cb41-656"></a>                           COGs_distribution_nullexpectation,</span>
<span id="cb41-657"><a href="#cb41-657"></a>                           <span class="at">by =</span> <span class="fu">join_by</span>(strainID, COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-658"><a href="#cb41-658"></a>  <span class="co"># drops from calculation categories that aren't in both the observed data</span></span>
<span id="cb41-659"><a href="#cb41-659"></a>  <span class="co"># and the resampled data. Need to do this because JSD can't handle zero values</span></span>
<span id="cb41-660"><a href="#cb41-660"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-661"><a href="#cb41-661"></a>  <span class="fu">group_by</span>(id, strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-662"><a href="#cb41-662"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> nsim<span class="sc">/</span><span class="fu">sum</span>(nsim), </span>
<span id="cb41-663"><a href="#cb41-663"></a>         <span class="at">q =</span> nnull<span class="sc">/</span><span class="fu">sum</span>(nnull)) <span class="sc">%&gt;%</span></span>
<span id="cb41-664"><a href="#cb41-664"></a>  <span class="fu">summarize</span>(<span class="at">JSD =</span> <span class="fu">JSD_pair</span>(p, q))</span>
<span id="cb41-665"><a href="#cb41-665"></a></span>
<span id="cb41-666"><a href="#cb41-666"></a><span class="co"># proportion of JSD measures between simulated and the background that are greater</span></span>
<span id="cb41-667"><a href="#cb41-667"></a><span class="co"># than the JSD between the observed and the background</span></span>
<span id="cb41-668"><a href="#cb41-668"></a>global_p <span class="ot">&lt;-</span> <span class="fu">left_join</span>(JSD_simulated, JSD_observed, <span class="at">by =</span> <span class="fu">join_by</span>(prey_history, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-669"><a href="#cb41-669"></a>  <span class="fu">mutate</span>(<span class="at">ngt =</span> JSD.x <span class="sc">&gt;=</span> JSD.y) <span class="sc">%&gt;%</span> </span>
<span id="cb41-670"><a href="#cb41-670"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-671"><a href="#cb41-671"></a>  <span class="fu">summarize</span>(<span class="at">p =</span> <span class="fu">sum</span>(ngt)<span class="sc">/</span><span class="fu">n</span>())</span>
<span id="cb41-672"><a href="#cb41-672"></a>  </span>
<span id="cb41-673"><a href="#cb41-673"></a>global_p</span>
<span id="cb41-674"><a href="#cb41-674"></a><span class="in">```</span></span>
<span id="cb41-675"><a href="#cb41-675"></a></span>
<span id="cb41-676"><a href="#cb41-676"></a>The overall distribution of COG categories in the parallel genes for each genome in each treatment combination is not significantly different than in the rest of the genome in 9/10 cases. However, for HAMBI_1972 there does seem to be a difference in the distribution of COG categories in enriched genes relative to the genome background.</span>
<span id="cb41-677"><a href="#cb41-677"></a></span>
<span id="cb41-678"><a href="#cb41-678"></a><span class="fu">### Enrichment of individual COG categories</span></span>
<span id="cb41-679"><a href="#cb41-679"></a></span>
<span id="cb41-680"><a href="#cb41-680"></a>OK so the overall distribution of COG categories in the parallel genes is not significantly different than in the rest of the genome - \~40% of the time the JSD between the COG distribution in a random sample and the background is greater than the observed COG distribution and the background.</span>
<span id="cb41-681"><a href="#cb41-681"></a></span>
<span id="cb41-682"><a href="#cb41-682"></a><span class="fu">#### Hypergeometric Test</span></span>
<span id="cb41-683"><a href="#cb41-683"></a></span>
<span id="cb41-684"><a href="#cb41-684"></a>We can test enrichment in individual COG categories in individual species using the hypergeometric test. We will correct for multiple testings by controlling the False Discovery Rate (FDR) using q-values<span class="co">[</span><span class="ot">@storey2003a</span><span class="co">]</span> and choosing a maximum FDR threshold of 5%.</span>
<span id="cb41-685"><a href="#cb41-685"></a></span>
<span id="cb41-688"><a href="#cb41-688"></a><span class="in">```{r}</span></span>
<span id="cb41-689"><a href="#cb41-689"></a><span class="fu">library</span>(qvalue)</span>
<span id="cb41-690"><a href="#cb41-690"></a></span>
<span id="cb41-691"><a href="#cb41-691"></a>par2test <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb41-692"><a href="#cb41-692"></a>                      <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span></span>
<span id="cb41-693"><a href="#cb41-693"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-694"><a href="#cb41-694"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-695"><a href="#cb41-695"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"n_cog_par"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-696"><a href="#cb41-696"></a>  <span class="fu">mutate</span>(<span class="at">n_par =</span> <span class="fu">sum</span>(n_cog_par))</span>
<span id="cb41-697"><a href="#cb41-697"></a></span>
<span id="cb41-698"><a href="#cb41-698"></a>back2test <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb41-699"><a href="#cb41-699"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-700"><a href="#cb41-700"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb41-701"><a href="#cb41-701"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"n_cog_background"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-702"><a href="#cb41-702"></a>  <span class="fu">mutate</span>(<span class="at">n_background =</span> <span class="fu">sum</span>(n_cog_background))</span>
<span id="cb41-703"><a href="#cb41-703"></a></span>
<span id="cb41-704"><a href="#cb41-704"></a>phypres <span class="ot">&lt;-</span> <span class="fu">left_join</span>(par2test, back2test, <span class="at">by =</span> <span class="fu">join_by</span>(strainID, COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-705"><a href="#cb41-705"></a>  <span class="fu">mutate</span>(<span class="at">p_enrich =</span> <span class="fu">enricher</span>(n_background, n_par, n_cog_background, n_cog_par, <span class="at">over=</span><span class="cn">TRUE</span>),</span>
<span id="cb41-706"><a href="#cb41-706"></a>         <span class="at">p_deplete =</span> <span class="fu">enricher</span>(n_background, n_par, n_cog_background, n_cog_par, <span class="at">over=</span><span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-707"><a href="#cb41-707"></a>  <span class="fu">mutate</span>(<span class="at">p_enrich_adj =</span> <span class="fu">p.adjust</span>(p_enrich, <span class="at">method =</span> <span class="st">"fdr"</span>),</span>
<span id="cb41-708"><a href="#cb41-708"></a>         <span class="at">p_deplete_adj =</span> <span class="fu">p.adjust</span>(p_deplete, <span class="at">method =</span> <span class="st">"fdr"</span>)) </span>
<span id="cb41-709"><a href="#cb41-709"></a></span>
<span id="cb41-710"><a href="#cb41-710"></a>qenrich <span class="ot">&lt;-</span> <span class="fu">qvalue_truncp</span>(phypres<span class="sc">$</span>p_enrich)</span>
<span id="cb41-711"><a href="#cb41-711"></a>qdeplete <span class="ot">&lt;-</span> <span class="fu">qvalue_truncp</span>(phypres<span class="sc">$</span>p_deplete)</span>
<span id="cb41-712"><a href="#cb41-712"></a></span>
<span id="cb41-713"><a href="#cb41-713"></a>phypres<span class="sc">$</span>q_enrich <span class="ot">&lt;-</span> qenrich<span class="sc">$</span>qvalues</span>
<span id="cb41-714"><a href="#cb41-714"></a>phypres<span class="sc">$</span>q_deplete <span class="ot">&lt;-</span> qdeplete<span class="sc">$</span>qvalues</span>
<span id="cb41-715"><a href="#cb41-715"></a></span>
<span id="cb41-716"><a href="#cb41-716"></a>phypres <span class="sc">%&gt;%</span> </span>
<span id="cb41-717"><a href="#cb41-717"></a>  <span class="fu">relocate</span>(p_enrich, q_enrich, p_enrich_adj) <span class="sc">%&gt;%</span> </span>
<span id="cb41-718"><a href="#cb41-718"></a>  <span class="fu">arrange</span>(p_enrich)</span>
<span id="cb41-719"><a href="#cb41-719"></a><span class="in">```</span></span>
<span id="cb41-720"><a href="#cb41-720"></a></span>
<span id="cb41-721"><a href="#cb41-721"></a><span class="fu">#### Nonparametric simulation</span></span>
<span id="cb41-722"><a href="#cb41-722"></a></span>
<span id="cb41-723"><a href="#cb41-723"></a>We can also look at different COG categories by simply counting the number of random samplings that have a COG count greater/less than that the observed COG count. Since we resampled the same number of genes as in the observed we can compare the two directly. Below we do this integrated over all species in the community to see if there was any pathway enriched across all species.</span>
<span id="cb41-724"><a href="#cb41-724"></a></span>
<span id="cb41-727"><a href="#cb41-727"></a><span class="in">```{r}</span></span>
<span id="cb41-728"><a href="#cb41-728"></a><span class="fu">left_join</span>(COGs_distribution_simulated, COGs_distribution_observed,</span>
<span id="cb41-729"><a href="#cb41-729"></a>          <span class="at">by =</span> <span class="fu">join_by</span>(COG_category_single, strainID, prey_history, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-730"><a href="#cb41-730"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-731"><a href="#cb41-731"></a>  <span class="fu">mutate</span>(<span class="at">gt =</span> <span class="fu">if_else</span>(nsim <span class="sc">&gt;=</span> nobs, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-732"><a href="#cb41-732"></a>  <span class="fu">group_by</span>(COG_category_single, strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-733"><a href="#cb41-733"></a>  <span class="fu">summarize</span>(<span class="at">p =</span> <span class="fu">sum</span>(gt)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-734"><a href="#cb41-734"></a>  <span class="fu">arrange</span>(p) <span class="sc">%&gt;%</span> </span>
<span id="cb41-735"><a href="#cb41-735"></a>  <span class="fu">mutate</span>(<span class="at">p_adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>))</span>
<span id="cb41-736"><a href="#cb41-736"></a><span class="in">```</span></span>
<span id="cb41-737"><a href="#cb41-737"></a></span>
<span id="cb41-738"><a href="#cb41-738"></a><span class="fu">### COG Distribution Plot</span></span>
<span id="cb41-739"><a href="#cb41-739"></a></span>
<span id="cb41-742"><a href="#cb41-742"></a><span class="in">```{r}</span></span>
<span id="cb41-743"><a href="#cb41-743"></a>cog_pmut <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb41-744"><a href="#cb41-744"></a>                      <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-745"><a href="#cb41-745"></a>  <span class="fu">count</span>(COG_category_single) <span class="sc">%&gt;%</span> </span>
<span id="cb41-746"><a href="#cb41-746"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb41-747"><a href="#cb41-747"></a>         <span class="at">n =</span> n<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb41-748"><a href="#cb41-748"></a>         <span class="at">type =</span> <span class="st">"parallel_mutations"</span>) </span>
<span id="cb41-749"><a href="#cb41-749"></a></span>
<span id="cb41-750"><a href="#cb41-750"></a>cog_everything <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb41-751"><a href="#cb41-751"></a>  <span class="fu">count</span>(COG_category_single) <span class="sc">%&gt;%</span> </span>
<span id="cb41-752"><a href="#cb41-752"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n), </span>
<span id="cb41-753"><a href="#cb41-753"></a>         <span class="at">type =</span> <span class="st">"all_genes"</span>) </span>
<span id="cb41-754"><a href="#cb41-754"></a></span>
<span id="cb41-755"><a href="#cb41-755"></a>pcogs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cog_pmut, cog_everything) <span class="sc">%&gt;%</span> </span>
<span id="cb41-756"><a href="#cb41-756"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-757"><a href="#cb41-757"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb41-758"><a href="#cb41-758"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(COG_category_single, f, <span class="at">.desc =</span> F), <span class="at">y=</span>n, <span class="at">fill =</span> type), <span class="at">stat=</span><span class="st">"identity"</span>,</span>
<span id="cb41-759"><a href="#cb41-759"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>( <span class="at">preserve =</span> <span class="st">"total"</span>)) <span class="sc">+</span></span>
<span id="cb41-760"><a href="#cb41-760"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb41-761"><a href="#cb41-761"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"COG Category"</span>, <span class="at">y =</span> <span class="st">"Fraction genes in COG category"</span>, <span class="at">fill =</span> <span class="st">"Subset"</span>) <span class="sc">+</span></span>
<span id="cb41-762"><a href="#cb41-762"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb41-763"><a href="#cb41-763"></a>    <span class="st">"N all genes"</span>, </span>
<span id="cb41-764"><a href="#cb41-764"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">name =</span> <span class="st">"N parallel genes"</span>)</span>
<span id="cb41-765"><a href="#cb41-765"></a>  ) <span class="sc">+</span></span>
<span id="cb41-766"><a href="#cb41-766"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb41-767"><a href="#cb41-767"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-768"><a href="#cb41-768"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-769"><a href="#cb41-769"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-770"><a href="#cb41-770"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb41-771"><a href="#cb41-771"></a>  )</span>
<span id="cb41-772"><a href="#cb41-772"></a><span class="in">```</span></span>
<span id="cb41-773"><a href="#cb41-773"></a></span>
<span id="cb41-774"><a href="#cb41-774"></a>::: {#fig-05}</span>
<span id="cb41-775"><a href="#cb41-775"></a></span>
<span id="cb41-778"><a href="#cb41-778"></a><span class="in">```{r}</span></span>
<span id="cb41-779"><a href="#cb41-779"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb41-780"><a href="#cb41-780"></a><span class="co">#| fig.height: 6</span></span>
<span id="cb41-781"><a href="#cb41-781"></a><span class="co">#| echo: false</span></span>
<span id="cb41-782"><a href="#cb41-782"></a>pcogs</span>
<span id="cb41-783"><a href="#cb41-783"></a><span class="in">```</span></span>
<span id="cb41-784"><a href="#cb41-784"></a></span>
<span id="cb41-785"><a href="#cb41-785"></a>Fraction of genes in each Cluster of Orthologous Groups (COG) category for genes with a COG annotation (red bars, left y-axis) and only genes exhibiting significant genomic parallelism (blue bars, right y-axis) integrated over HAMBI species from metagenomes (i.e., species exceeding the coverage threshold).</span>
<span id="cb41-786"><a href="#cb41-786"></a>:::</span>
<span id="cb41-787"><a href="#cb41-787"></a></span>
<span id="cb41-788"><a href="#cb41-788"></a><span class="fu">### Species present in the metagenomes</span></span>
<span id="cb41-789"><a href="#cb41-789"></a></span>
<span id="cb41-792"><a href="#cb41-792"></a><span class="in">```{r}</span></span>
<span id="cb41-793"><a href="#cb41-793"></a><span class="co"># species detected in the metagenomes</span></span>
<span id="cb41-794"><a href="#cb41-794"></a>mgsp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HAMBI_2659"</span>, <span class="st">"HAMBI_1972"</span>, <span class="st">"HAMBI_1977"</span>, <span class="st">"HAMBI_1287"</span>)</span>
<span id="cb41-795"><a href="#cb41-795"></a></span>
<span id="cb41-796"><a href="#cb41-796"></a>cog_pmut_mgsp <span class="ot">&lt;-</span> <span class="fu">left_join</span>(output_gene_table_filt, eggnog,</span>
<span id="cb41-797"><a href="#cb41-797"></a>                      <span class="at">by =</span> <span class="fu">join_by</span>(locus_tag, strainID)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-798"><a href="#cb41-798"></a>  <span class="fu">filter</span>(strainID <span class="sc">%in%</span> mgsp) <span class="sc">%&gt;%</span> </span>
<span id="cb41-799"><a href="#cb41-799"></a>  <span class="fu">group_by</span>(strainID, prey_history, predator_history) <span class="sc">%&gt;%</span> </span>
<span id="cb41-800"><a href="#cb41-800"></a>  <span class="fu">count</span>(COG_category_single, <span class="at">name =</span> <span class="st">"tot"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-801"><a href="#cb41-801"></a>  <span class="co"># scaling factor to make ploting on 2 axes possible</span></span>
<span id="cb41-802"><a href="#cb41-802"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> tot<span class="sc">*</span><span class="dv">250</span>,</span>
<span id="cb41-803"><a href="#cb41-803"></a>         <span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb41-804"><a href="#cb41-804"></a>         <span class="at">type =</span> <span class="st">"parallel_mutations"</span>) </span>
<span id="cb41-805"><a href="#cb41-805"></a></span>
<span id="cb41-806"><a href="#cb41-806"></a>cog_everything_mgsp <span class="ot">&lt;-</span> eggnog <span class="sc">%&gt;%</span> </span>
<span id="cb41-807"><a href="#cb41-807"></a>  <span class="fu">filter</span>(strainID <span class="sc">%in%</span> mgsp) <span class="sc">%&gt;%</span> </span>
<span id="cb41-808"><a href="#cb41-808"></a>  <span class="fu">group_by</span>(strainID) <span class="sc">%&gt;%</span> </span>
<span id="cb41-809"><a href="#cb41-809"></a>  <span class="fu">count</span>(COG_category_single) <span class="sc">%&gt;%</span> </span>
<span id="cb41-810"><a href="#cb41-810"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb41-811"><a href="#cb41-811"></a>         <span class="at">type =</span> <span class="st">"all_genes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-812"><a href="#cb41-812"></a>  <span class="fu">expand_grid</span>(<span class="at">prey_history =</span> <span class="fu">c</span>(<span class="st">"anc"</span>, <span class="st">"evo"</span>), <span class="at">predator_history =</span> <span class="fu">c</span>(<span class="st">"anc"</span>, <span class="st">"evo"</span>))</span>
<span id="cb41-813"><a href="#cb41-813"></a></span>
<span id="cb41-814"><a href="#cb41-814"></a>pcogs_mgsp <span class="ot">&lt;-</span> <span class="fu">semi_join</span>(cog_everything_mgsp, cog_pmut_mgsp,</span>
<span id="cb41-815"><a href="#cb41-815"></a>          <span class="at">by =</span> <span class="fu">join_by</span>(strainID, prey_history, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-816"><a href="#cb41-816"></a>  <span class="fu">bind_rows</span>(cog_pmut_mgsp) <span class="sc">%&gt;%</span> </span>
<span id="cb41-817"><a href="#cb41-817"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(COG_category_single)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-818"><a href="#cb41-818"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">paste0</span>(<span class="st">"prey:"</span>, prey_history, <span class="st">" | pred:"</span>, predator_history)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-819"><a href="#cb41-819"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb41-820"><a href="#cb41-820"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(COG_category_single, n, <span class="at">.desc =</span> F), <span class="at">y=</span>n, <span class="at">fill =</span> type), <span class="at">stat=</span><span class="st">"identity"</span>,</span>
<span id="cb41-821"><a href="#cb41-821"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>( <span class="at">preserve =</span> <span class="st">"total"</span>)) <span class="sc">+</span></span>
<span id="cb41-822"><a href="#cb41-822"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb41-823"><a href="#cb41-823"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"U"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"D"</span>, <span class="st">"P"</span>, <span class="st">"M"</span>),</span>
<span id="cb41-824"><a href="#cb41-824"></a>                           <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>, <span class="dv">900</span>),</span>
<span id="cb41-825"><a href="#cb41-825"></a>                           <span class="at">strainID =</span> <span class="fu">c</span>(<span class="st">"HAMBI_2659"</span>, <span class="st">"HAMBI_2659"</span>, <span class="st">"HAMBI_1972"</span>, <span class="st">"HAMBI_1972"</span>, <span class="st">"HAMBI_2659"</span> ,<span class="st">"HAMBI_1972"</span>),</span>
<span id="cb41-826"><a href="#cb41-826"></a>                           <span class="at">prey_history =</span> <span class="fu">c</span>(<span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"evo"</span>),</span>
<span id="cb41-827"><a href="#cb41-827"></a>                           <span class="at">predator_history =</span> <span class="fu">c</span>(<span class="st">"evo"</span>, <span class="st">"evo"</span>, <span class="st">"anc"</span>, <span class="st">"evo"</span>, <span class="st">"anc"</span>, <span class="st">"evo"</span>)),</span>
<span id="cb41-828"><a href="#cb41-828"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">shape =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb41-829"><a href="#cb41-829"></a>  <span class="fu">facet_grid</span>(treat <span class="sc">~</span> strainID) <span class="sc">+</span></span>
<span id="cb41-830"><a href="#cb41-830"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"COG Category"</span>, <span class="at">y =</span> <span class="st">"Fraction genes in COG category"</span>, <span class="at">fill =</span> <span class="st">"Subset"</span>) <span class="sc">+</span></span>
<span id="cb41-831"><a href="#cb41-831"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb41-832"><a href="#cb41-832"></a>    <span class="st">"N all genes"</span>, </span>
<span id="cb41-833"><a href="#cb41-833"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">250</span>, <span class="at">name =</span> <span class="st">"N parallel genes"</span>)</span>
<span id="cb41-834"><a href="#cb41-834"></a>  ) <span class="sc">+</span></span>
<span id="cb41-835"><a href="#cb41-835"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb41-836"><a href="#cb41-836"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-837"><a href="#cb41-837"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-838"><a href="#cb41-838"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-839"><a href="#cb41-839"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-840"><a href="#cb41-840"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb41-841"><a href="#cb41-841"></a>  )</span>
<span id="cb41-842"><a href="#cb41-842"></a><span class="in">```</span></span>
<span id="cb41-843"><a href="#cb41-843"></a></span>
<span id="cb41-844"><a href="#cb41-844"></a>::: {#fig-06}</span>
<span id="cb41-847"><a href="#cb41-847"></a><span class="in">```{r}</span></span>
<span id="cb41-848"><a href="#cb41-848"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb41-849"><a href="#cb41-849"></a><span class="co">#| fig.height: 8</span></span>
<span id="cb41-850"><a href="#cb41-850"></a><span class="co">#| echo: false</span></span>
<span id="cb41-851"><a href="#cb41-851"></a>pcogs_mgsp</span>
<span id="cb41-852"><a href="#cb41-852"></a><span class="in">```</span></span>
<span id="cb41-853"><a href="#cb41-853"></a></span>
<span id="cb41-854"><a href="#cb41-854"></a>Fraction of genes in each Cluster of Orthologous Groups (COG) category for genes with a COG annotation (red bars, left y-axis) and only genes exhibiting significant genomic parallelism (blue bars, right y-axis) for the four most abundant HAMBI genomes. COG categories for species $\times$ treatments combinationm are denoted with <span class="sc">\*</span> if they are significantly enriched in parallel mutations relative to the genomic background. See statistical results in table below.</span>
<span id="cb41-855"><a href="#cb41-855"></a>:::</span>
<span id="cb41-856"><a href="#cb41-856"></a></span>
<span id="cb41-859"><a href="#cb41-859"></a><span class="in">```{r}</span></span>
<span id="cb41-860"><a href="#cb41-860"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(figs, <span class="st">"COG_enrich_mgs.svg"</span>), pcogs_mgsp, <span class="at">width=</span><span class="dv">7</span>, <span class="at">height=</span><span class="dv">7</span>, </span>
<span id="cb41-861"><a href="#cb41-861"></a>       <span class="at">units=</span><span class="st">"in"</span>, <span class="at">device=</span><span class="st">"svg"</span>)</span>
<span id="cb41-862"><a href="#cb41-862"></a><span class="in">```</span></span>
<span id="cb41-863"><a href="#cb41-863"></a></span>
<span id="cb41-864"><a href="#cb41-864"></a>| strainID   | prey history | predator history | COG category                                                      | q value |</span>
<span id="cb41-865"><a href="#cb41-865"></a>|--------------|--------------|----------------|--------------|--------------|</span>
<span id="cb41-866"><a href="#cb41-866"></a>| HAMBI_1972 | Evolved      | Ancestral        | D - Cell cycle control, cell division, chromosome partitioning    | 0.019   |</span>
<span id="cb41-867"><a href="#cb41-867"></a>| HAMBI_1972 | Evolved      | Evolved          | D - Cell cycle control, cell division, chromosome partitioning    | 0.026   |</span>
<span id="cb41-868"><a href="#cb41-868"></a>| HAMBI_1972 | Evolved      | Evolved          | M - Cell wall/membrane/envelope biogenesis                        | 0.047   |</span>
<span id="cb41-869"><a href="#cb41-869"></a>| HAMBI_2659 | Evolved      | Evolved          | U - Intracellular trafficking, secretion, and vesicular transport | 0.026   |</span>
<span id="cb41-870"><a href="#cb41-870"></a>| HAMBI_2659 | Evolved      | Ancestral        | P - Inorganic ion transport and metabolism                        | 0.037   |</span>
<span id="cb41-871"><a href="#cb41-871"></a>| HAMBI_2659 | Evolved      | Evolved          | P - Inorganic ion transport and metabolism                        | 0.037   |</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>